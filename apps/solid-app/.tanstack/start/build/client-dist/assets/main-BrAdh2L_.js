const D={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return Dg(this.context.count)},getNextContextId(){return Dg(this.context.count++)}};function Dg(e){const t=String(e),n=t.length-1;return D.context.id+(n?String.fromCharCode(96+n):"")+t}function Yr(e){D.context=e}function OC(){return{...D.context,id:D.getNextContextId(),count:0}}const kC=!1,CC=(e,t)=>e===t,In=Symbol("solid-proxy"),R_=typeof Proxy=="function",Sh=Symbol("solid-track"),su={equals:CC};let Ho=null,$_=A_;const Gn=1,iu=2,T_={owned:null,cleanups:null,context:null,owner:null},Mf={};var ue=null;let La=null,PC=null,Se=null,vt=null,Vt=null,fl=0;function Wo(e,t){const n=Se,r=ue,s=e.length===0,i=t===void 0?r:t,o=s?T_:{owned:null,cleanups:null,context:i?i.context:null,owner:i},c=s?e:()=>e(()=>ut(()=>tc(o)));ue=o,Se=null;try{return hr(c,!0)}finally{Se=n,ue=r}}function et(e,t){t=t?Object.assign({},su,t):su;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),x_(n,s));return[M_.bind(n),r]}function ns(e,t,n){const r=Ic(e,t,!0,Gn);Zi(r)}function Ut(e,t,n){const r=Ic(e,t,!1,Gn);Zi(r)}function As(e,t,n){$_=LC;const r=Ic(e,t,!1,Gn),s=Oi&&Qt(Oi);s&&(r.suspense=s),(!n||!n.render)&&(r.user=!0),Vt?Vt.push(r):Zi(r)}function he(e,t,n){n=n?Object.assign({},su,n):su;const r=Ic(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Zi(r),M_.bind(r)}function RC(e){return e&&typeof e=="object"&&"then"in e}function ec(e,t,n){let r,s,i;typeof t=="function"?(r=e,s=t,i={}):(r=!0,s=e,i=t||{});let o=null,c=Mf,a=null,u=!1,l="initialValue"in i,f=typeof r=="function"&&he(r);const h=new Set,[d,m]=(i.storage||et)(i.initialValue),[y,b]=et(void 0),[_,S]=et(void 0,{equals:!1}),[E,O]=et(l?"ready":"unresolved");D.context&&(a=D.getNextContextId(),i.ssrLoadFrom==="initial"?c=i.initialValue:D.load&&D.has(a)&&(c=D.load(a)));function C(k,R,F,L){return o===k&&(o=null,L!==void 0&&(l=!0),(k===c||R===c)&&i.onHydrated&&queueMicrotask(()=>i.onHydrated(L,{value:R})),c=Mf,v(R,F)),R}function v(k,R){hr(()=>{R===void 0&&m(()=>k),O(R!==void 0?"errored":l?"ready":"unresolved"),b(R);for(const F of h.keys())F.decrement();h.clear()},!1)}function $(){const k=Oi&&Qt(Oi),R=d(),F=y();if(F!==void 0&&!o)throw F;return Se&&!Se.user&&k&&ns(()=>{_(),o&&(k.resolved&&La||h.has(k)||(k.increment(),h.add(k)))}),R}function w(k=!0){if(k!==!1&&u)return;u=!1;const R=f?f():r;if(R==null||R===!1){C(o,ut(d));return}let F;const L=c!==Mf?c:ut(()=>{try{return s(R,{value:d(),refetching:k})}catch(U){F=U}});if(F!==void 0){C(o,void 0,Da(F),R);return}else if(!RC(L))return C(o,L,void 0,R),L;return o=L,"v"in L?(L.s===1?C(o,L.v,void 0,R):C(o,void 0,Da(L.v),R),L):(u=!0,queueMicrotask(()=>u=!1),hr(()=>{O(l?"refreshing":"pending"),S()},!1),L.then(U=>C(L,U,void 0,R),U=>C(L,void 0,Da(U),R)))}Object.defineProperties($,{state:{get:()=>E()},error:{get:()=>y()},loading:{get(){const k=E();return k==="pending"||k==="refreshing"}},latest:{get(){if(!l)return $();const k=y();if(k&&!o)throw k;return d()}}});let P=ue;return f?ns(()=>(P=ue,w(!1))):w(!1),[$,{refetch:k=>FC(P,()=>w(k)),mutate:m}]}function $C(e){return hr(e,!1)}function ut(e){if(Se===null)return e();const t=Se;Se=null;try{return e()}finally{Se=t}}function cr(e,t,n){const r=Array.isArray(e);let s,i=n&&n.defer;return o=>{let c;if(r){c=Array(e.length);for(let u=0;u<e.length;u++)c[u]=e[u]()}else c=e();if(i)return i=!1,o;const a=ut(()=>t(c,s,o));return s=c,a}}function I_(e){As(()=>ut(e))}function xt(e){return ue===null||(ue.cleanups===null?ue.cleanups=[e]:ue.cleanups.push(e)),e}function TC(e,t){Ho||(Ho=Symbol("error")),ue=Ic(void 0,void 0,!0),ue.context={...ue.context,[Ho]:[t]};try{return e()}catch(n){Fc(n)}finally{ue=ue.owner}}function wh(){return Se}function IC(){return ue}function FC(e,t){const n=ue,r=Se;ue=e,Se=null;try{return hr(t,!0)}catch(s){Fc(s)}finally{ue=n,Se=r}}const[o3,c3]=et(!1);function MC(e){Vt.push.apply(Vt,e),e.length=0}function yr(e,t){const n=Symbol("context");return{id:n,Provider:DC(n),defaultValue:e}}function Qt(e){let t;return ue&&ue.context&&(t=ue.context[e.id])!==void 0?t:e.defaultValue}function F_(e){const t=he(e),n=he(()=>vh(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}let Oi;function xC(){return Oi||(Oi=yr())}function M_(){if(this.sources&&this.state)if(this.state===Gn)Zi(this);else{const e=vt;vt=null,hr(()=>cu(this),!1),vt=e}if(Se){const e=this.observers?this.observers.length:0;Se.sources?(Se.sources.push(this),Se.sourceSlots.push(e)):(Se.sources=[this],Se.sourceSlots=[e]),this.observers?(this.observers.push(Se),this.observerSlots.push(Se.sources.length-1)):(this.observers=[Se],this.observerSlots=[Se.sources.length-1])}return this.value}function x_(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&hr(()=>{for(let s=0;s<e.observers.length;s+=1){const i=e.observers[s],o=La&&La.running;o&&La.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?vt.push(i):Vt.push(i),i.observers&&N_(i)),o||(i.state=Gn)}if(vt.length>1e6)throw vt=[],new Error},!1)),t}function Zi(e){if(!e.fn)return;tc(e);const t=fl;AC(e,e.value,t)}function AC(e,t,n){let r;const s=ue,i=Se;Se=ue=e;try{r=e.fn(t)}catch(o){return e.pure&&(e.state=Gn,e.owned&&e.owned.forEach(tc),e.owned=null),e.updatedAt=n+1,Fc(o)}finally{Se=i,ue=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?x_(e,r):e.value=r,e.updatedAt=n)}function Ic(e,t,n,r=Gn,s){const i={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:ue,context:ue?ue.context:null,pure:n};return ue===null||ue!==T_&&(ue.owned?ue.owned.push(i):ue.owned=[i]),i}function ou(e){if(e.state===0)return;if(e.state===iu)return cu(e);if(e.suspense&&ut(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<fl);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===Gn)Zi(e);else if(e.state===iu){const r=vt;vt=null,hr(()=>cu(e,t[0]),!1),vt=r}}function hr(e,t){if(vt)return e();let n=!1;t||(vt=[]),Vt?n=!0:Vt=[],fl++;try{const r=e();return NC(n),r}catch(r){n||(Vt=null),vt=null,Fc(r)}}function NC(e){if(vt&&(A_(vt),vt=null),e)return;const t=Vt;Vt=null,t.length&&hr(()=>$_(t),!1)}function A_(e){for(let t=0;t<e.length;t++)ou(e[t])}function LC(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:ou(r)}if(D.context){if(D.count){D.effects||(D.effects=[]),D.effects.push(...e.slice(0,n));return}Yr()}for(D.effects&&(D.done||!D.count)&&(e=[...D.effects,...e],n+=D.effects.length,delete D.effects),t=0;t<n;t++)ou(e[t])}function cu(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const s=r.state;s===Gn?r!==t&&(!r.updatedAt||r.updatedAt<fl)&&ou(r):s===iu&&cu(r,t)}}}function N_(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=iu,n.pure?vt.push(n):Vt.push(n),n.observers&&N_(n))}}function tc(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const i=s.pop(),o=n.observerSlots.pop();r<s.length&&(i.sourceSlots[o]=r,s[r]=i,n.observerSlots[r]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)tc(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)tc(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Da(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function jg(e,t,n){try{for(const r of t)r(e)}catch(r){Fc(r,n&&n.owner||null)}}function Fc(e,t=ue){const n=Ho&&t&&t.context&&t.context[Ho],r=Da(e);if(!n)throw r;Vt?Vt.push({fn(){jg(r,n,t)},state:Gn}):jg(r,n,t)}function vh(e){if(typeof e=="function"&&!e.length)return vh(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=vh(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function DC(e,t){return function(r){let s;return Ut(()=>s=ut(()=>(ue.context={...ue.context,[e]:r.value},F_(()=>r.children))),void 0),s}}const jC=Symbol("fallback");function Ug(e){for(let t=0;t<e.length;t++)e[t]()}function UC(e,t,n={}){let r=[],s=[],i=[],o=0,c=t.length>1?[]:null;return xt(()=>Ug(i)),()=>{let a=e()||[],u=a.length,l,f;return a[Sh],ut(()=>{let d,m,y,b,_,S,E,O,C;if(u===0)o!==0&&(Ug(i),i=[],r=[],s=[],o=0,c&&(c=[])),n.fallback&&(r=[jC],s[0]=Wo(v=>(i[0]=v,n.fallback())),o=1);else if(o===0){for(s=new Array(u),f=0;f<u;f++)r[f]=a[f],s[f]=Wo(h);o=u}else{for(y=new Array(u),b=new Array(u),c&&(_=new Array(u)),S=0,E=Math.min(o,u);S<E&&r[S]===a[S];S++);for(E=o-1,O=u-1;E>=S&&O>=S&&r[E]===a[O];E--,O--)y[O]=s[E],b[O]=i[E],c&&(_[O]=c[E]);for(d=new Map,m=new Array(O+1),f=O;f>=S;f--)C=a[f],l=d.get(C),m[f]=l===void 0?-1:l,d.set(C,f);for(l=S;l<=E;l++)C=r[l],f=d.get(C),f!==void 0&&f!==-1?(y[f]=s[l],b[f]=i[l],c&&(_[f]=c[l]),f=m[f],d.set(C,f)):i[l]();for(f=S;f<u;f++)f in y?(s[f]=y[f],i[f]=b[f],c&&(c[f]=_[f],c[f](f))):s[f]=Wo(h);s=s.slice(0,o=u),r=a.slice(0)}return s});function h(d){if(i[f]=d,c){const[m,y]=et(f);return c[f]=y,t(a[f],m)}return t(a[f])}}}let L_=!1;function BC(){L_=!0}function M(e,t){if(L_&&D.context){const n=D.context;Yr(OC());const r=ut(()=>e(t||{}));return Yr(n),r}return ut(()=>e(t||{}))}function va(){return!0}const Eh={get(e,t,n){return t===In?n:e.get(t)},has(e,t){return t===In?!0:e.has(t)},set:va,deleteProperty:va,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:va,deleteProperty:va}},ownKeys(e){return e.keys()}};function xf(e){return(e=typeof e=="function"?e():e)?e:{}}function KC(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function Ht(...e){let t=!1;for(let o=0;o<e.length;o++){const c=e[o];t=t||!!c&&In in c,e[o]=typeof c=="function"?(t=!0,he(c)):c}if(R_&&t)return new Proxy({get(o){for(let c=e.length-1;c>=0;c--){const a=xf(e[c])[o];if(a!==void 0)return a}},has(o){for(let c=e.length-1;c>=0;c--)if(o in xf(e[c]))return!0;return!1},keys(){const o=[];for(let c=0;c<e.length;c++)o.push(...Object.keys(xf(e[c])));return[...new Set(o)]}},Eh);const n={},r=Object.create(null);for(let o=e.length-1;o>=0;o--){const c=e[o];if(!c)continue;const a=Object.getOwnPropertyNames(c);for(let u=a.length-1;u>=0;u--){const l=a[u];if(l==="__proto__"||l==="constructor")continue;const f=Object.getOwnPropertyDescriptor(c,l);if(!r[l])r[l]=f.get?{enumerable:!0,configurable:!0,get:KC.bind(n[l]=[f.get.bind(c)])}:f.value!==void 0?f:void 0;else{const h=n[l];h&&(f.get?h.push(f.get.bind(c)):f.value!==void 0&&h.push(()=>f.value))}}}const s={},i=Object.keys(r);for(let o=i.length-1;o>=0;o--){const c=i[o],a=r[c];a&&a.get?Object.defineProperty(s,c,a):s[c]=a?a.value:void 0}return s}function li(e,...t){if(R_&&In in e){const s=new Set(t.length>1?t.flat():t[0]),i=t.map(o=>new Proxy({get(c){return o.includes(c)?e[c]:void 0},has(c){return o.includes(c)&&c in e},keys(){return o.filter(c=>c in e)}},Eh));return i.push(new Proxy({get(o){return s.has(o)?void 0:e[o]},has(o){return s.has(o)?!1:o in e},keys(){return Object.keys(e).filter(o=>!s.has(o))}},Eh)),i}const n={},r=t.map(()=>({}));for(const s of Object.getOwnPropertyNames(e)){const i=Object.getOwnPropertyDescriptor(e,s),o=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let c=!1,a=0;for(const u of t)u.includes(s)&&(c=!0,o?r[a][s]=i.value:Object.defineProperty(r[a],s,i)),++a;c||(o?n[s]=i.value:Object.defineProperty(n,s,i))}return[...r,n]}let qC=0;function zC(){return D.context?D.getNextContextId():`cl-${qC++}`}const D_=e=>`Stale read from <${e}>.`;function a3(e){const t="fallback"in e&&{fallback:()=>e.fallback};return he(UC(()=>e.each,e.children,t||void 0))}function j_(e){const t=e.keyed,n=he(()=>e.when,void 0,void 0),r=t?n:he(n,void 0,{equals:(s,i)=>!s==!i});return he(()=>{const s=r();if(s){const i=e.children;return typeof i=="function"&&i.length>0?ut(()=>i(t?s:()=>{if(!ut(r))throw D_("Show");return n()})):i}return e.fallback},void 0,void 0)}function U_(e){const t=F_(()=>e.children),n=he(()=>{const r=t(),s=Array.isArray(r)?r:[r];let i=()=>{};for(let o=0;o<s.length;o++){const c=o,a=s[o],u=i,l=he(()=>u()?void 0:a.when,void 0,void 0),f=a.keyed?l:he(l,void 0,{equals:(h,d)=>!h==!d});i=()=>u()||(f()?[c,l,a]:void 0)}return i});return he(()=>{const r=n()();if(!r)return e.fallback;const[s,i,o]=r,c=o.children;return typeof c=="function"&&c.length>0?ut(()=>c(o.keyed?i():()=>{if(ut(n)()?.[0]!==s)throw D_("Match");return i()})):c},void 0,void 0)}function Er(e){return e}let Ea;function VC(e){let t;D.context&&D.load&&(t=D.load(D.getContextId()));const[n,r]=et(t,void 0);return Ea||(Ea=new Set),Ea.add(r),xt(()=>Ea.delete(r)),he(()=>{let s;if(s=n()){const i=e.fallback;return typeof i=="function"&&i.length?ut(()=>i(s,()=>r())):i}return TC(()=>e.children,r)},void 0,void 0)}const HC=yr();function au(e){let t=0,n,r,s,i,o;const[c,a]=et(!1),u=xC(),l={increment:()=>{++t===1&&a(!0)},decrement:()=>{--t===0&&a(!1)},inFallback:c,effects:[],resolved:!1},f=IC();if(D.context&&D.load){const m=D.getContextId();let y=D.load(m);if(y&&(typeof y!="object"||y.s!==1?s=y:D.gather(m)),s&&s!=="$$f"){const[b,_]=et(void 0,{equals:!1});i=b,s.then(()=>{if(D.done)return _();D.gather(m),Yr(r),_(),Yr()},S=>{o=S,_()})}}const h=Qt(HC);h&&(n=h.register(l.inFallback));let d;return xt(()=>d&&d()),M(u.Provider,{value:l,get children(){return he(()=>{if(o)throw o;if(r=D.context,i)return i(),i=void 0;r&&s==="$$f"&&Yr();const m=he(()=>e.children);return he(y=>{const b=l.inFallback(),{showContent:_=!0,showFallback:S=!0}=n?n():{};if((!b||s&&s!=="$$f")&&_)return l.resolved=!0,d&&d(),d=r=s=void 0,MC(l.effects),m();if(S)return d?y:Wo(E=>(d=E,r&&(Yr({id:r.id+"F",count:0}),r=void 0),e.fallback),f)})})}})}const WC=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],JC=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...WC]),QC=new Set(["innerHTML","textContent","innerText","children"]),GC=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),YC=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function XC(e,t){const n=YC[e];return typeof n=="object"?n[t]?n.$:void 0:n}const ZC=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),eP=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),tP={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},Gt=e=>he(()=>e());function nP(e,t,n){let r=n.length,s=t.length,i=r,o=0,c=0,a=t[s-1].nextSibling,u=null;for(;o<s||c<i;){if(t[o]===n[c]){o++,c++;continue}for(;t[s-1]===n[i-1];)s--,i--;if(s===o){const l=i<r?c?n[c-1].nextSibling:n[i-c]:a;for(;c<i;)e.insertBefore(n[c++],l)}else if(i===c)for(;o<s;)(!u||!u.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[i-1]&&n[c]===t[s-1]){const l=t[--s].nextSibling;e.insertBefore(n[c++],t[o++].nextSibling),e.insertBefore(n[--i],l),t[s]=n[i]}else{if(!u){u=new Map;let f=c;for(;f<i;)u.set(n[f],f++)}const l=u.get(t[o]);if(l!=null)if(c<l&&l<i){let f=o,h=1,d;for(;++f<s&&f<i&&!((d=u.get(t[f]))==null||d!==l+h);)h++;if(h>l-c){const m=t[o];for(;c<l;)e.insertBefore(n[c++],m)}else e.replaceChild(n[c++],t[o++])}else o++;else t[o++].remove()}}}const Bg="_$DX_DELEGATE";function Kg(e,t,n,r={}){let s;return Wo(i=>{s=i,t===document?e():Xr(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{s(),t.textContent=""}}function Kr(e,t,n,r){let s;const i=()=>{const c=document.createElement("template");return c.innerHTML=e,c.content.firstChild},o=()=>(s||(s=i())).cloneNode(!0);return o.cloneNode=o,o}function B_(e,t=window.document){const n=t[Bg]||(t[Bg]=new Set);for(let r=0,s=e.length;r<s;r++){const i=e[r];n.has(i)||(n.add(i),t.addEventListener(i,K_))}}function rP(e,t,n){br(e)||(e[t]=n)}function Oh(e,t,n){br(e)||(n==null?e.removeAttribute(t):e.setAttribute(t,n))}function sP(e,t,n,r){br(e)||(r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r))}function iP(e,t,n){br(e)||(n?e.setAttribute(t,""):e.removeAttribute(t))}function oP(e,t){br(e)||(t==null?e.removeAttribute("class"):e.className=t)}function cP(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const s=n[0];e.addEventListener(t,n[0]=i=>s.call(e,n[1],i))}else e.addEventListener(t,n,typeof n!="function"&&n)}function aP(e,t,n={}){const r=Object.keys(t||{}),s=Object.keys(n);let i,o;for(i=0,o=s.length;i<o;i++){const c=s[i];!c||c==="undefined"||t[c]||(qg(e,c,!1),delete n[c])}for(i=0,o=r.length;i<o;i++){const c=r[i],a=!!t[c];!c||c==="undefined"||n[c]===a||!a||(qg(e,c,!0),n[c]=a)}return n}function uP(e,t,n){if(!t)return n?Oh(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let s,i;for(i in n)t[i]==null&&r.removeProperty(i),delete n[i];for(i in t)s=t[i],s!==n[i]&&(r.setProperty(i,s),n[i]=s);return n}function ki(e,t={},n,r){const s={};return r||Ut(()=>s.children=nc(e,t.children,s.children)),Ut(()=>typeof t.ref=="function"&&lP(t.ref,e)),Ut(()=>fP(e,t,n,!0,s,!0)),s}function lP(e,t,n){return ut(()=>e(t,n))}function Xr(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return nc(e,t,r,n);Ut(s=>nc(e,t(),s,n),r)}function fP(e,t,n,r,s={},i=!1){t||(t={});for(const o in s)if(!(o in t)){if(o==="children")continue;s[o]=zg(e,o,null,s[o],n,i,t)}for(const o in t){if(o==="children")continue;const c=t[o];s[o]=zg(e,o,c,s[o],n,i,t)}}function hP(e,t,n={}){if(globalThis._$HY.done)return Kg(e,t,[...t.childNodes],n);D.completed=globalThis._$HY.completed,D.events=globalThis._$HY.events,D.load=r=>globalThis._$HY.r[r],D.has=r=>r in globalThis._$HY.r,D.gather=r=>Hg(t,r),D.registry=new Map,D.context={id:n.renderId||"",count:0};try{return Hg(t,n.renderId),Kg(e,t,[...t.childNodes],n)}finally{D.context=null}}function qn(e){let t,n;return!br()||!(t=D.registry.get(n=mP()))?e():(D.completed&&D.completed.add(t),D.registry.delete(n),t)}function dP(e){let t=e,n=0,r=[];if(br(e))for(;t;){if(t.nodeType===8){const s=t.nodeValue;if(s==="$")n++;else if(s==="/"){if(n===0)return[t,r];n--}}r.push(t),t=t.nextSibling}return[t,r]}function uu(){D.events&&!D.events.queued&&(queueMicrotask(()=>{const{completed:e,events:t}=D;if(t){for(t.queued=!1;t.length;){const[n,r]=t[0];if(!e.has(n))return;t.shift(),K_(r)}D.done&&(D.events=_$HY.events=null,D.completed=_$HY.completed=null)}}),D.events.queued=!0)}function br(e){return!!D.context&&!D.done&&(!e||e.isConnected)}function pP(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function qg(e,t,n){const r=t.trim().split(/\s+/);for(let s=0,i=r.length;s<i;s++)e.classList.toggle(r[s],n)}function zg(e,t,n,r,s,i,o){let c,a,u,l,f;if(t==="style")return uP(e,n,r);if(t==="classList")return aP(e,n,r);if(n===r)return r;if(t==="ref")i||n(e);else if(t.slice(0,3)==="on:"){const h=t.slice(3);r&&e.removeEventListener(h,r,typeof r!="function"&&r),n&&e.addEventListener(h,n,typeof n!="function"&&n)}else if(t.slice(0,10)==="oncapture:"){const h=t.slice(10);r&&e.removeEventListener(h,r,!0),n&&e.addEventListener(h,n,!0)}else if(t.slice(0,2)==="on"){const h=t.slice(2).toLowerCase(),d=ZC.has(h);if(!d&&r){const m=Array.isArray(r)?r[0]:r;e.removeEventListener(h,m)}(d||n)&&(cP(e,h,n,d),d&&B_([h]))}else if(t.slice(0,5)==="attr:")Oh(e,t.slice(5),n);else if(t.slice(0,5)==="bool:")iP(e,t.slice(5),n);else if((f=t.slice(0,5)==="prop:")||(u=QC.has(t))||!s&&((l=XC(t,e.tagName))||(a=JC.has(t)))||(c=e.nodeName.includes("-")||"is"in o)){if(f)t=t.slice(5),a=!0;else if(br(e))return n;t==="class"||t==="className"?oP(e,n):c&&!a&&!u?e[pP(t)]=n:e[l||t]=n}else{const h=s&&t.indexOf(":")>-1&&tP[t.split(":")[0]];h?sP(e,h,t,n):Oh(e,GC[t]||t,n)}return n}function K_(e){if(D.registry&&D.events&&D.events.find(([a,u])=>u===e))return;let t=e.target;const n=`$$${e.type}`,r=e.target,s=e.currentTarget,i=a=>Object.defineProperty(e,"target",{configurable:!0,value:a}),o=()=>{const a=t[n];if(a&&!t.disabled){const u=t[`${n}Data`];if(u!==void 0?a.call(t,u,e):a.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&i(t.host),!0},c=()=>{for(;o()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),D.registry&&!D.done&&(D.done=_$HY.done=!0),e.composedPath){const a=e.composedPath();i(a[0]);for(let u=0;u<a.length-2&&(t=a[u],!!o());u++){if(t._$host){t=t._$host,c();break}if(t.parentNode===s)break}}else c();i(r)}function nc(e,t,n,r,s){const i=br(e);if(i){!n&&(n=[...e.childNodes]);let a=[];for(let u=0;u<n.length;u++){const l=n[u];l.nodeType===8&&l.data.slice(0,2)==="!$"?l.remove():a.push(l)}n=a}for(;typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,c=r!==void 0;if(e=c&&n[0]&&n[0].parentNode||e,o==="string"||o==="number"){if(i||o==="number"&&(t=t.toString(),t===n))return n;if(c){let a=n[0];a&&a.nodeType===3?a.data!==t&&(a.data=t):a=document.createTextNode(t),n=Ws(e,n,r,a)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||o==="boolean"){if(i)return n;n=Ws(e,n,r)}else{if(o==="function")return Ut(()=>{let a=t();for(;typeof a=="function";)a=a();n=nc(e,a,n,r)}),()=>n;if(Array.isArray(t)){const a=[],u=n&&Array.isArray(n);if(kh(a,t,n,s))return Ut(()=>n=nc(e,a,n,r,!0)),()=>n;if(i){if(!a.length)return n;if(r===void 0)return n=[...e.childNodes];let l=a[0];if(l.parentNode!==e)return n;const f=[l];for(;(l=l.nextSibling)!==r;)f.push(l);return n=f}if(a.length===0){if(n=Ws(e,n,r),c)return n}else u?n.length===0?Vg(e,a,r):nP(e,n,a):(n&&Ws(e),Vg(e,a));n=a}else if(t.nodeType){if(i&&t.parentNode)return n=c?[t]:t;if(Array.isArray(n)){if(c)return n=Ws(e,n,r,t);Ws(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function kh(e,t,n,r){let s=!1;for(let i=0,o=t.length;i<o;i++){let c=t[i],a=n&&n[e.length],u;if(!(c==null||c===!0||c===!1))if((u=typeof c)=="object"&&c.nodeType)e.push(c);else if(Array.isArray(c))s=kh(e,c,a)||s;else if(u==="function")if(r){for(;typeof c=="function";)c=c();s=kh(e,Array.isArray(c)?c:[c],Array.isArray(a)?a:[a])||s}else e.push(c),s=!0;else{const l=String(c);a&&a.nodeType===3&&a.data===l?e.push(a):e.push(document.createTextNode(l))}}return s}function Vg(e,t,n=null){for(let r=0,s=t.length;r<s;r++)e.insertBefore(t[r],n)}function Ws(e,t,n,r){if(n===void 0)return e.textContent="";const s=r||document.createTextNode("");if(t.length){let i=!1;for(let o=t.length-1;o>=0;o--){const c=t[o];if(s!==c){const a=c.parentNode===e;!i&&!o?a?e.replaceChild(s,c):e.insertBefore(s,n):a&&c.remove()}else i=!0}}else e.insertBefore(s,n);return[s]}function Hg(e,t){const n=e.querySelectorAll("*[data-hk]");for(let r=0;r<n.length;r++){const s=n[r],i=s.getAttribute("data-hk");(!t||i.startsWith(t))&&!D.registry.has(i)&&D.registry.set(i,s)}}function mP(){return D.getNextContextId()}const gP="http://www.w3.org/2000/svg";function yP(e,t=!1){return t?document.createElementNS(gP,e):document.createElement(e)}const bP=(...e)=>(BC(),hP(...e));function _P(e,t){const n=he(e);return he(()=>{const r=n();switch(typeof r){case"function":return ut(()=>r(t));case"string":const s=eP.has(r),i=D.context?qn():yP(r,s);return ki(i,t,s),i}})}function kn(e){const[,t]=li(e,["component"]);return _P(()=>e.component,t)}function q_(e){if(Array.isArray(e))return e.flatMap(l=>q_(l));if(typeof e!="string")return[];const t=[];let n=0,r,s,i,o,c;const a=()=>{for(;n<e.length&&/\s/.test(e.charAt(n));)n+=1;return n<e.length},u=()=>(s=e.charAt(n),s!=="="&&s!==";"&&s!==",");for(;n<e.length;){for(r=n,c=!1;a();)if(s=e.charAt(n),s===","){for(i=n,n+=1,a(),o=n;n<e.length&&u();)n+=1;n<e.length&&e.charAt(n)==="="?(c=!0,n=o,t.push(e.slice(r,i)),r=n):n=i+1}else n+=1;(!c||n>=e.length)&&t.push(e.slice(r,e.length))}return t}function SP(e){return e instanceof Headers?new Headers(e):Array.isArray(e)?new Headers(e):typeof e=="object"?new Headers(e):new Headers}function wP(...e){return e.reduce((t,n)=>{const r=SP(n);for(const[s,i]of r.entries())s==="set-cookie"?q_(i).forEach(c=>t.append("set-cookie",c)):t.set(s,i);return t},new Headers)}const fi=new WeakMap,ja=new WeakMap,lu={current:[]};let Af=!1,Jo=0;const No=new Set,Oa=new Map;function z_(e){const t=Array.from(e).sort((n,r)=>n instanceof hi&&n.options.deps.includes(r)?1:r instanceof hi&&r.options.deps.includes(n)?-1:0);for(const n of t){if(lu.current.includes(n))continue;lu.current.push(n),n.recompute();const r=ja.get(n);if(r)for(const s of r){const i=fi.get(s);i&&z_(i)}}}function vP(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function EP(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function V_(e){if(Jo>0&&!Oa.has(e)&&Oa.set(e,e.prevState),No.add(e),!(Jo>0)&&!Af)try{for(Af=!0;No.size>0;){const t=Array.from(No);No.clear();for(const n of t){const r=Oa.get(n)??n.prevState;n.prevState=r,vP(n)}for(const n of t){const r=fi.get(n);r&&(lu.current.push(n),z_(r))}for(const n of t){const r=fi.get(n);if(r)for(const s of r)EP(s)}}}finally{Af=!1,lu.current=[],Oa.clear()}}function Wg(e){Jo++;try{e()}finally{if(Jo--,Jo===0){const t=Array.from(No)[0];t&&V_(t)}}}function OP(e){return typeof e=="function"}class Ch{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const o=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),o?.()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):OP(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),V_(this)}}class hi{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:o}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:o}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof hi&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i?.()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof hi)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof Ch){let r=fi.get(n);r||(r=new Set,fi.set(n,r)),r.add(this);let s=ja.get(this);s||(s=new Set,ja.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof hi)this.unregisterFromGraph(n.options.deps);else if(n instanceof Ch){const r=fi.get(n);r&&r.delete(this);const s=ja.get(this);s&&s.delete(n)}}}const Pr="__TSR_index",Jg="popstate",Qg="beforeunload";function H_(e){let t=e.getLocation();const n=new Set,r=o=>{t=e.getLocation(),n.forEach(c=>c({location:t,action:o}))},s=o=>{e.notifyOnIndexChange??!0?r(o):t=e.getLocation()},i=async({task:o,navigateOpts:c,...a})=>{var u,l;if(c?.ignoreBlocker??!1){o();return}const h=((u=e.getBlockers)==null?void 0:u.call(e))??[],d=a.type==="PUSH"||a.type==="REPLACE";if(typeof document<"u"&&h.length&&d)for(const m of h){const y=rc(a.path,a.state);if(await m.blockerFn({currentLocation:t,nextLocation:y,action:a.type})){(l=e.onBlocked)==null||l.call(e);return}}o()};return{get location(){return t},get length(){return e.getLength()},subscribers:n,subscribe:o=>(n.add(o),()=>{n.delete(o)}),push:(o,c,a)=>{const u=t.state[Pr];c=Ph(u+1,c),i({task:()=>{e.pushState(o,c),r({type:"PUSH"})},navigateOpts:a,type:"PUSH",path:o,state:c})},replace:(o,c,a)=>{const u=t.state[Pr];c=Ph(u,c),i({task:()=>{e.replaceState(o,c),r({type:"REPLACE"})},navigateOpts:a,type:"REPLACE",path:o,state:c})},go:(o,c)=>{i({task:()=>{e.go(o),s({type:"GO",index:o})},navigateOpts:c,type:"GO"})},back:o=>{i({task:()=>{e.back(o?.ignoreBlocker??!1),s({type:"BACK"})},navigateOpts:o,type:"BACK"})},forward:o=>{i({task:()=>{e.forward(o?.ignoreBlocker??!1),s({type:"FORWARD"})},navigateOpts:o,type:"FORWARD"})},canGoBack:()=>t.state[Pr]!==0,createHref:o=>e.createHref(o),block:o=>{var c;if(!e.setBlockers)return()=>{};const a=((c=e.getBlockers)==null?void 0:c.call(e))??[];return e.setBlockers([...a,o]),()=>{var u,l;const f=((u=e.getBlockers)==null?void 0:u.call(e))??[];(l=e.setBlockers)==null||l.call(e,f.filter(h=>h!==o))}},flush:()=>{var o;return(o=e.flush)==null?void 0:o.call(e)},destroy:()=>{var o;return(o=e.destroy)==null?void 0:o.call(e)},notify:r}}function Ph(e,t){t||(t={});const n=ap();return{...t,key:n,__TSR_key:n,[Pr]:e}}function kP(e){var t,n;const r=typeof document<"u"?window:void 0,s=r.history.pushState,i=r.history.replaceState;let o=[];const c=()=>o,a=k=>o=k,u=k=>k,l=()=>rc(`${r.location.pathname}${r.location.search}${r.location.hash}`,r.history.state);if(!((t=r.history.state)!=null&&t.__TSR_key)&&!((n=r.history.state)!=null&&n.key)){const k=ap();r.history.replaceState({[Pr]:0,key:k,__TSR_key:k},"")}let f=l(),h,d=!1,m=!1,y=!1,b=!1;const _=()=>f;let S,E;const O=()=>{S&&(P._ignoreSubscribers=!0,(S.isPush?r.history.pushState:r.history.replaceState)(S.state,"",S.href),P._ignoreSubscribers=!1,S=void 0,E=void 0,h=void 0)},C=(k,R,F)=>{const L=u(R);E||(h=f),f=rc(R,F),S={href:L,state:F,isPush:S?.isPush||k==="push"},E||(E=Promise.resolve().then(()=>O()))},v=k=>{f=l(),P.notify({type:k})},$=async()=>{if(m){m=!1;return}const k=l(),R=k.state[Pr]-f.state[Pr],F=R===1,L=R===-1,U=!F&&!L||d;d=!1;const re=U?"GO":L?"BACK":"FORWARD",H=U?{type:"GO",index:R}:{type:L?"BACK":"FORWARD"};if(y)y=!1;else{const j=c();if(typeof document<"u"&&j.length){for(const Q of j)if(await Q.blockerFn({currentLocation:f,nextLocation:k,action:re})){m=!0,r.history.go(1),P.notify(H);return}}}f=l(),P.notify(H)},w=k=>{if(b){b=!1;return}let R=!1;const F=c();if(typeof document<"u"&&F.length)for(const L of F){const U=L.enableBeforeUnload??!0;if(U===!0){R=!0;break}if(typeof U=="function"&&U()===!0){R=!0;break}}if(R)return k.preventDefault(),k.returnValue=""},P=H_({getLocation:_,getLength:()=>r.history.length,pushState:(k,R)=>C("push",k,R),replaceState:(k,R)=>C("replace",k,R),back:k=>(k&&(y=!0),b=!0,r.history.back()),forward:k=>{k&&(y=!0),b=!0,r.history.forward()},go:k=>{d=!0,r.history.go(k)},createHref:k=>u(k),flush:O,destroy:()=>{r.history.pushState=s,r.history.replaceState=i,r.removeEventListener(Qg,w,{capture:!0}),r.removeEventListener(Jg,$)},onBlocked:()=>{h&&f!==h&&(f=h)},getBlockers:c,setBlockers:a,notifyOnIndexChange:!1});return r.addEventListener(Qg,w,{capture:!0}),r.addEventListener(Jg,$),r.history.pushState=function(...k){const R=s.apply(r.history,k);return P._ignoreSubscribers||v("PUSH"),R},r.history.replaceState=function(...k){const R=i.apply(r.history,k);return P._ignoreSubscribers||v("REPLACE"),R},P}function CP(e={initialEntries:["/"]}){const t=e.initialEntries;let n=e.initialIndex?Math.min(Math.max(e.initialIndex,0),t.length-1):t.length-1;const r=t.map((i,o)=>Ph(o,void 0));return H_({getLocation:()=>rc(t[n],r[n]),getLength:()=>t.length,pushState:(i,o)=>{n<t.length-1&&(t.splice(n+1),r.splice(n+1)),r.push(o),t.push(i),n=Math.max(t.length-1,0)},replaceState:(i,o)=>{r[n]=o,t[n]=i},back:()=>{n=Math.max(n-1,0)},forward:()=>{n=Math.min(n+1,t.length-1)},go:i=>{n=Math.min(Math.max(n+i,0),t.length-1)},createHref:i=>i})}function rc(e,t){const n=e.indexOf("#"),r=e.indexOf("?"),s=ap();return{href:e,pathname:e.substring(0,n>0?r>0?Math.min(n,r):n:r>0?r:e.length),hash:n>-1?e.substring(n):"",search:r>-1?e.slice(r,n===-1?void 0:n):"",state:t||{[Pr]:0,key:s,__TSR_key:s}}}function ap(){return(Math.random()+1).toString(36).substring(7)}var PP="Invariant failed";function mn(e,t){if(!e)throw new Error(PP)}function Rh(e){return e[e.length-1]}function RP(e){return typeof e=="function"}function rs(e,t){return RP(e)?e(t):e}function $h(e,t){return t.reduce((n,r)=>(n[r]=e[r],n),{})}function Sn(e,t){if(e===t)return e;const n=t,r=Xg(e)&&Xg(n);if(r||Gg(e)&&Gg(n)){const s=r?e:Object.keys(e).concat(Object.getOwnPropertySymbols(e)),i=s.length,o=r?n:Object.keys(n).concat(Object.getOwnPropertySymbols(n)),c=o.length,a=r?[]:{};let u=0;for(let l=0;l<c;l++){const f=r?l:o[l];(!r&&s.includes(f)||r)&&e[f]===void 0&&n[f]===void 0?(a[f]=void 0,u++):(a[f]=Sn(e[f],n[f]),a[f]===e[f]&&e[f]!==void 0&&u++)}return i===c&&u===i?e:a}return n}function Gg(e){return rr(e)&&Object.getOwnPropertyNames(e).length===Object.keys(e).length}function rr(e){if(!Yg(e))return!1;const t=e.constructor;if(typeof t>"u")return!0;const n=t.prototype;return!(!Yg(n)||!n.hasOwnProperty("isPrototypeOf"))}function Yg(e){return Object.prototype.toString.call(e)==="[object Object]"}function Xg(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Zg(e,t){let n=Object.keys(e);return t&&(n=n.filter(r=>e[r]!==void 0)),n}function di(e,t,n){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(rr(e)&&rr(t)){const r=n?.ignoreUndefined??!0,s=Zg(e,r),i=Zg(t,r);return!n?.partial&&s.length!==i.length?!1:i.every(o=>di(e[o],t[o],n))}return Array.isArray(e)&&Array.isArray(t)?e.length!==t.length?!1:!e.some((r,s)=>!di(r,t[s],n)):!1}function ni(e){let t,n;const r=new Promise((s,i)=>{t=s,n=i});return r.status="pending",r.resolve=s=>{r.status="resolved",r.value=s,t(s),e?.(s)},r.reject=s=>{r.status="rejected",n(s)},r}function zn(e){return hl(e.filter(t=>t!==void 0).join("/"))}function hl(e){return e.replace(/\/{2,}/g,"/")}function up(e){return e==="/"?e:e.replace(/^\/{1,}/,"")}function Ci(e){return e==="/"?e:e.replace(/\/{1,}$/,"")}function Nf(e){return Ci(up(e))}function fu(e,t){return e?.endsWith("/")&&e!=="/"&&e!==`${t}/`?e.slice(0,-1):e}function $P(e,t,n){return fu(e,n)===fu(t,n)}function TP({basepath:e,base:t,to:n,trailingSlash:r="never",caseSensitive:s}){var i,o;t=hu(e,t,s),n=hu(e,n,s);let c=Pi(t);const a=Pi(n);c.length>1&&((i=Rh(c))==null?void 0:i.value)==="/"&&c.pop(),a.forEach((f,h)=>{f.value==="/"?h?h===a.length-1&&c.push(f):c=[f]:f.value===".."?c.pop():f.value==="."||c.push(f)}),c.length>1&&(((o=Rh(c))==null?void 0:o.value)==="/"?r==="never"&&c.pop():r==="always"&&c.push({type:"pathname",value:"/"}));const u=c.map(f=>{if(f.type==="param"){const h=f.value.substring(1);if(f.prefixSegment&&f.suffixSegment)return`${f.prefixSegment}{$${h}}${f.suffixSegment}`;if(f.prefixSegment)return`${f.prefixSegment}{$${h}}`;if(f.suffixSegment)return`{$${h}}${f.suffixSegment}`}if(f.type==="wildcard"){if(f.prefixSegment&&f.suffixSegment)return`${f.prefixSegment}{$}${f.suffixSegment}`;if(f.prefixSegment)return`${f.prefixSegment}{$}`;if(f.suffixSegment)return`{$}${f.suffixSegment}`}return f.value}),l=zn([e,...u]);return hl(l)}const IP=/^\$.{1,}$/,FP=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,MP=/^\$$/,xP=/^(.*?)\{\$\}(.*)$/;function Pi(e){if(!e)return[];e=hl(e);const t=[];if(e.slice(0,1)==="/"&&(e=e.substring(1),t.push({type:"pathname",value:"/"})),!e)return t;const n=e.split("/").filter(Boolean);return t.push(...n.map(r=>{const s=r.match(xP);if(s){const o=s[1],c=s[2];return{type:"wildcard",value:"$",prefixSegment:o||void 0,suffixSegment:c||void 0}}const i=r.match(FP);if(i){const o=i[1],c=i[2],a=i[3];return{type:"param",value:""+c,prefixSegment:o||void 0,suffixSegment:a||void 0}}return IP.test(r)?{type:"param",value:"$"+r.substring(1),prefixSegment:void 0,suffixSegment:void 0}:MP.test(r)?{type:"wildcard",value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:"pathname",value:r.includes("%25")?r.split("%25").map(o=>decodeURI(o)).join("%25"):decodeURI(r)}})),e.slice(-1)==="/"&&(e=e.substring(1),t.push({type:"pathname",value:"/"})),t}function Lf({path:e,params:t,leaveWildcards:n,leaveParams:r,decodeCharMap:s}){const i=Pi(e);function o(l){const f=t[l],h=typeof f=="string";return["*","_splat"].includes(l)?h?encodeURI(f):f:h?AP(f,s):f}let c=!1;const a={},u=zn(i.map(l=>{if(l.type==="wildcard"){a._splat=t._splat;const f=l.prefixSegment||"",h=l.suffixSegment||"",d=o("_splat");return n?`${f}${l.value}${d??""}${h}`:`${f}${d}${h}`}if(l.type==="param"){const f=l.value.substring(1);!c&&!(f in t)&&(c=!0),a[f]=t[f];const h=l.prefixSegment||"",d=l.suffixSegment||"";if(r){const m=o(l.value);return`${h}${l.value}${m??""}${d}`}return`${h}${o(f)??"undefined"}${d}`}return l.value}));return{usedParams:a,interpolatedPath:u,isMissingParams:c}}function AP(e,t){let n=encodeURIComponent(e);if(t)for(const[r,s]of t)n=n.replaceAll(r,s);return n}function Th(e,t,n){const r=NP(e,t,n);if(!(n.to&&!r))return r??{}}function hu(e,t,n=!1){const r=n?e:e.toLowerCase(),s=n?t:t.toLowerCase();switch(!0){case r==="/":return t;case s===r:return"";case t.length<e.length:return t;case s[r.length]!=="/":return t;case s.startsWith(r):return t.slice(e.length);default:return t}}function NP(e,t,n){if(e!=="/"&&!t.startsWith(e))return;t=hu(e,t,n.caseSensitive);const r=hu(e,`${n.to??"$"}`,n.caseSensitive),s=Pi(t),i=Pi(r);t.startsWith("/")||s.unshift({type:"pathname",value:"/"}),r.startsWith("/")||i.unshift({type:"pathname",value:"/"});const o={};return(()=>{var a;for(let u=0;u<Math.max(s.length,i.length);u++){const l=s[u],f=i[u],h=u>=s.length-1,d=u>=i.length-1;if(f){if(f.type==="wildcard"){const m=s.slice(u);let y;if(f.prefixSegment||f.suffixSegment){if(!l)return!1;const b=f.prefixSegment||"",_=f.suffixSegment||"",S=l.value;if("prefixSegment"in f&&!S.startsWith(b)||"suffixSegment"in f&&!((a=s[s.length-1])!=null&&a.value.endsWith(_)))return!1;let E=decodeURI(zn(m.map(O=>O.value)));b&&E.startsWith(b)&&(E=E.slice(b.length)),_&&E.endsWith(_)&&(E=E.slice(0,E.length-_.length)),y=E}else y=decodeURI(zn(m.map(b=>b.value)));return o["*"]=y,o._splat=y,!0}if(f.type==="pathname"){if(f.value==="/"&&!l?.value)return!0;if(l){if(n.caseSensitive){if(f.value!==l.value)return!1}else if(f.value.toLowerCase()!==l.value.toLowerCase())return!1}}if(!l)return!1;if(f.type==="param"){if(l.value==="/")return!1;let m;if(f.prefixSegment||f.suffixSegment){const y=f.prefixSegment||"",b=f.suffixSegment||"",_=l.value;if(y&&!_.startsWith(y)||b&&!_.endsWith(b))return!1;let S=_;y&&S.startsWith(y)&&(S=S.slice(y.length)),b&&S.endsWith(b)&&(S=S.slice(0,S.length-b.length)),m=decodeURIComponent(S)}else m=decodeURIComponent(l.value);o[f.value.substring(1)]=m}}if(!h&&d)return o["**"]=zn(s.slice(u+1).map(m=>m.value)),!!n.fuzzy&&f?.value!=="/"}return!0})()?o:void 0}function Dt(e){return!!e?.isNotFound}function LP(){try{if(typeof window<"u"&&typeof window.sessionStorage=="object")return window.sessionStorage}catch{return}}const du="tsr-scroll-restoration-v1_3",DP=(e,t)=>{let n;return(...r)=>{n||(n=setTimeout(()=>{e(...r),n=null},t))}};function jP(){const e=LP();if(!e)return;const t=e.getItem(du);let n=t?JSON.parse(t):{};return{state:n,set:r=>(n=rs(r,n)||n,e.setItem(du,JSON.stringify(n)))}}const Df=jP(),Ih=e=>e.state.__TSR_key||e.href;function UP(e){const t=[];let n;for(;n=e.parentNode;)t.unshift(`${e.tagName}:nth-child(${[].indexOf.call(n.children,e)+1})`),e=n;return`${t.join(" > ")}`.toLowerCase()}let pu=!1;function W_(e,t,n,r,s){var i;let o;try{o=JSON.parse(sessionStorage.getItem(e)||"{}")}catch(u){console.error(u);return}const c=t||((i=window.history.state)==null?void 0:i.key),a=o[c];pu=!0,(()=>{if(r&&a){for(const l in a){const f=a[l];if(l==="window")window.scrollTo({top:f.scrollY,left:f.scrollX,behavior:n});else if(l){const h=document.querySelector(l);h&&(h.scrollLeft=f.scrollX,h.scrollTop=f.scrollY)}}return}const u=window.location.hash.split("#")[1];if(u){const l=(window.history.state||{}).__hashScrollIntoViewOptions??!0;if(l){const f=document.getElementById(u);f&&f.scrollIntoView(l)}return}["window",...s?.filter(l=>l!=="window")??[]].forEach(l=>{const f=l==="window"?window:typeof l=="function"?l():document.querySelector(l);f&&f.scrollTo({top:0,left:0,behavior:n})})})(),pu=!1}function BP(e,t){if(Df===void 0||((e.options.scrollRestoration??!1)&&(e.isScrollRestoring=!0),typeof document>"u"||e.isScrollRestorationSetup))return;e.isScrollRestorationSetup=!0,pu=!1;const r=e.options.getScrollRestorationKey||Ih;window.history.scrollRestoration="manual";const s=i=>{if(pu||!e.isScrollRestoring)return;let o="";if(i.target===document||i.target===window)o="window";else{const a=i.target.getAttribute("data-scroll-restoration-id");a?o=`[data-scroll-restoration-id="${a}"]`:o=UP(i.target)}const c=r(e.state.location);Df.set(a=>{const u=a[c]=a[c]||{},l=u[o]=u[o]||{};if(o==="window")l.scrollX=window.scrollX||0,l.scrollY=window.scrollY||0;else if(o){const f=document.querySelector(o);f&&(l.scrollX=f.scrollLeft||0,l.scrollY=f.scrollTop||0)}return a})};typeof document<"u"&&document.addEventListener("scroll",DP(s,100),!0),e.subscribe("onRendered",i=>{const o=r(i.toLocation);if(!e.resetNextScroll){e.resetNextScroll=!0;return}W_(du,o,e.options.scrollRestorationBehavior||void 0,e.isScrollRestoring||void 0,e.options.scrollToTopSelectors||void 0),e.isScrollRestoring&&Df.set(c=>(c[o]=c[o]||{},c))})}function KP(e){if(typeof document<"u"&&document.querySelector){const t=e.state.location.state.__hashScrollIntoViewOptions??!0;if(t&&e.state.location.hash!==""){const n=document.getElementById(e.state.location.hash);n&&n.scrollIntoView(t)}}}function J_(e,t){const n=Object.entries(e).flatMap(([s,i])=>Array.isArray(i)?i.map(o=>[s,String(o)]):[[s,String(i)]]);return""+new URLSearchParams(n).toString()}function jf(e){return e?e==="false"?!1:e==="true"?!0:+e*0===0&&+e+""===e?+e:e:""}function qP(e,t){const n=e;return[...new URLSearchParams(n).entries()].reduce((i,[o,c])=>{const a=i[o];return a==null?i[o]=jf(c):i[o]=Array.isArray(a)?[...a,jf(c)]:[a,jf(c)],i},{})}const zP=HP(JSON.parse),VP=WP(JSON.stringify,JSON.parse);function HP(e){return t=>{t.substring(0,1)==="?"&&(t=t.substring(1));const n=qP(t);for(const r in n){const s=n[r];if(typeof s=="string")try{n[r]=e(s)}catch{}}return n}}function WP(e,t){function n(r){if(typeof r=="object"&&r!==null)try{return e(r)}catch{}else if(typeof r=="string"&&typeof t=="function")try{return t(r),e(r)}catch{}return r}return r=>{r={...r},Object.keys(r).forEach(i=>{const o=r[i];typeof o>"u"||o===void 0?delete r[i]:r[i]=n(o)});const s=J_(r).toString();return s?`?${s}`:""}}const wn="__root__";function Q_(e){if(e.statusCode=e.statusCode||e.code||307,!e.reloadDocument)try{new URL(`${e.href}`),e.reloadDocument=!0}catch{}const t=new Headers(e.headers||{});e.href&&t.get("Location")===null&&t.set("Location",e.href);const n=new Response(null,{status:e.statusCode,headers:t});if(n.options=e,e.throw)throw n;return n}function sn(e){return e instanceof Response&&!!e.options}function JP(e){if(typeof e=="object"&&e.isSerializedRedirect)return Q_(e)}function ss(e){const t=e.resolvedLocation,n=e.location,r=t?.pathname!==n.pathname,s=t?.href!==n.href,i=t?.hash!==n.hash;return{fromLocation:t,toLocation:n,pathChanged:r,hrefChanged:s,hashChanged:i}}class QP{constructor(t){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=n=>n(),this.isShell=!1,this.update=n=>{var r;n.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const s=this.options;this.options={...this.options,...n},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(i=>[encodeURIComponent(i),i])):void 0,(!this.basepath||n.basepath&&n.basepath!==s.basepath)&&(n.basepath===void 0||n.basepath===""||n.basepath==="/"?this.basepath="/":this.basepath=`/${Nf(n.basepath)}`),(!this.history||this.options.history&&this.options.history!==this.history)&&(this.history=this.options.history??(this.isServer?CP({initialEntries:[this.basepath||"/"]}):kP()),this.latestLocation=this.parseLocation()),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),this.__store||(this.__store=new Ch(YP(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(i=>!["redirected"].includes(i.status))}}}),BP(this)),typeof window<"u"&&"CSS"in window&&typeof((r=window.CSS)==null?void 0:r.supports)=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)")),this.latestLocation.search.__TSS_SHELL&&(this.isShell=!0)},this.buildRouteTree=()=>{const{routesById:n,routesByPath:r,flatRoutes:s}=XP({routeTree:this.routeTree,initRoute:(o,c)=>{o.init({originalIndex:c,defaultSsr:this.options.defaultSsr})}});this.routesById=n,this.routesByPath=r,this.flatRoutes=s;const i=this.options.notFoundRoute;i&&(i.init({originalIndex:99999999999,defaultSsr:this.options.defaultSsr}),this.routesById[i.id]=i)},this.subscribe=(n,r)=>{const s={eventType:n,fn:r};return this.subscribers.add(s),()=>{this.subscribers.delete(s)}},this.emit=n=>{this.subscribers.forEach(r=>{r.eventType===n.type&&r.fn(n)})},this.parseLocation=(n,r)=>{const s=({pathname:a,search:u,hash:l,state:f})=>{const h=this.options.parseSearch(u),d=this.options.stringifySearch(h);return{pathname:a,searchStr:d,search:Sn(n?.search,h),hash:l.split("#").reverse()[0]??"",href:`${a}${d}${l}`,state:Sn(n?.state,f)}},i=s(r??this.history.location),{__tempLocation:o,__tempKey:c}=i.state;if(o&&(!c||c===this.tempLocationKey)){const a=s(o);return a.state.key=i.state.key,a.state.__TSR_key=i.state.__TSR_key,delete a.state.__tempLocation,{...a,maskedLocation:i}}return i},this.resolvePathWithBase=(n,r)=>TP({basepath:this.basepath,base:n,to:hl(r),trailingSlash:this.options.trailingSlash,caseSensitive:this.options.caseSensitive}),this.matchRoutes=(n,r,s)=>typeof n=="string"?this.matchRoutesInternal({pathname:n,search:r},s):this.matchRoutesInternal(n,r),this.getMatchedRoutes=(n,r)=>ZP({pathname:n,routePathname:r,basepath:this.basepath,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes}),this.cancelMatch=n=>{const r=this.getMatch(n);r&&(r.abortController.abort(),clearTimeout(r.pendingTimeout))},this.cancelMatches=()=>{var n;(n=this.state.pendingMatches)==null||n.forEach(r=>{this.cancelMatch(r.id)})},this.buildLocation=n=>{const r=(i={})=>{var o;const c=i._fromLocation||this.latestLocation,a=this.matchRoutes(c,{_buildLocation:!0}),u=Rh(a);let l=u.fullPath;i.unsafeRelative==="path"?l=c.pathname:i.to&&i.from&&(l=i.from,[...a].reverse().find($=>$.fullPath===l||$.fullPath===zn([l,"/"]))||console.warn(`Could not find match for from: ${i.from}`));const f=u.search,h={...u.params},d=i.to?this.resolvePathWithBase(l,`${i.to}`):this.resolvePathWithBase(l,".");let m=(i.params??!0)===!0?h:{...h,...rs(i.params,h)};const y=this.matchRoutes(d,{},{_buildLocation:!0}).map(v=>this.looseRoutesById[v.routeId]);Object.keys(m).length>0&&y.map(v=>{var $;return(($=v.options.params)==null?void 0:$.stringify)??v.options.stringifyParams}).filter(Boolean).forEach(v=>{m={...m,...v(m)}});const b=Lf({path:d,params:m??{},leaveWildcards:!1,leaveParams:n.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath;let _=f;if(n._includeValidateSearch&&((o=this.options.search)!=null&&o.strict)){let v={};y.forEach($=>{try{$.options.validateSearch&&(v={...v,...Fh($.options.validateSearch,{...v,..._})??{}})}catch{}}),_=v}_=eR({search:_,dest:i,destRoutes:y,_includeValidateSearch:n._includeValidateSearch}),_=Sn(f,_);const S=this.options.stringifySearch(_),E=i.hash===!0?c.hash:i.hash?rs(i.hash,c.hash):void 0,O=E?`#${E}`:"";let C=i.state===!0?c.state:i.state?rs(i.state,c.state):{};return C=Sn(c.state,C),{pathname:b,search:_,searchStr:S,state:C,hash:E??"",href:`${b}${S}${O}`,unmaskOnReload:i.unmaskOnReload}},s=(i={},o)=>{var c;const a=r(i);let u=o?r(o):void 0;if(!u){let l={};const f=(c=this.options.routeMasks)==null?void 0:c.find(h=>{const d=Th(this.basepath,a.pathname,{to:h.from,caseSensitive:!1,fuzzy:!1});return d?(l=d,!0):!1});if(f){const{from:h,...d}=f;o={...$h(n,["from"]),...d,params:l},u=r(o)}}if(u){const l=r(o);a.maskedLocation=l}return a};return n.mask?s(n,{...$h(n,["from"]),...n.mask}):s(n)},this.commitLocation=({viewTransition:n,ignoreBlocker:r,...s})=>{const i=()=>{const a=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];a.forEach(l=>{s.state[l]=this.latestLocation.state[l]});const u=di(s.state,this.latestLocation.state);return a.forEach(l=>{delete s.state[l]}),u},o=this.latestLocation.href===s.href,c=this.commitLocationPromise;if(this.commitLocationPromise=ni(()=>{c?.resolve()}),o&&i())this.load();else{let{maskedLocation:a,hashScrollIntoView:u,...l}=s;a&&(l={...a,state:{...a.state,__tempKey:void 0,__tempLocation:{...l,search:l.searchStr,state:{...l.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(l.unmaskOnReload??this.options.unmaskOnReload??!1)&&(l.state.__tempKey=this.tempLocationKey)),l.state.__hashScrollIntoViewOptions=u??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=n,this.history[s.replace?"replace":"push"](l.href,l.state,{ignoreBlocker:r})}return this.resetNextScroll=s.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:n,resetScroll:r,hashScrollIntoView:s,viewTransition:i,ignoreBlocker:o,href:c,...a}={})=>{if(c){const l=this.history.location.state.__TSR_index,f=rc(c,{__TSR_index:n?l:l+1});a.to=f.pathname,a.search=this.options.parseSearch(f.search),a.hash=f.hash.slice(1)}const u=this.buildLocation({...a,_includeValidateSearch:!0});return this.commitLocation({...u,viewTransition:i,replace:n,resetScroll:r,hashScrollIntoView:s,ignoreBlocker:o})},this.navigate=({to:n,reloadDocument:r,href:s,...i})=>{if(!r&&s)try{new URL(`${s}`),r=!0}catch{}if(r){if(!s){const o=this.buildLocation({to:n,...i});s=this.history.createHref(o.href)}i.replace?window.location.replace(s):window.location.href=s;return}return this.buildAndCommitLocation({...i,href:s,to:n})},this.beforeLoad=()=>{if(this.cancelMatches(),this.latestLocation=this.parseLocation(this.latestLocation),this.isServer){const r=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});if(Nf(this.latestLocation.href)!==Nf(r.href))throw Q_({href:r.href})}const n=this.matchRoutes(this.latestLocation);this.__store.setState(r=>({...r,status:"pending",isLoading:!0,location:this.latestLocation,pendingMatches:n,cachedMatches:r.cachedMatches.filter(s=>!n.find(i=>i.id===s.id))}))},this.load=async n=>{let r,s,i;for(i=new Promise(o=>{this.startTransition(async()=>{var c;try{this.beforeLoad();const a=this.latestLocation,u=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...ss({resolvedLocation:u,location:a})}),this.emit({type:"onBeforeLoad",...ss({resolvedLocation:u,location:a})}),await this.loadMatches({sync:n?.sync,matches:this.state.pendingMatches,location:a,onReady:async()=>{this.startViewTransition(async()=>{let l,f,h;Wg(()=>{this.__store.setState(d=>{const m=d.matches,y=d.pendingMatches||d.matches;return l=m.filter(b=>!y.find(_=>_.id===b.id)),f=y.filter(b=>!m.find(_=>_.id===b.id)),h=m.filter(b=>y.find(_=>_.id===b.id)),{...d,isLoading:!1,loadedAt:Date.now(),matches:y,pendingMatches:void 0,cachedMatches:[...d.cachedMatches,...l.filter(b=>b.status!=="error")]}}),this.clearExpiredCache()}),[[l,"onLeave"],[f,"onEnter"],[h,"onStay"]].forEach(([d,m])=>{d.forEach(y=>{var b,_;(_=(b=this.looseRoutesById[y.routeId].options)[m])==null||_.call(b,y)})})})}})}catch(a){sn(a)?(r=a,this.isServer||this.navigate({...r.options,replace:!0,ignoreBlocker:!0})):Dt(a)&&(s=a),this.__store.setState(u=>({...u,statusCode:r?r.status:s?404:u.matches.some(l=>l.status==="error")?500:200,redirect:r}))}this.latestLoadPromise===i&&((c=this.commitLocationPromise)==null||c.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),o()})}),this.latestLoadPromise=i,await i;this.latestLoadPromise&&i!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(o=>({...o,statusCode:404}))},this.startViewTransition=n=>{const r=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,r&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let s;if(typeof r=="object"&&this.isViewTransitionTypesSupported){const i=this.latestLocation,o=this.state.resolvedLocation,c=typeof r.types=="function"?r.types(ss({resolvedLocation:o,location:i})):r.types;s={update:n,types:c}}else s=n;document.startViewTransition(s)}else n()},this.updateMatch=(n,r)=>{var s;let i;const o=(s=this.state.pendingMatches)==null?void 0:s.find(l=>l.id===n),c=this.state.matches.find(l=>l.id===n),a=this.state.cachedMatches.find(l=>l.id===n),u=o?"pendingMatches":c?"matches":a?"cachedMatches":"";return u&&this.__store.setState(l=>{var f;return{...l,[u]:(f=l[u])==null?void 0:f.map(h=>h.id===n?i=r(h):h)}}),i},this.getMatch=n=>[...this.state.cachedMatches,...this.state.pendingMatches??[],...this.state.matches].find(r=>r.id===n),this.loadMatches=async({location:n,matches:r,preload:s,onReady:i,updateMatch:o=this.updateMatch,sync:c})=>{let a,u=!1;const l=async()=>{u||(u=!0,await i?.())},f=d=>!!(s&&!this.state.matches.find(m=>m.id===d)),h=(d,m)=>{var y,b,_,S;if(sn(m)||Dt(m)){if(sn(m)&&m.redirectHandled&&!m.options.reloadDocument)throw m;if((y=d.beforeLoadPromise)==null||y.resolve(),(b=d.loaderPromise)==null||b.resolve(),o(d.id,E=>({...E,status:sn(m)?"redirected":Dt(m)?"notFound":"error",isFetching:!1,error:m,beforeLoadPromise:void 0,loaderPromise:void 0})),m.routeId||(m.routeId=d.routeId),(_=d.loadPromise)==null||_.resolve(),sn(m))throw u=!0,m.options._fromLocation=n,m.redirectHandled=!0,m=this.resolveRedirect(m),m;if(Dt(m))throw this._handleNotFound(r,m,{updateMatch:o}),(S=this.serverSsr)==null||S.onMatchSettled({router:this,match:this.getMatch(d.id)}),m}};try{await new Promise((d,m)=>{(async()=>{var y,b,_,S;try{const E=(v,$,w)=>{var P,k;const{id:R,routeId:F}=r[v],L=this.looseRoutesById[F];if($ instanceof Promise)throw $;$.routerCode=w,a=a??v,h(this.getMatch(R),$);try{(k=(P=L.options).onError)==null||k.call(P,$)}catch(U){$=U,h(this.getMatch(R),$)}o(R,U=>{var re,H;return(re=U.beforeLoadPromise)==null||re.resolve(),(H=U.loadPromise)==null||H.resolve(),{...U,error:$,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController,beforeLoadPromise:void 0}})};for(const[v,{id:$,routeId:w}]of r.entries()){const P=this.getMatch($),k=(y=r[v-1])==null?void 0:y.id,R=this.looseRoutesById[w],F=R.options.pendingMs??this.options.defaultPendingMs,L=!!(i&&!this.isServer&&!f($)&&(R.options.loader||R.options.beforeLoad||ey(R))&&typeof F=="number"&&F!==1/0&&(R.options.pendingComponent??((b=this.options)==null?void 0:b.defaultPendingComponent)));let U=!0;if((P.beforeLoadPromise||P.loaderPromise)&&(L&&setTimeout(()=>{try{l()}catch{}},F),await P.beforeLoadPromise,U=this.getMatch($).status==="error"),U){try{o($,Ae=>{const ge=Ae.loadPromise;return{...Ae,loadPromise:ni(()=>{ge?.resolve()}),beforeLoadPromise:ni()}});const re=new AbortController;let H;L&&(H=setTimeout(()=>{try{l()}catch{}},F));const{paramsError:j,searchError:Q}=this.getMatch($);j&&E(v,j,"PARSE_PARAMS"),Q&&E(v,Q,"VALIDATE_SEARCH");const Ye=()=>k?this.getMatch(k).context:this.options.context??{};o($,Ae=>({...Ae,isFetching:"beforeLoad",fetchCount:Ae.fetchCount+1,abortController:re,pendingTimeout:H,context:{...Ye(),...Ae.__routeContext}}));const{search:yt,params:me,context:bn,cause:Oo}=this.getMatch($),Te=f($),rt={search:yt,abortController:re,params:me,preload:Te,context:bn,location:n,navigate:Ae=>this.navigate({...Ae,_fromLocation:n}),buildLocation:this.buildLocation,cause:Te?"preload":Oo,matches:r},lt=await((S=(_=R.options).beforeLoad)==null?void 0:S.call(_,rt))??{};(sn(lt)||Dt(lt))&&E(v,lt,"BEFORE_LOAD"),o($,Ae=>({...Ae,__beforeLoadContext:lt,context:{...Ye(),...Ae.__routeContext,...lt},abortController:re}))}catch(re){E(v,re,"BEFORE_LOAD")}o($,re=>{var H;return(H=re.beforeLoadPromise)==null||H.resolve(),{...re,beforeLoadPromise:void 0,isFetching:!1}})}}const O=r.slice(0,a),C=[];O.forEach(({id:v,routeId:$},w)=>{C.push((async()=>{const{loaderPromise:P}=this.getMatch(v);let k=!1,R=!1;if(P){await P;const F=this.getMatch(v);F.error&&h(F,F.error)}else{const F=C[w-1],L=this.looseRoutesById[$],U=()=>{const{params:Te,loaderDeps:rt,abortController:lt,context:Ae,cause:ge}=this.getMatch(v),Ne=f(v);return{params:Te,deps:rt,preload:!!Ne,parentMatchPromise:F,abortController:lt,context:Ae,location:n,navigate:Le=>this.navigate({...Le,_fromLocation:n}),cause:Ne?"preload":ge,route:L}},re=Date.now()-this.getMatch(v).updatedAt,H=f(v),j=H?L.options.preloadStaleTime??this.options.defaultPreloadStaleTime??3e4:L.options.staleTime??this.options.defaultStaleTime??0,Q=L.options.shouldReload,Ye=typeof Q=="function"?Q(U()):Q;o(v,Te=>({...Te,loaderPromise:ni(),preload:!!H&&!this.state.matches.find(rt=>rt.id===v)}));const yt=async()=>{var Te,rt,lt,Ae,ge,Ne;const Le=this.getMatch(v);if(!Le)return;const kt={matches:r,match:Le,params:Le.params,loaderData:Le.loaderData},bt=await((rt=(Te=L.options).head)==null?void 0:rt.call(Te,kt)),wr=bt?.meta,ko=bt?.links,Sa=bt?.scripts,wa=await((Ae=(lt=L.options).scripts)==null?void 0:Ae.call(lt,kt)),Ff=await((Ne=(ge=L.options).headers)==null?void 0:Ne.call(ge,kt));return{meta:wr,links:ko,headScripts:Sa,headers:Ff,scripts:wa}},me=async()=>{var Te,rt,lt,Ae,ge;try{const Ne=async()=>{const Le=this.getMatch(v);Le.minPendingPromise&&await Le.minPendingPromise};try{this.loadRouteChunk(L),o(v,bt=>({...bt,isFetching:"loader"}));const Le=await((rt=(Te=L.options).loader)==null?void 0:rt.call(Te,U()));h(this.getMatch(v),Le),await L._lazyPromise,await Ne(),await L._componentsPromise,o(v,bt=>({...bt,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),loaderData:Le}));const kt=await yt();o(v,bt=>({...bt,...kt}))}catch(Le){let kt=Le;await Ne(),h(this.getMatch(v),Le);try{(Ae=(lt=L.options).onError)==null||Ae.call(lt,Le)}catch(wr){kt=wr,h(this.getMatch(v),wr)}const bt=await yt();o(v,wr=>({...wr,error:kt,status:"error",isFetching:!1,...bt}))}(ge=this.serverSsr)==null||ge.onMatchSettled({router:this,match:this.getMatch(v)})}catch(Ne){const Le=await yt();o(v,kt=>({...kt,loaderPromise:void 0,...Le})),h(this.getMatch(v),Ne)}},{status:bn,invalid:Oo}=this.getMatch(v);if(k=bn==="success"&&(Oo||(Ye??re>j)),!(H&&L.options.preload===!1))if(k&&!c)R=!0,(async()=>{try{await me();const{loaderPromise:Te,loadPromise:rt}=this.getMatch(v);Te?.resolve(),rt?.resolve(),o(v,lt=>({...lt,loaderPromise:void 0}))}catch(Te){sn(Te)&&await this.navigate(Te.options)}})();else if(bn!=="success"||k&&c)await me();else{const Te=await yt();o(v,rt=>({...rt,...Te}))}}if(!R){const{loaderPromise:F,loadPromise:L}=this.getMatch(v);F?.resolve(),L?.resolve()}return o(v,F=>({...F,isFetching:R?F.isFetching:!1,loaderPromise:R?F.loaderPromise:void 0,invalid:!1})),this.getMatch(v)})())}),await Promise.all(C),d()}catch(E){m(E)}})()}),await l()}catch(d){if(sn(d)||Dt(d))throw Dt(d)&&!s&&await l(),d}return r},this.invalidate=n=>{const r=s=>{var i;return((i=n?.filter)==null?void 0:i.call(n,s))??!0?{...s,invalid:!0,...s.status==="error"?{status:"pending",error:void 0}:{}}:s};return this.__store.setState(s=>{var i;return{...s,matches:s.matches.map(r),cachedMatches:s.cachedMatches.map(r),pendingMatches:(i=s.pendingMatches)==null?void 0:i.map(r)}}),this.shouldViewTransition=!1,this.load({sync:n?.sync})},this.resolveRedirect=n=>(n.options.href||(n.options.href=this.buildLocation(n.options).href,n.headers.set("Location",n.options.href)),n.headers.get("Location")||n.headers.set("Location",n.options.href),n),this.clearCache=n=>{const r=n?.filter;r!==void 0?this.__store.setState(s=>({...s,cachedMatches:s.cachedMatches.filter(i=>!r(i))})):this.__store.setState(s=>({...s,cachedMatches:[]}))},this.clearExpiredCache=()=>{const n=r=>{const s=this.looseRoutesById[r.routeId];if(!s.options.loader)return!0;const i=(r.preload?s.options.preloadGcTime??this.options.defaultPreloadGcTime:s.options.gcTime??this.options.defaultGcTime)??5*60*1e3;return!(r.status!=="error"&&Date.now()-r.updatedAt<i)};this.clearCache({filter:n})},this.loadRouteChunk=n=>(n._lazyPromise===void 0&&(n.lazyFn?n._lazyPromise=n.lazyFn().then(r=>{const{id:s,...i}=r.options;Object.assign(n.options,i)}):n._lazyPromise=Promise.resolve()),n._componentsPromise===void 0&&(n._componentsPromise=n._lazyPromise.then(()=>Promise.all(G_.map(async r=>{const s=n.options[r];s?.preload&&await s.preload()})))),n._componentsPromise),this.preloadRoute=async n=>{const r=this.buildLocation(n);let s=this.matchRoutes(r,{throwOnError:!0,preload:!0,dest:n});const i=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(c=>c.id)),o=new Set([...i,...this.state.cachedMatches.map(c=>c.id)]);Wg(()=>{s.forEach(c=>{o.has(c.id)||this.__store.setState(a=>({...a,cachedMatches:[...a.cachedMatches,c]}))})});try{return s=await this.loadMatches({matches:s,location:r,preload:!0,updateMatch:(c,a)=>{i.has(c)?s=s.map(u=>u.id===c?a(u):u):this.updateMatch(c,a)}}),s}catch(c){if(sn(c))return c.options.reloadDocument?void 0:await this.preloadRoute({...c.options,_fromLocation:r});Dt(c)||console.error(c);return}},this.matchRoute=(n,r)=>{const s={...n,to:n.to?this.resolvePathWithBase(n.from||"",n.to):void 0,params:n.params||{},leaveParams:!0},i=this.buildLocation(s);if(r?.pending&&this.state.status!=="pending")return!1;const c=(r?.pending===void 0?!this.state.isLoading:r.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,a=Th(this.basepath,c.pathname,{...r,to:i.pathname});return!a||n.params&&!di(a,n.params,{partial:!0})?!1:a&&(r?.includeSearch??!0)?di(c.search,i.search,{partial:!0})?a:!1:a},this._handleNotFound=(n,r,{updateMatch:s=this.updateMatch}={})=>{var i;const o=this.routesById[r.routeId??""]??this.routeTree,c={};for(const u of n)c[u.routeId]=u;!o.options.notFoundComponent&&((i=this.options)!=null&&i.defaultNotFoundComponent)&&(o.options.notFoundComponent=this.options.defaultNotFoundComponent),mn(o.options.notFoundComponent);const a=c[o.id];mn(a,"Could not find match for route: "+o.id),s(a.id,u=>({...u,status:"notFound",error:r,isFetching:!1})),r.routerCode==="BEFORE_LOAD"&&o.parentRoute&&(r.routeId=o.parentRoute.id,this._handleNotFound(n,r,{updateMatch:s}))},this.hasNotFoundMatch=()=>this.__store.state.matches.some(n=>n.status==="notFound"||n.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...t,caseSensitive:t.caseSensitive??!1,notFoundMode:t.notFoundMode??"fuzzy",stringifySearch:t.stringifySearch??VP,parseSearch:t.parseSearch??zP}),typeof document<"u"&&(window.__TSR_ROUTER__=this)}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(t,n){var r;const{foundRoute:s,matchedRoutes:i,routeParams:o}=this.getMatchedRoutes(t.pathname,(r=n?.dest)==null?void 0:r.to);let c=!1;(s?s.path!=="/"&&o["**"]:Ci(t.pathname))&&(this.options.notFoundRoute?i.push(this.options.notFoundRoute):c=!0);const a=(()=>{if(c){if(this.options.notFoundMode!=="root")for(let h=i.length-1;h>=0;h--){const d=i[h];if(d.children)return d.id}return wn}})(),u=i.map(h=>{var d;let m;const y=((d=h.options.params)==null?void 0:d.parse)??h.options.parseParams;if(y)try{const b=y(o);Object.assign(o,b)}catch(b){if(m=new GP(b.message,{cause:b}),n?.throwOnError)throw m;return m}}),l=[],f=h=>h?.id?h.context??this.options.context??{}:this.options.context??{};return i.forEach((h,d)=>{var m,y;const b=l[d-1],[_,S,E]=(()=>{const U=b?.search??t.search,re=b?._strictSearch??{};try{const H=Fh(h.options.validateSearch,{...U})??{};return[{...U,...H},{...re,...H},void 0]}catch(H){let j=H;if(H instanceof mu||(j=new mu(H.message,{cause:H})),n?.throwOnError)throw j;return[U,{},j]}})(),O=((y=(m=h.options).loaderDeps)==null?void 0:y.call(m,{search:_}))??"",C=O?JSON.stringify(O):"",{usedParams:v,interpolatedPath:$}=Lf({path:h.fullPath,params:o,decodeCharMap:this.pathParamsDecodeCharMap}),w=Lf({path:h.id,params:o,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath+C,P=this.getMatch(w),k=this.state.matches.find(U=>U.routeId===h.id),R=k?"stay":"enter";let F;if(P)F={...P,cause:R,params:k?Sn(k.params,o):o,_strictParams:v,search:Sn(k?k.search:P.search,_),_strictSearch:S};else{const U=h.options.loader||h.options.beforeLoad||h.lazyFn||ey(h)?"pending":"success";F={id:w,index:d,routeId:h.id,params:k?Sn(k.params,o):o,_strictParams:v,pathname:zn([this.basepath,$]),updatedAt:Date.now(),search:k?Sn(k.search,_):_,_strictSearch:S,searchError:void 0,status:U,isFetching:!1,error:void 0,paramsError:u[d],__routeContext:{},__beforeLoadContext:{},context:{},abortController:new AbortController,fetchCount:0,cause:R,loaderDeps:k?Sn(k.loaderDeps,O):O,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:h.options.staticData||{},loadPromise:ni(),fullPath:h.fullPath}}n?.preload||(F.globalNotFound=a===h.id),F.searchError=E;const L=f(b);F.context={...L,...F.__routeContext,...F.__beforeLoadContext},l.push(F)}),l.forEach((h,d)=>{var m,y;const b=this.looseRoutesById[h.routeId];if(!this.getMatch(h.id)&&n?._buildLocation!==!0){const S=l[d-1],E=f(S),O={deps:h.loaderDeps,params:h.params,context:E,location:t,navigate:C=>this.navigate({...C,_fromLocation:t}),buildLocation:this.buildLocation,cause:h.cause,abortController:h.abortController,preload:!!h.preload,matches:l};h.__routeContext=((y=(m=b.options).context)==null?void 0:y.call(m,O))??{},h.context={...E,...h.__routeContext,...h.__beforeLoadContext}}}),l}}class mu extends Error{}class GP extends Error{}function YP(e){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:e,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function Fh(e,t){if(e==null)return{};if("~standard"in e){const n=e["~standard"].validate(t);if(n instanceof Promise)throw new mu("Async validation not supported");if(n.issues)throw new mu(JSON.stringify(n.issues,void 0,2),{cause:n});return n.value}return"parse"in e?e.parse(t):typeof e=="function"?e(t):{}}const G_=["component","errorComponent","pendingComponent","notFoundComponent"];function ey(e){var t;for(const n of G_)if((t=e.options[n])!=null&&t.preload)return!0;return!1}function XP({routeTree:e,initRoute:t}){const n={},r={},s=a=>{a.forEach((u,l)=>{t?.(u,l);const f=n[u.id];if(mn(!f,`Duplicate routes found with id: ${String(u.id)}`),n[u.id]=u,!u.isRoot&&u.path){const d=Ci(u.fullPath);(!r[d]||u.fullPath.endsWith("/"))&&(r[d]=u)}const h=u.children;h?.length&&s(h)})};s([e]);const i=[];Object.values(n).forEach((a,u)=>{var l;if(a.isRoot||!a.path)return;const f=up(a.fullPath),h=Pi(f);for(;h.length>1&&((l=h[0])==null?void 0:l.value)==="/";)h.shift();const d=h.map(m=>m.value==="/"?.75:m.type==="param"&&m.prefixSegment&&m.suffixSegment?.55:m.type==="param"&&m.prefixSegment?.52:m.type==="param"&&m.suffixSegment?.51:m.type==="param"?.5:m.type==="wildcard"&&m.prefixSegment&&m.suffixSegment?.3:m.type==="wildcard"&&m.prefixSegment?.27:m.type==="wildcard"&&m.suffixSegment?.26:m.type==="wildcard"?.25:1);i.push({child:a,trimmed:f,parsed:h,index:u,scores:d})});const c=i.sort((a,u)=>{const l=Math.min(a.scores.length,u.scores.length);for(let f=0;f<l;f++)if(a.scores[f]!==u.scores[f])return u.scores[f]-a.scores[f];if(a.scores.length!==u.scores.length)return u.scores.length-a.scores.length;for(let f=0;f<l;f++)if(a.parsed[f].value!==u.parsed[f].value)return a.parsed[f].value>u.parsed[f].value?1:-1;return a.index-u.index}).map((a,u)=>(a.child.rank=u,a.child));return{routesById:n,routesByPath:r,flatRoutes:c}}function ZP({pathname:e,routePathname:t,basepath:n,caseSensitive:r,routesByPath:s,routesById:i,flatRoutes:o}){let c={};const a=Ci(e),u=d=>{var m;return Th(n,a,{to:d.fullPath,caseSensitive:((m=d.options)==null?void 0:m.caseSensitive)??r,fuzzy:!0})};let l=t!==void 0?s[t]:void 0;l?c=u(l):l=o.find(d=>{const m=u(d);return m?(c=m,!0):!1});let f=l||i[wn];const h=[f];for(;f.parentRoute;)f=f.parentRoute,h.unshift(f);return{matchedRoutes:h,routeParams:c,foundRoute:l}}function eR({search:e,dest:t,destRoutes:n,_includeValidateSearch:r}){const s=n.reduce((c,a)=>{var u;const l=[];if("search"in a.options)(u=a.options.search)!=null&&u.middlewares&&l.push(...a.options.search.middlewares);else if(a.options.preSearchFilters||a.options.postSearchFilters){const f=({search:h,next:d})=>{let m=h;"preSearchFilters"in a.options&&a.options.preSearchFilters&&(m=a.options.preSearchFilters.reduce((b,_)=>_(b),h));const y=d(m);return"postSearchFilters"in a.options&&a.options.postSearchFilters?a.options.postSearchFilters.reduce((b,_)=>_(b),y):y};l.push(f)}if(r&&a.options.validateSearch){const f=({search:h,next:d})=>{const m=d(h);try{return{...m,...Fh(a.options.validateSearch,m)??{}}}catch{return m}};l.push(f)}return c.concat(l)},[])??[],i=({search:c})=>t.search?t.search===!0?c:rs(t.search,c):{};s.push(i);const o=(c,a)=>{if(c>=s.length)return a;const u=s[c];return u({search:a,next:f=>o(c+1,f)})};return o(0,e)}const tR="Error preloading route! ☝️";class Y_{constructor(t){if(this.init=n=>{var r,s;this.originalIndex=n.originalIndex;const i=this.options,o=!i?.path&&!i?.id;this.parentRoute=(s=(r=this.options).getParentRoute)==null?void 0:s.call(r),o?this._path=wn:this.parentRoute||mn(!1);let c=o?wn:i?.path;c&&c!=="/"&&(c=up(c));const a=i?.id||c;let u=o?wn:zn([this.parentRoute.id===wn?"":this.parentRoute.id,a]);c===wn&&(c="/"),u!==wn&&(u=zn(["/",u]));const l=u===wn?"/":zn([this.parentRoute.fullPath,c]);this._path=c,this._id=u,this._fullPath=l,this._to=l,this._ssr=i?.ssr??n.defaultSsr??!0},this.clone=n=>{this._path=n._path,this._id=n._id,this._fullPath=n._fullPath,this._to=n._to,this._ssr=n._ssr,this.options.getParentRoute=n.options.getParentRoute,this.children=n.children},this.addChildren=n=>this._addFileChildren(n),this._addFileChildren=n=>(Array.isArray(n)&&(this.children=n),typeof n=="object"&&n!==null&&(this.children=Object.values(n)),this),this._addFileTypes=()=>this,this.updateLoader=n=>(Object.assign(this.options,n),this),this.update=n=>(Object.assign(this.options,n),this),this.lazy=n=>(this.lazyFn=n,this),this.options=t||{},this.isRoot=!t?.getParentRoute,t?.id&&t?.path)throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}get ssr(){return this._ssr}}class nR extends Y_{constructor(t){super(t)}}const Tt={stringify:e=>JSON.stringify(e,function(n,r){const s=this[n],i=ka.find(o=>o.stringifyCondition(s));return i?i.stringify(s):r}),parse:e=>JSON.parse(e,function(n,r){const s=this[n];if(rr(s)){const i=ka.find(o=>o.parseCondition(s));if(i)return i.parse(s)}return r}),encode:e=>{if(Array.isArray(e))return e.map(n=>Tt.encode(n));if(rr(e))return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,Tt.encode(r)]));const t=ka.find(n=>n.stringifyCondition(e));return t?t.stringify(e):e},decode:e=>{if(rr(e)){const t=ka.find(n=>n.parseCondition(e));if(t)return t.parse(e)}return Array.isArray(e)?e.map(t=>Tt.decode(t)):rr(e)?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Tt.decode(n)])):e}},Co=(e,t,n,r)=>({key:e,stringifyCondition:t,stringify:s=>({[`$${e}`]:n(s)}),parseCondition:s=>Object.hasOwn(s,`$${e}`),parse:s=>r(s[`$${e}`])}),ka=[Co("undefined",e=>e===void 0,()=>0,()=>{}),Co("date",e=>e instanceof Date,e=>e.toISOString(),e=>new Date(e)),Co("error",e=>e instanceof Error,e=>({...e,message:e.message,stack:void 0,cause:e.cause}),e=>Object.assign(new Error(e.message),e)),Co("formData",e=>e instanceof FormData,e=>{const t={};return e.forEach((n,r)=>{const s=t[r];s!==void 0?Array.isArray(s)?s.push(n):t[r]=[s,n]:t[r]=n}),t},e=>{const t=new FormData;return Object.entries(e).forEach(([n,r])=>{Array.isArray(r)?r.forEach(s=>t.append(n,s)):t.append(n,r)}),t}),Co("bigint",e=>typeof e=="bigint",e=>e.toString(),e=>BigInt(e))];async function rR(e){var t,n,r;mn((t=window.__TSR_SSR__)==null?void 0:t.dehydrated);const{manifest:s,dehydratedData:i,lastMatchId:o}=Tt.parse(window.__TSR_SSR__.dehydrated);e.ssr={manifest:s,serializer:Tt},e.clientSsr={getStreamedValue:u=>{var l;if(e.isServer)return;const f=(l=window.__TSR_SSR__)==null?void 0:l.streamedValues[u];if(f)return f.parsed||(f.parsed=e.ssr.serializer.parse(f.value)),f.parsed}};const c=e.matchRoutes(e.state.location),a=Promise.all(c.map(u=>{const l=e.looseRoutesById[u.routeId];return e.loadRouteChunk(l)}));return c.forEach(u=>{var l;const f=window.__TSR_SSR__.matches.find(h=>h.id===u.id);if(f)return Object.assign(u,f),f.__beforeLoadContext&&(u.__beforeLoadContext=e.ssr.serializer.parse(f.__beforeLoadContext)),f.loaderData&&(u.loaderData=e.ssr.serializer.parse(f.loaderData)),f.error&&(u.error=e.ssr.serializer.parse(f.error)),(l=u.extracted)==null||l.forEach(h=>{Mh(u,["loaderData",...h.path],h.value)}),u}),e.__store.setState(u=>({...u,matches:c})),await((r=(n=e.options).hydrate)==null?void 0:r.call(n,i)),await Promise.all(e.state.matches.map(async u=>{var l,f,h,d,m,y;const b=e.looseRoutesById[u.routeId],_=e.state.matches[u.index-1],S=_?.context??e.options.context??{},E={deps:u.loaderDeps,params:u.params,context:S,location:e.state.location,navigate:$=>e.navigate({...$,_fromLocation:e.state.location}),buildLocation:e.buildLocation,cause:u.cause,abortController:u.abortController,preload:!1,matches:c};u.__routeContext=((f=(l=b.options).context)==null?void 0:f.call(l,E))??{},u.context={...S,...u.__routeContext,...u.__beforeLoadContext};const O={matches:e.state.matches,match:u,params:u.params,loaderData:u.loaderData},C=await((d=(h=b.options).head)==null?void 0:d.call(h,O)),v=await((y=(m=b.options).scripts)==null?void 0:y.call(m,O));u.meta=C?.meta,u.links=C?.links,u.headScripts=C?.scripts,u.scripts=v})),c[c.length-1].id!==o?await Promise.all([a,e.load()]):a}function Mh(e,t,n){t.length===1&&(e[t[0]]=n);const[r,...s]=t;Array.isArray(e)?Mh(e[Number(r)],s,n):rr(e)&&Mh(e[r],s,n)}const sR="modulepreload",iR=function(e){return"/"+e},ty={},oi=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(u){return Promise.all(u.map(l=>Promise.resolve(l).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=a(n.map(u=>{if(u=iR(u),u in ty)return;ty[u]=!0;const l=u.endsWith(".css"),f=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":sR,l||(h.as="script"),h.crossOrigin="",h.href=u,c&&h.setAttribute("nonce",c),document.head.appendChild(h),l)return new Promise((d,m)=>{h.addEventListener("load",d),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})};const oR=[];function Ua(e,t){const n=t||e||{};return typeof n.method>"u"&&(n.method="GET"),{options:n,middleware:r=>Ua(void 0,Object.assign(n,{middleware:r})),validator:r=>Ua(void 0,Object.assign(n,{validator:r})),type:r=>Ua(void 0,Object.assign(n,{type:r})),handler:(...r)=>{const[s,i]=r;Object.assign(n,{...s,extractedFn:s,serverFn:i});const o=[...n.middleware||[],dR(n)];return Object.assign(async c=>ny(o,"client",{...s,...n,data:c?.data,headers:c?.headers,signal:c?.signal,context:{}}).then(a=>{if(n.response==="full")return a;if(a.error)throw a.error;return a.result}),{...s,__executeServer:async(c,a)=>{const u=c instanceof FormData?uR(c):c;u.type=typeof n.type=="function"?n.type(u):n.type;const l={...s,...u,signal:a},f=()=>ny(o,"server",l).then(h=>({result:h.result,error:h.error,context:h.sendContext}));if(l.type==="static"){let h;if(En?.getItem&&(h=await En.getItem(l)),h||(h=await f().then(d=>({ctx:d,error:null})).catch(d=>({ctx:void 0,error:d})),En?.setItem&&await En.setItem(l,h)),mn(h),h.error)throw h.error;return h.ctx}return f()}})}}}async function ny(e,t,n){const r=lR([...oR,...e]),s=async i=>{const o=r.shift();if(!o)return i;o.options.validator&&(t!=="client"||o.options.validateClient)&&(i.data=await hR(o.options.validator,i.data));const c=t==="client"?o.options.client:o.options.server;return c?fR(c,i,async a=>s(a).catch(u=>{if(sn(u)||Dt(u))return{...a,error:u};throw u})):s(i)};return s({...n,headers:n.headers||{},sendContext:n.sendContext||{},context:n.context||{}})}let En;function cR(e){const t=En;return En=typeof e=="function"?e():e,()=>{En=t}}async function aR(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-1",t);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}cR(()=>{const e=async(r,s)=>`/__tsr/staticServerFnCache/${await aR(`${r.functionId}__${s}`)}.json`,t=r=>JSON.stringify(r??"",(o,c)=>c&&typeof c=="object"&&!Array.isArray(c)?Object.keys(c).sort().reduce((a,u)=>(a[u]=c[u],a),{}):c).replace(/[/\\?%*:|"<>]/g,"-").replace(/\s+/g,"_"),n=typeof document<"u"?new Map:null;return{getItem:async r=>{if(typeof document>"u"){const s=t(r.data),i=await e(r,s),o="/Users/andresjimenez/devx-op/effectify/apps/solid-app/.output/public",{promises:c}=await oi(async()=>{const{promises:h}=await import("node:fs");return{promises:h}},[]),u=(await oi(()=>import("node:path"),[])).join(o,i),[l,f]=await c.readFile(u,"utf-8").then(h=>[Tt.parse(h),null]).catch(h=>[null,h]);if(f&&f.code!=="ENOENT")throw f;return l}},setItem:async(r,s)=>{const{promises:i}=await oi(async()=>{const{promises:f}=await import("node:fs");return{promises:f}},[]),o=await oi(()=>import("node:path"),[]),c=t(r.data),a=await e(r,c),l=o.join("/Users/andresjimenez/devx-op/effectify/apps/solid-app/.output/public",a);await i.mkdir(o.dirname(l),{recursive:!0}),await i.writeFile(l,Tt.stringify(s))},fetchItem:async r=>{const s=t(r.data),i=await e(r,s);let o=n?.get(i);return o||(o=await fetch(i,{method:"GET"}).then(c=>c.text()).then(c=>Tt.parse(c)),n?.set(i,o)),o}}});function uR(e){const t=e.get("__TSR_CONTEXT");if(e.delete("__TSR_CONTEXT"),typeof t!="string")return{context:{},data:e};try{return{context:Tt.parse(t),data:e}}catch{return{data:e}}}function lR(e){const t=new Set,n=[],r=s=>{s.forEach(i=>{i.options.middleware&&r(i.options.middleware),t.has(i)||(t.add(i),n.push(i))})};return r(e),n}const fR=async(e,t,n)=>e({...t,next:async(r={})=>n({...t,...r,context:{...t.context,...r.context},sendContext:{...t.sendContext,...r.sendContext??{}},headers:wP(t.headers,r.headers),result:r.result!==void 0?r.result:t.response==="raw"?r:t.result,error:r.error??t.error})});function hR(e,t){if(e==null)return{};if("~standard"in e){const n=e["~standard"].validate(t);if(n instanceof Promise)throw new Error("Async validation not supported");if(n.issues)throw new Error(JSON.stringify(n.issues,void 0,2));return n.value}if("parse"in e)return e.parse(t);if(typeof e=="function")return e(t);throw new Error("Invalid validator type!")}function dR(e){return{_types:void 0,options:{validator:e.validator,validateClient:e.validateClient,client:async({next:t,sendContext:n,...r})=>{var s;const i={...r,context:n,type:typeof r.type=="function"?r.type(r):r.type};if(r.type==="static"&&typeof document<"u"){mn(En);const c=await En.fetchItem(i);if(c){if(c.error)throw c.error;return t(c.ctx)}`${i.functionId}${JSON.stringify(i.data)}`}const o=await((s=e.extractedFn)==null?void 0:s.call(e,i));return t(o)},server:async({next:t,...n})=>{var r;const s=await((r=e.serverFn)==null?void 0:r.call(e,n));return t({...n,result:s})}}}}function pR(e){const[t]=ec(()=>e.promise);return M(j_,{get fallback(){return e.fallback},get when(){return t()},children:n=>e.children(n())})}var mR=Kr("<div><div><strong>Something went wrong!</strong><button></button></div><div></div><!$><!/>"),gR=Kr("<div><pre>"),yR=Kr("<code>");function lp(e){return M(VC,{fallback:(t,n)=>(e.onCatch?.(t),As(cr([e.getResetKey],()=>n(),{defer:!0})),M(kn,{get component(){return e.errorComponent??Mc},error:t,reset:n})),get children(){return e.children}})}function Mc({error:e}){const[t,n]=et(!1);return(()=>{var r=qn(mR),s=r.firstChild,i=s.firstChild,o=i.nextSibling,c=s.nextSibling,a=c.nextSibling,[u,l]=dP(a.nextSibling);return r.style.setProperty("padding",".5rem"),r.style.setProperty("max-width","100%"),s.style.setProperty("display","flex"),s.style.setProperty("align-items","center"),s.style.setProperty("gap",".5rem"),i.style.setProperty("font-size","1rem"),o.$$click=()=>n(f=>!f),o.style.setProperty("appearance","none"),o.style.setProperty("font-size",".6em"),o.style.setProperty("border","1px solid currentColor"),o.style.setProperty("padding",".1rem .2rem"),o.style.setProperty("font-weight","bold"),o.style.setProperty("border-radius",".25rem"),Xr(o,()=>t()?"Hide Error":"Show Error"),c.style.setProperty("height",".25rem"),Xr(r,(()=>{var f=Gt(()=>!!t());return()=>f()?(()=>{var h=qn(gR),d=h.firstChild;return d.style.setProperty("font-size",".7em"),d.style.setProperty("border","1px solid red"),d.style.setProperty("border-radius",".25rem"),d.style.setProperty("padding",".3rem"),d.style.setProperty("color","red"),d.style.setProperty("overflow","auto"),Xr(d,(()=>{var m=Gt(()=>!!e.message);return()=>m()?(()=>{var y=qn(yR);return Xr(y,()=>e.message),y})():null})()),h})():null})(),u,l),uu(),r})()}B_(["click"]);function bR(e){return _R()?Gt(()=>e.children):Gt(()=>e.fallback)}function _R(){const[e,t]=et(!0);return As(()=>{t(!0)}),e}function SR(e){return(...t)=>{for(const n of e)n&&n(...t)}}function wR(...e){return SR(e)}const xh=Symbol("store-raw"),pi=Symbol("store-node"),er=Symbol("store-has"),X_=Symbol("store-self");function Z_(e){let t=e[In];if(!t&&(Object.defineProperty(e,In,{value:t=new Proxy(e,OR)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let s=0,i=n.length;s<i;s++){const o=n[s];r[o].get&&Object.defineProperty(e,o,{enumerable:r[o].enumerable,get:r[o].get.bind(t)})}}return t}function Ir(e){let t;return e!=null&&typeof e=="object"&&(e[In]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ys(e,t=new Set){let n,r,s,i;if(n=e!=null&&e[xh])return n;if(!Ir(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let o=0,c=e.length;o<c;o++)s=e[o],(r=ys(s,t))!==s&&(e[o]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const o=Object.keys(e),c=Object.getOwnPropertyDescriptors(e);for(let a=0,u=o.length;a<u;a++)i=o[a],!c[i].get&&(s=e[i],(r=ys(s,t))!==s&&(e[i]=r))}return e}function gu(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function sc(e,t,n){if(e[t])return e[t];const[r,s]=et(n,{equals:!1,internal:!0});return r.$=s,e[t]=r}function vR(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===In||t===pi||(delete n.value,delete n.writable,n.get=()=>e[In][t]),n}function eS(e){wh()&&sc(gu(e,pi),X_)()}function ER(e){return eS(e),Reflect.ownKeys(e)}const OR={get(e,t,n){if(t===xh)return e;if(t===In)return n;if(t===Sh)return eS(e),n;const r=gu(e,pi),s=r[t];let i=s?s():e[t];if(t===pi||t===er||t==="__proto__")return i;if(!s){const o=Object.getOwnPropertyDescriptor(e,t);wh()&&(typeof i!="function"||e.hasOwnProperty(t))&&!(o&&o.get)&&(i=sc(r,t,i)())}return Ir(i)?Z_(i):i},has(e,t){return t===xh||t===In||t===Sh||t===pi||t===er||t==="__proto__"?!0:(wh()&&sc(gu(e,er),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:ER,getOwnPropertyDescriptor:vR};function on(e,t,n,r=!1){if(!r&&e[t]===n)return;const s=e[t],i=e.length;n===void 0?(delete e[t],e[er]&&e[er][t]&&s!==void 0&&e[er][t].$()):(e[t]=n,e[er]&&e[er][t]&&s===void 0&&e[er][t].$());let o=gu(e,pi),c;if((c=sc(o,t,s))&&c.$(()=>n),Array.isArray(e)&&e.length!==i){for(let a=e.length;a<i;a++)(c=o[a])&&c.$();(c=sc(o,"length",i))&&c.$(e.length)}(c=o[X_])&&c.$()}function tS(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const s=n[r];on(e,s,t[s])}}function kR(e,t){if(typeof t=="function"&&(t=t(e)),t=ys(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const s=t[n];e[n]!==s&&on(e,n,s)}on(e,"length",r)}else tS(e,t)}function Lo(e,t,n=[]){let r,s=e;if(t.length>1){r=t.shift();const o=typeof r,c=Array.isArray(e);if(Array.isArray(r)){for(let a=0;a<r.length;a++)Lo(e,[r[a]].concat(t),n);return}else if(c&&o==="function"){for(let a=0;a<e.length;a++)r(e[a],a)&&Lo(e,[a].concat(t),n);return}else if(c&&o==="object"){const{from:a=0,to:u=e.length-1,by:l=1}=r;for(let f=a;f<=u;f+=l)Lo(e,[f].concat(t),n);return}else if(t.length>1){Lo(e[r],t,[r].concat(n));return}s=e[r],n=[r].concat(n)}let i=t[0];typeof i=="function"&&(i=i(s,n),i===s)||r===void 0&&i==null||(i=ys(i),r===void 0||Ir(s)&&Ir(i)&&!Array.isArray(i)?tS(s,i):on(e,r,i))}function fp(...[e,t]){const n=ys(e||{}),r=Array.isArray(n),s=Z_(n);function i(...o){$C(()=>{r&&o.length===1?kR(n,o[0]):Lo(n,o)})}return[s,i]}const Ah=Symbol("store-root");function ri(e,t,n,r,s){const i=t[n];if(e===i)return;const o=Array.isArray(e);if(n!==Ah&&(!Ir(e)||!Ir(i)||o!==Array.isArray(i)||s&&e[s]!==i[s])){on(t,n,e);return}if(o){if(e.length&&i.length&&(!r||s&&e[0]&&e[0][s]!=null)){let u,l,f,h,d,m,y,b;for(f=0,h=Math.min(i.length,e.length);f<h&&(i[f]===e[f]||s&&i[f]&&e[f]&&i[f][s]===e[f][s]);f++)ri(e[f],i,f,r,s);const _=new Array(e.length),S=new Map;for(h=i.length-1,d=e.length-1;h>=f&&d>=f&&(i[h]===e[d]||s&&i[h]&&e[d]&&i[h][s]===e[d][s]);h--,d--)_[d]=i[h];if(f>d||f>h){for(l=f;l<=d;l++)on(i,l,e[l]);for(;l<e.length;l++)on(i,l,_[l]),ri(e[l],i,l,r,s);i.length>e.length&&on(i,"length",e.length);return}for(y=new Array(d+1),l=d;l>=f;l--)m=e[l],b=s&&m?m[s]:m,u=S.get(b),y[l]=u===void 0?-1:u,S.set(b,l);for(u=f;u<=h;u++)m=i[u],b=s&&m?m[s]:m,l=S.get(b),l!==void 0&&l!==-1&&(_[l]=i[u],l=y[l],S.set(b,l));for(l=f;l<e.length;l++)l in _?(on(i,l,_[l]),ri(e[l],i,l,r,s)):on(i,l,e[l])}else for(let u=0,l=e.length;u<l;u++)ri(e[u],i,u,r,s);i.length>e.length&&on(i,"length",e.length);return}const c=Object.keys(e);for(let u=0,l=c.length;u<l;u++)ri(e[c[u]],i,c[u],r,s);const a=Object.keys(i);for(let u=0,l=a.length;u<l;u++)e[a[u]]===void 0&&on(i,a[u],void 0)}function nS(e,t={}){const{merge:n,key:r="id"}=t,s=ys(e);return i=>{if(!Ir(i)||!Ir(s))return s;const o=ri(s,{[Ah]:i},Ah,n,r);return o===void 0?i:o}}function CR(e,t=n=>n){const[n,r]=fp({value:t(e.state)}),s=e.subscribe(()=>{const i=t(e.state);r("value",nS(i))});return xt(()=>{s()}),()=>n.value}const Uf=yr(null);function rS(){return typeof document>"u"?Uf:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=Uf,Uf)}function yn(e){const t=Qt(rS());return e?.warn,t}function Je(e){const t=yn({warn:e?.router===void 0}),n=e?.router||t;return CR(n.__store,r=>e?.select?e.select(r):r)}const Bf=e=>he((t={current:null,previous:null})=>{const n=e();return t.current!==n&&(t.previous=t.current,t.current=n),t});function PR(e,t,n={},r={}){const s=typeof IntersectionObserver=="function";let i=null;return As(()=>{const o=e();!o||!s||r.disabled||(i=new IntersectionObserver(([c])=>{t(c)},n),i.observe(o),xt(()=>{i?.disconnect()}))}),()=>i}const dl=yr(()=>{}),RR=yr(()=>{});function gn(e){const t=Qt(e.from?RR:dl);return Je({select:r=>{const s=r.matches.find(i=>e.from?e.from===i.routeId:i.id===t());if(mn(!((e.shouldThrow??!0)&&!s),`Could not find ${e.from?`an active match from "${e.from}"`:"a nearest match!"}`),s!==void 0)return e.select?e.select(s):s}})}function $R(e){const t=yn(),[n,r]=et(!1);let s=!1;const[i,o]=li(Ht({activeProps:()=>({class:"active"}),inactiveProps:()=>({})},e),["activeProps","inactiveProps","activeOptions","to","preload","preloadDelay","hashScrollIntoView","replace","startTransition","resetScroll","viewTransition","target","disabled","style","class","onClick","onFocus","onMouseEnter","onMouseLeave","onMouseOver","onMouseOut","onTouchStart","ignoreBlocker"]),[c,a]=li(o,["params","search","hash","state","mask","reloadDocument"]),u=()=>{try{return new URL(`${i.to}`),"external"}catch{}return"internal"},l=Je({select:j=>j.location.searchStr}),f=gn({strict:!1,select:j=>e.from??j.fullPath}),h=()=>({...e,from:f()}),d=he(()=>(l(),t.buildLocation(h()))),m=he(()=>h().reloadDocument?!1:i.preload??t.options.defaultPreload),y=()=>i.preloadDelay??t.options.defaultPreloadDelay??0,b=Je({select:j=>{if(i.activeOptions?.exact){if(!$P(j.location.pathname,d().pathname,t.basepath))return!1}else{const Q=fu(j.location.pathname,t.basepath).split("/");if(!fu(d()?.pathname,t.basepath)?.split("/")?.every((me,bn)=>me===Q[bn]))return!1}return(i.activeOptions?.includeSearch??!0)&&!di(j.location.search,d().search,{partial:!i.activeOptions?.exact,ignoreUndefined:!i.activeOptions?.explicitUndefined})?!1:i.activeOptions?.includeHash?j.location.hash===d().hash:!0}}),_=()=>t.preloadRoute(h()).catch(j=>{console.warn(j),console.warn(tR)}),S=j=>{j?.isIntersecting&&_()},[E,O]=et(null);if(PR(E,S,{rootMargin:"100px"},{disabled:!!i.disabled||m()!=="viewport"}),As(()=>{s||!i.disabled&&m()==="render"&&(_(),s=!0)}),u()==="external")return Ht(a,{ref:E,get type(){return u()},get href(){return i.to}},li(i,["target","disabled","style","class","onClick","onFocus","onMouseEnter","onMouseLeave","onMouseOut","onMouseOver","onTouchStart"])[0]);const C=j=>{if(!i.disabled&&!TR(j)&&!j.defaultPrevented&&(!i.target||i.target==="_self")&&j.button===0){j.preventDefault(),r(!0);const Q=t.subscribe("onResolved",()=>{Q(),r(!1)});return t.navigate({...h(),replace:i.replace,resetScroll:i.resetScroll,hashScrollIntoView:i.hashScrollIntoView,startTransition:i.startTransition,viewTransition:i.viewTransition,ignoreBlocker:i.ignoreBlocker})}},v=j=>{i.disabled||m()&&_()},$=v,w=j=>{if(i.disabled)return;const Q=j.target||{};if(m()){if(Q.preloadTimeout)return;Q.preloadTimeout=setTimeout(()=>{Q.preloadTimeout=null,_()},y())}},P=j=>{if(i.disabled)return;const Q=j.target||{};Q.preloadTimeout&&(clearTimeout(Q.preloadTimeout),Q.preloadTimeout=null)};function k(j,Q){return Q&&(typeof Q=="function"?Q(j):Q[0](Q[1],j)),j.defaultPrevented}function R(j){return Q=>{for(const Ye of j)k(Q,Ye)}}const F=()=>b()?rs(i.activeProps,{})??{}:{},L=()=>b()?{}:rs(i.inactiveProps,{}),U=()=>[i.class,F().class,L().class].filter(Boolean).join(" "),re=()=>({...i.style,...F().style,...L().style}),H=he(()=>{const j=d(),Q=j?.maskedLocation;return h().disabled?void 0:Q?t.history.createHref(Q.href):t.history.createHref(j?.href)});return Ht(a,F,L,()=>({href:H(),ref:wR(O,h().ref),onClick:R([i.onClick,C]),onFocus:R([i.onFocus,v]),onMouseEnter:R([i.onMouseEnter,w]),onMouseOver:R([i.onMouseOver,w]),onMouseLeave:R([i.onMouseLeave,P]),onMouseOut:R([i.onMouseOut,P]),onTouchStart:R([i.onTouchStart,$]),disabled:!!i.disabled,target:i.target,...Object.keys(re).length&&{style:re},...U()&&{class:U()},...i.disabled&&{role:"link","aria-disabled":!0},...b()&&{"data-status":"active","aria-current":"page"},...n()&&{"data-transitioning":"transitioning"}}))}const yu=e=>{const[t,n]=li(e,["_asChild","children"]),[r,s]=li($R(n),["type"]),i=he(()=>{const o=t.children;return typeof o=="function"?o({get isActive(){return s["data-status"]==="active"},isTransitioning:!1}):o});return M(kn,Ht({get component(){return t._asChild?t._asChild:"a"}},s,{get children(){return i()}}))};function TR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function hp(e){return gn({from:e.from,strict:e.strict,select:t=>e.select?e.select(t.loaderData):t.loaderData})}function dp(e){const{select:t,...n}=e;return gn({...n,select:r=>t?t(r.loaderDeps):r.loaderDeps})}function pp(e){return gn({from:e.from,strict:e.strict,shouldThrow:e.shouldThrow,select:t=>e.select?e.select(t.params):t.params})}function mp(e){return gn({from:e.from,strict:e.strict,shouldThrow:e.shouldThrow,select:t=>e.select?e.select(t.search):t.search})}function gp(e){const{navigate:t,state:n}=yn(),r=gn({strict:!1,select:s=>s.index});return s=>t({...s,from:s.from??e?.from??n.matches[r()].fullPath})}let IR=class extends Y_{constructor(t){super(t),this.useMatch=n=>gn({select:n?.select,from:this.id}),this.useRouteContext=n=>gn({...n,from:this.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>mp({select:n?.select,from:this.id}),this.useParams=n=>pp({select:n?.select,from:this.id}),this.useLoaderDeps=n=>dp({...n,from:this.id}),this.useLoaderData=n=>hp({...n,from:this.id}),this.useNavigate=()=>gp({from:this.fullPath}),this.Link=n=>{const r=this;return M(yu,Ht({get from(){return r.fullPath}},n))}}};function FR(e){return new IR(e)}function MR(){return e=>AR(e)}class xR extends nR{constructor(t){super(t),this.useMatch=n=>gn({select:n?.select,from:this.id}),this.useRouteContext=n=>gn({...n,from:this.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>mp({select:n?.select,from:this.id}),this.useParams=n=>pp({select:n?.select,from:this.id}),this.useLoaderDeps=n=>dp({...n,from:this.id}),this.useLoaderData=n=>hp({...n,from:this.id}),this.useNavigate=()=>gp({from:this.fullPath}),this.Link=n=>{const r=this;return M(yu,Ht({get from(){return r.fullPath}},n))}}}function AR(e){return new xR(e)}function bu(e){return typeof e=="object"?new ry(e,{silent:!0}).createRoute(e):new ry(e,{silent:!0}).createRoute}class ry{constructor(t,n){this.path=t,this.createRoute=r=>{this.silent;const s=FR(r);return s.isRoot=!1,s},this.silent=n?.silent}}class sy{constructor(t){this.useMatch=n=>gn({select:n?.select,from:this.options.id}),this.useRouteContext=n=>gn({from:this.options.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>mp({select:n?.select,from:this.options.id}),this.useParams=n=>pp({select:n?.select,from:this.options.id}),this.useLoaderDeps=n=>dp({...n,from:this.options.id}),this.useLoaderData=n=>hp({...n,from:this.options.id}),this.useNavigate=()=>{const n=yn();return gp({from:n.routesById[this.options.id].fullPath})},this.options=t}}function iy(e){return typeof e=="object"?new sy(e):t=>new sy({id:e,...t})}var NR=Kr("<p>Not Found");function LR(e){const t=Je({select:n=>`not-found-${n.location.pathname}-${n.status}`});return M(lp,{getResetKey:()=>t(),onCatch:n=>{if(Dt(n))e.onCatch?.(n);else throw n},errorComponent:({error:n})=>{if(Dt(n))return e.fallback?.(n);throw n},get children(){return e.children}})}function DR(){return qn(NR)}function Ba(e){return Gt(()=>e.children)}function sS(e,t,n){return t.options.notFoundComponent?M(t.options.notFoundComponent,{data:n}):e.options.defaultNotFoundComponent?M(e.options.defaultNotFoundComponent,{data:n}):M(DR,{})}var Kf,oy;function jR(){if(oy)return Kf;oy=1;const e={},t=e.hasOwnProperty,n=(w,P)=>{for(const k in w)t.call(w,k)&&P(k,w[k])},r=(w,P)=>(P&&n(P,(k,R)=>{w[k]=R}),w),s=(w,P)=>{const k=w.length;let R=-1;for(;++R<k;)P(w[R])},i=w=>"\\u"+("0000"+w).slice(-4),o=(w,P)=>{let k=w.toString(16);return P?k:k.toUpperCase()},c=e.toString,a=Array.isArray,u=w=>typeof Buffer=="function"&&Buffer.isBuffer(w),l=w=>c.call(w)=="[object Object]",f=w=>typeof w=="string"||c.call(w)=="[object String]",h=w=>typeof w=="number"||c.call(w)=="[object Number]",d=w=>typeof w=="bigint",m=w=>typeof w=="function",y=w=>c.call(w)=="[object Map]",b=w=>c.call(w)=="[object Set]",_={"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},S=/[\\\b\f\n\r\t]/,E=/[0-9]/,O=/[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,C=/([\uD800-\uDBFF][\uDC00-\uDFFF])|([\uD800-\uDFFF])|(['"`])|[^]/g,v=/([\uD800-\uDBFF][\uDC00-\uDFFF])|([\uD800-\uDFFF])|(['"`])|[^ !#-&\(-\[\]-_a-~]/g,$=(w,P)=>{const k=()=>{j=H,++P.indentLevel,H=P.indent.repeat(P.indentLevel)},R={escapeEverything:!1,minimal:!1,isScriptContext:!1,quotes:"single",wrap:!1,es6:!1,json:!1,compact:!0,lowercaseHex:!1,numbers:"decimal",indent:"	",indentLevel:0,__inline1__:!1,__inline2__:!1},F=P&&P.json;F&&(R.quotes="double",R.wrap=!0),P=r(R,P),P.quotes!="single"&&P.quotes!="double"&&P.quotes!="backtick"&&(P.quotes="single");const L=P.quotes=="double"?'"':P.quotes=="backtick"?"`":"'",U=P.compact,re=P.lowercaseHex;let H=P.indent.repeat(P.indentLevel),j="";const Q=P.__inline1__,Ye=P.__inline2__,yt=U?"":`
`;let me,bn=!0;const Oo=P.numbers=="binary",Te=P.numbers=="octal",rt=P.numbers=="decimal",lt=P.numbers=="hexadecimal";if(F&&w&&m(w.toJSON)&&(w=w.toJSON()),!f(w)){if(y(w))return w.size==0?"new Map()":(U||(P.__inline1__=!0,P.__inline2__=!1),"new Map("+$(Array.from(w),P)+")");if(b(w))return w.size==0?"new Set()":"new Set("+$(Array.from(w),P)+")";if(u(w))return w.length==0?"Buffer.from([])":"Buffer.from("+$(Array.from(w),P)+")";if(a(w))return me=[],P.wrap=!0,Q&&(P.__inline1__=!1,P.__inline2__=!0),Ye||k(),s(w,ge=>{bn=!1,Ye&&(P.__inline2__=!1),me.push((U||Ye?"":H)+$(ge,P))}),bn?"[]":Ye?"["+me.join(", ")+"]":"["+yt+me.join(","+yt)+yt+(U?"":j)+"]";if(h(w)||d(w)){if(F)return JSON.stringify(Number(w));let ge;if(rt)ge=String(w);else if(lt){let Ne=w.toString(16);re||(Ne=Ne.toUpperCase()),ge="0x"+Ne}else Oo?ge="0b"+w.toString(2):Te&&(ge="0o"+w.toString(8));return d(w)?ge+"n":ge}else return d(w)?F?JSON.stringify(Number(w)):w+"n":l(w)?(me=[],P.wrap=!0,k(),n(w,(ge,Ne)=>{bn=!1,me.push((U?"":H)+$(ge,P)+":"+(U?"":" ")+$(Ne,P))}),bn?"{}":"{"+yt+me.join(","+yt)+yt+(U?"":j)+"}"):F?JSON.stringify(w)||"null":String(w)}const Ae=P.escapeEverything?C:v;return me=w.replace(Ae,(ge,Ne,Le,kt,bt,wr)=>{if(Ne){if(P.minimal)return Ne;const Sa=Ne.charCodeAt(0),wa=Ne.charCodeAt(1);if(P.es6){const Ff=(Sa-55296)*1024+wa-56320+65536;return"\\u{"+o(Ff,re)+"}"}return i(o(Sa,re))+i(o(wa,re))}if(Le)return i(o(Le.charCodeAt(0),re));if(ge=="\0"&&!F&&!E.test(wr.charAt(bt+1)))return"\\0";if(kt)return kt==L||P.escapeEverything?"\\"+kt:kt;if(S.test(ge))return _[ge];if(P.minimal&&!O.test(ge))return ge;const ko=o(ge.charCodeAt(0),re);return F||ko.length>2?i(ko):"\\x"+("00"+ko).slice(-2)}),L=="`"&&(me=me.replace(/\$\{/g,"\\${")),P.isScriptContext&&(me=me.replace(/<\/(script|style)/gi,"<\\/$1").replace(/<!--/g,F?"\\u003C!--":"\\x3C!--")),P.wrap&&(me=L+me+L),me};return $.version="3.0.2",Kf=$,Kf}jR();var UR=Kr("<script class=tsr-once>");function BR({children:e,log:t}){return typeof document<"u"?null:(()=>{var n=qn(UR);return Ut(()=>rP(n,"innerHTML",[e,"",'if (typeof __TSR_SSR__ !== "undefined") __TSR_SSR__.cleanScripts()'].filter(Boolean).join(`
`))),n})()}function KR(){const e=yn(),n=(e.options.getScrollRestorationKey||Ih)(e.latestLocation),r=n!==Ih(e.latestLocation)?n:null;return!e.isScrollRestoring||!e.isServer?null:M(BR,{get children(){return`(${W_.toString()})(${JSON.stringify(du)},${JSON.stringify(r)}, undefined, true)`},log:!1})}const Nh=e=>{const t=yn(),n=Je({select:d=>d.matches.find(m=>m.id===e.matchId)?.routeId});mn(n,`Could not find routeId for matchId "${e.matchId}". Please file an issue!`);const r=()=>t.routesById[n()],s=()=>r().options.pendingComponent??t.options.defaultPendingComponent,i=()=>r().options.errorComponent??t.options.defaultErrorComponent,o=()=>r().options.onCatch??t.options.defaultOnCatch,c=()=>r().isRoot?r().options.notFoundComponent??t.options.notFoundRoute?.options.component:r().options.notFoundComponent,a=()=>(!r().isRoot||r().options.wrapInSuspense)&&(r().options.wrapInSuspense??s()??r().options.errorComponent?.preload)?au:Ba,u=()=>i()?lp:Ba,l=()=>c()?LR:Ba,f=Je({select:d=>d.loadedAt}),h=Je({select:d=>{const m=d.matches.findIndex(y=>y.id===e.matchId);return d.matches[m-1]?.routeId}});return[M(dl.Provider,{value:()=>e.matchId,get children(){return M(kn,{get component(){return a()},get fallback(){return M(kn,{get component(){return s()}})},get children(){return M(kn,{get component(){return u()},getResetKey:()=>f(),get errorComponent(){return i()||Mc},onCatch:d=>{if(Dt(d))throw d;`${e.matchId}`,o()?.(d)},get children(){return M(kn,{get component(){return l()},fallback:d=>{if(!c()||d.routeId&&d.routeId!==n||!d.routeId&&!r().isRoot)throw d;return M(kn,Ht({get component(){return c()}},d))},get children(){return M(zR,{get matchId(){return e.matchId}})}})}})}})}}),Gt(()=>Gt(()=>h()===wn)()?[M(qR,{}),M(KR,{})]:null)]};function qR(){const e=yn(),t=Je({select:n=>n.resolvedLocation?.state.__TSR_key});return As(cr([t],()=>{e.emit({type:"onRendered",...ss(e.state)})})),null}const zR=e=>{const t=yn(),n=Je({select:o=>{const c=o.matches.findIndex(d=>d.id===e.matchId),a=o.matches[c],u=a.routeId,f=(t.routesById[u].options.remountDeps??t.options.defaultRemountDeps)?.({routeId:u,loaderDeps:a.loaderDeps,params:a._strictParams,search:a._strictSearch});return{key:f?JSON.stringify(f):void 0,routeId:u,match:$h(a,["id","status","error"])}}}),r=()=>t.routesById[n().routeId],s=()=>n().match,i=()=>{const o=r().options.component??t.options.defaultComponent;return o?M(o,{}):M(yp,{})};return M(U_,{get children(){return[M(Er,{get when(){return s().status==="notFound"},children:o=>(mn(Dt(s().error)),sS(t,r(),s().error))}),M(Er,{get when(){return s().status==="redirected"},children:o=>{mn(sn(s().error));const[c]=ec(async()=>(await new Promise(a=>setTimeout(a,0)),t.getMatch(s().id)?.loadPromise));return Gt(c)}}),M(Er,{get when(){return s().status==="error"},children:o=>{if(t.isServer){const c=(r().options.errorComponent??t.options.defaultErrorComponent)||Mc;return M(c,{get error(){return s().error},info:{componentStack:""}})}throw s().error}}),M(Er,{get when(){return s().status==="pending"},children:o=>{const c=r().options.pendingMinMs??t.options.defaultPendingMinMs;if(c&&!t.getMatch(s().id)?.minPendingPromise&&!t.isServer){const u=ni();Promise.resolve().then(()=>{t.updateMatch(s().id,l=>({...l,minPendingPromise:u}))}),setTimeout(()=>{u.resolve(),t.updateMatch(s().id,l=>({...l,minPendingPromise:void 0}))},c)}const[a]=ec(async()=>(await new Promise(u=>setTimeout(u,0)),t.getMatch(s().id)?.loadPromise));return Gt(a)}}),M(Er,{get when(){return s().status==="success"},get children(){return i()}})]}})},yp=()=>{const e=yn(),t=Qt(dl),n=Je({select:o=>o.matches.find(c=>c.id===t())?.routeId}),r=()=>e.routesById[n()],s=Je({select:o=>{const a=o.matches.find(u=>u.id===t());return mn(a,`Could not find parent match for matchId "${t()}"`),a.globalNotFound}}),i=Je({select:o=>{const c=o.matches,a=c.findIndex(l=>l.id===t());return c[a+1]?.id}});return M(U_,{get children(){return[M(Er,{get when(){return e.isShell},get children(){return M(au,{get fallback(){return M(kn,{get component(){return e.options.defaultPendingComponent}})},get children(){return M(Mc,{error:new Error("ShellBoundaryError")})}})}}),M(Er,{get when(){return s()},get children(){return sS(e,r(),void 0)}}),M(Er,{get when(){return i()},children:o=>M(j_,{get when(){return o()===wn},get fallback(){return M(Nh,{get matchId(){return o()}})},get children(){return M(au,{get fallback(){return M(kn,{get component(){return e.options.defaultPendingComponent}})},get children(){return M(Nh,{get matchId(){return o()}})}})}})})]}})};function VR(e){return typeof e?.message=="string"&&/Failed to fetch dynamically imported module/.test(e.message)}function iS(e,t,n){let r,s,i;const o=()=>typeof document>"u"&&n?.()===!1?(s=()=>null,Promise.resolve(s)):(r||(r=e().then(a=>(r=void 0,s=a[t],s)).catch(a=>{i=a})),r),c=function(u){if(i){if(VR(i)&&i instanceof Error&&typeof window<"u"&&typeof sessionStorage<"u"){const l=`tanstack_router_reload:${i.message}`;if(!sessionStorage.getItem(l))return sessionStorage.setItem(l,"1"),window.location.reload(),{default:()=>null}}throw i}if(!s){const[l]=ec(o,{initialValue:s,ssrLoadFrom:"initial"});return Gt(l)}return n?.()===!1?M(bR,{get fallback(){return M(yp,{})},get children(){return M(kn,Ht({component:s},u))}}):M(kn,Ht({component:s},u))};return c.preload=o,c}function HR(){const e=yn();let t={router:e,mounted:!1};const n=Je({select:({isLoading:f})=>f}),[r,s]=et(!1),i=Je({select:f=>f.matches.some(h=>h.status==="pending")}),o=Bf(n),c=()=>n()||r()||i(),a=Bf(c),u=()=>n()||i(),l=Bf(u);return e.isServer||(e.startTransition=async f=>{s(!0),await f(),s(!1)}),I_(()=>{const f=e.history.subscribe(e.load),h=e.buildLocation({to:e.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});Ci(e.latestLocation.href)!==Ci(h.href)&&e.commitLocation({...h,replace:!0}),xt(()=>{f()})}),Ut(()=>{ut(()=>{if(typeof window<"u"&&e.clientSsr||t.router===e&&t.mounted)return;t={router:e,mounted:!0},(async()=>{try{await e.load()}catch(h){console.error(h)}})()})}),Ut(cr([o,n],([f,h])=>{f.previous&&!h&&e.emit({type:"onLoad",...ss(e.state)})})),Ut(cr([u,l],([f,h])=>{h.previous&&!f&&e.emit({type:"onBeforeRouteMount",...ss(e.state)})})),Ut(cr([c,a],([f,h])=>{h.previous&&!f&&(e.emit({type:"onResolved",...ss(e.state)}),e.__store.setState(d=>({...d,status:"idle",resolvedLocation:d.location})),KP(e))})),null}function WR(){const e=yn(),t=e.options.defaultPendingComponent?M(e.options.defaultPendingComponent,{}):null,n=e.isServer||typeof document<"u"&&e.clientSsr?Ba:au,r=M(n,{fallback:t,get children(){return[M(HR,{}),M(JR,{})]}});return e.options.InnerWrap?M(e.options.InnerWrap,{children:r}):r}function JR(){const e=Je({select:n=>n.matches[0]?.id}),t=Je({select:n=>n.loadedAt});return M(dl.Provider,{value:e,get children(){return M(lp,{getResetKey:()=>t(),errorComponent:Mc,onCatch:n=>{n.message||n.toString()},get children(){return Gt(()=>!!e())()?M(Nh,{get matchId(){return e()}}):null}})}})}const QR=e=>new GR(e);class GR extends QP{constructor(t){super(t)}}typeof globalThis<"u"?(globalThis.createFileRoute=bu,globalThis.createLazyFileRoute=iy):typeof window<"u"&&(window.createFileRoute=bu,window.createFileRoute=iy);function YR({router:e,children:t,...n}){e.update({...e.options,...n,context:{...e.options.context,...n.context}});const r=rS(),s=M(r.Provider,{value:e,get children(){return t()}});return e.options.Wrap?M(e.options.Wrap,{children:s}):s}function XR({router:e,...t}){return M(YR,Ht({router:e},t,{children:()=>M(WR,{})}))}const oS=yr(),ZR=["title","meta"],cy=[],ay=["name","http-equiv","content","charset","media"].concat(["property"]),uy=(e,t)=>{const n=Object.fromEntries(Object.entries(e.props).filter(([r])=>t.includes(r)).sort());return(Object.hasOwn(n,"name")||Object.hasOwn(n,"property"))&&(n.name=n.name||n.property,delete n.property),e.tag+JSON.stringify(n)};function e$(){if(!D.context){const n=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(n,r=>r.parentNode.removeChild(r))}const e=new Map;function t(n){if(n.ref)return n.ref;let r=document.querySelector(`[data-sm="${n.id}"]`);return r?(r.tagName.toLowerCase()!==n.tag&&(r.parentNode&&r.parentNode.removeChild(r),r=document.createElement(n.tag)),r.removeAttribute("data-sm")):r=document.createElement(n.tag),r}return{addTag(n){if(ZR.indexOf(n.tag)!==-1){const i=n.tag==="title"?cy:ay,o=uy(n,i);e.has(o)||e.set(o,[]);let c=e.get(o),a=c.length;c=[...c,n],e.set(o,c);let u=t(n);n.ref=u,ki(u,n.props);let l=null;for(var r=a-1;r>=0;r--)if(c[r]!=null){l=c[r];break}return u.parentNode!=document.head&&document.head.appendChild(u),l&&l.ref&&l.ref.parentNode&&document.head.removeChild(l.ref),a}let s=t(n);return n.ref=s,ki(s,n.props),s.parentNode!=document.head&&document.head.appendChild(s),-1},removeTag(n,r){const s=n.tag==="title"?cy:ay,i=uy(n,s);if(n.ref){const o=e.get(i);if(o){if(n.ref.parentNode){n.ref.parentNode.removeChild(n.ref);for(let c=r-1;c>=0;c--)o[c]!=null&&document.head.appendChild(o[c].ref)}o[r]=null,e.set(i,o)}else n.ref.parentNode&&n.ref.parentNode.removeChild(n.ref)}}}}const t$=e=>{const t=e$();return M(oS.Provider,{value:t,get children(){return e.children}})},bp=(e,t,n)=>(n$({tag:e,props:t,setting:n,id:zC(),get name(){return t.name||t.property}}),null);function n$(e){const t=Qt(oS);if(!t)throw new Error("<MetaProvider /> should be in the tree");Ut(()=>{const n=t.addTag(e);xt(()=>t.removeTag(e,n))})}const r$=e=>bp("title",e,{escape:!0,close:!0}),s$=e=>bp("style",e,{close:!0}),i$=e=>bp("meta",e);var o$=Kr("<link>"),ly=Kr("<script>");function c$({tag:e,attrs:t,children:n}){switch(e){case"title":return M(r$,Ht(t,{children:n}));case"meta":return M(i$,t);case"link":return(()=>{var r=qn(o$);return ki(r,t,!1,!1),uu(),r})();case"style":return M(s$,Ht(t,{innerHTML:n}));case"script":return M(a$,{attrs:t,children:n});default:return null}}function a$({attrs:e,children:t}){return I_(()=>{if(e?.src){const n=document.createElement("script");for(const[r,s]of Object.entries(e))s!==void 0&&s!==!1&&n.setAttribute(r,typeof s=="boolean"?"":String(s));document.head.appendChild(n),xt(()=>{n.parentNode&&n.parentNode.removeChild(n)})}else if(typeof t=="string"){const n=document.createElement("script");if(n.textContent=t,e)for(const[r,s]of Object.entries(e))s!==void 0&&s!==!1&&n.setAttribute(r,typeof s=="boolean"?"":String(s));document.head.appendChild(n),xt(()=>{n.parentNode&&n.parentNode.removeChild(n)})}}),e?.src&&typeof e.src=="string"?(()=>{var n=qn(ly);return ki(n,e,!1,!1),uu(),n})():typeof t=="string"?(()=>{var n=qn(ly);return ki(n,Ht(e,{innerHTML:t}),!1,!1),uu(),n})():null}const u$=()=>{const e=yn(),t=Je({select:o=>o.matches.map(c=>c.meta).filter(Boolean)}),n=he(()=>{const o=[],c={};let a;return[...t()].reverse().forEach(u=>{[...u].reverse().forEach(l=>{if(l)if(l.title)a||(a={tag:"title",children:l.title});else{const f=l.name??l.property;if(f){if(c[f])return;c[f]=!0}o.push({tag:"meta",attrs:{...l}})}})}),a&&o.push(a),o.reverse(),o}),r=Je({select:o=>{const c=o.matches.map(l=>l.links).filter(Boolean).flat(1).map(l=>({tag:"link",attrs:{...l}})),a=e.ssr?.manifest,u=o.matches.map(l=>a?.routes[l.routeId]?.assets??[]).filter(Boolean).flat(1).filter(l=>l.tag==="link").map(l=>({tag:"link",attrs:l.attrs}));return[...c,...u]}}),s=Je({select:o=>{const c=[];return o.matches.map(a=>e.looseRoutesById[a.routeId]).forEach(a=>e.ssr?.manifest?.routes[a.id]?.preloads?.filter(Boolean).forEach(u=>{c.push({tag:"link",attrs:{rel:"modulepreload",href:u}})})),c}}),i=Je({select:o=>o.matches.map(c=>c.headScripts).flat(1).filter(Boolean).map(({children:c,...a})=>({tag:"script",attrs:{...a},children:c}))});return()=>f$([...n(),...s(),...r(),...i()],o=>JSON.stringify(o))};function l$(){const e=u$();return M(t$,{get children(){return e().map(t=>M(c$,t))}})}function f$(e,t){const n=new Set;return e.filter(r=>{const s=t(r);return n.has(s)?!1:(n.add(s),!0)})}let Ca;const Po=e=>Gt(()=>e.children);function h$(e){return Ca||(e.router.state.matches.length?Ca=Promise.resolve():Ca=rR(e.router)),M(pR,{promise:Ca,children:()=>M(Po,{get children(){return M(Po,{get children(){return M(XR,{get router(){return e.router},InnerWrap:t=>M(Po,{get children(){return[M(Po,{get children(){return[M(l$,{}),Gt(()=>t.children)]}}),M(Po,{})]}})})}})}})})}var d$=Kr('<header class="p-2 flex gap-2 bg-white text-black justify-between"><nav class="flex flex-row"><div class="px-2 font-bold"></div><div class="px-2 font-bold"></div></nav><div>');function p$(){return(()=>{var e=qn(d$),t=e.firstChild,n=t.firstChild,r=n.nextSibling;return Xr(n,M(yu,{to:"/",children:"Home"})),Xr(r,M(yu,{to:"/demo/start/server-funcs",children:"Start - Server Functions"})),e})()}const m$=e=>typeof e=="function",g=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):n=>t(n,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(n,r){return arguments.length>=2?t(n,r):function(s){return t(s,n)}};case 3:return function(n,r,s){return arguments.length>=3?t(n,r,s):function(i){return t(i,n,r)}};case 4:return function(n,r,s,i){return arguments.length>=4?t(n,r,s,i):function(o){return t(o,n,r,s)}};case 5:return function(n,r,s,i,o){return arguments.length>=5?t(n,r,s,i,o):function(c){return t(c,n,r,s,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(r){return t(r,...n)}}}},Z=e=>e,pl=e=>()=>e,fy=pl(!0),_u=pl(!1),cS=pl(void 0),Su=cS;function p(e,t,n,r,s,i,o,c,a){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return s(r(n(t(e))));case 6:return i(s(r(n(t(e)))));case 7:return o(i(s(r(n(t(e))))));case 8:return c(o(i(s(r(n(t(e)))))));case 9:return a(c(o(i(s(r(n(t(e))))))));default:{let u=arguments[0];for(let l=1;l<arguments.length;l++)u=arguments[l](u);return u}}}const ml=e=>(t,n)=>t===n||e(t,n),g$=g(2,(e,t)=>ml((n,r)=>e(t(n),t(r)))),y$=e=>ml((t,n)=>{if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0});let b$="3.16.9";const gl=()=>b$,hy=`effect/GlobalValue/globalStoreId/${gl()}`;let Ro;const ne=(e,t)=>(Ro||(globalThis[hy]??=new Map,Ro=globalThis[hy]),Ro.has(e)||Ro.set(e,t()),Ro.get(e)),dr=e=>typeof e=="string",bs=e=>typeof e=="number",_p=e=>typeof e=="boolean",yl=e=>typeof e=="bigint",Lh=e=>typeof e=="symbol",eo=m$,_$=e=>e===void 0,S$=e=>!1,Sp=e=>typeof e=="object"&&e!==null,qr=e=>Sp(e)||eo(e),z=g(2,(e,t)=>qr(e)&&t in e),aS=g(2,(e,t)=>z(e,"_tag")&&e._tag===t),Js=e=>e==null,w$=e=>e!=null,v$=e=>e instanceof Date,wp=e=>z(e,Symbol.iterator),E$=e=>Sp(e)&&!Array.isArray(e),uS=e=>z(e,"then")&&eo(e.then),bl=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;let lS=class fS{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new fS(this.self)}};const O$=335903614,k$=4150755663,C$=1481765933,P$=1284865837,R$=9007199254740992,$$=134217728;class T${_state;constructor(t,n,r,s){return Js(n)&&Js(t)?(n=Math.random()*4294967295>>>0,t=0):Js(n)&&(n=t,t=0),Js(s)&&Js(r)?(s=this._state?this._state[3]:k$,r=this._state?this._state[2]:O$):Js(s)&&(s=r,r=0),this._state=new Int32Array([0,0,r>>>0,((s||0)|1)>>>0]),this._next(),dy(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*$$+n)/R$}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;I$(this._state,t,n,C$,P$),dy(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let r=t>>>18,s=(n>>>18|t<<14)>>>0;r=(r^t)>>>0,s=(s^n)>>>0;const i=(s>>>27|r<<5)>>>0,o=t>>>27,c=(-o>>>0&31)>>>0;return(i>>>o|i<<c)>>>0}}function I$(e,t,n,r,s){let i=(n>>>16)*(s&65535)>>>0,o=(n&65535)*(s>>>16)>>>0,c=(n&65535)*(s&65535)>>>0,a=(n>>>16)*(s>>>16)+((o>>>16)+(i>>>16))>>>0;o=o<<16>>>0,c=c+o>>>0,c>>>0<o>>>0&&(a=a+1>>>0),i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(a=a+1>>>0),a=a+Math.imul(n,r)>>>0,a=a+Math.imul(t,s)>>>0,e[0]=a,e[1]=c}function dy(e,t,n,r,s){let i=t+r>>>0;const o=n+s>>>0;o>>>0<n>>>0&&(i=i+1|0),e[0]=i,e[1]=o}const Dh=Symbol.for("effect/Utils/YieldWrap");class xc{#t;constructor(t){this.#t=t}[Dh](){return this.#t}}function F$(e){if(typeof e=="object"&&e!==null&&Dh in e)return e[Dh]();throw new Error(bl("yieldWrapGet"))}const en=ne("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),hS={effect_internal_function:e=>e()},M$={effect_internal_function:e=>{try{return e()}finally{}}},x$=hS.effect_internal_function(()=>new Error().stack)?.includes("effect_internal_function")===!0,Rt=x$?hS.effect_internal_function:M$.effect_internal_function,qf=ne(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),ee=Symbol.for("effect/Hash"),K=e=>{if(en.enabled===!0)return 0;switch(typeof e){case"number":return Ac(e);case"bigint":return je(e.toString(10));case"boolean":return je(String(e));case"symbol":return je(String(e));case"string":return je(e);case"undefined":return je("undefined");case"function":case"object":return e===null?je("null"):e instanceof Date?K(e.toISOString()):e instanceof URL?K(e.href):A$(e)?e[ee]():vp(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},vp=e=>(qf.has(e)||qf.set(e,Ac(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),qf.get(e)),ie=e=>t=>t*53^e,_l=e=>e&3221225471|e>>>1&1073741824,A$=e=>z(e,ee),Ac=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return _l(t)},je=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return _l(t)},N$=(e,t)=>{let n=12289;for(let r=0;r<t.length;r++)n^=p(je(t[r]),ie(K(e[t[r]])));return _l(n)},dS=e=>N$(e,Object.keys(e)),Nc=e=>{let t=6151;for(let n=0;n<e.length;n++)t=p(t,ie(K(e[n])));return _l(t)},ke=function(){if(arguments.length===1){const n=arguments[0];return function(r){return Object.defineProperty(n,ee,{value(){return r},enumerable:!1}),r}}const e=arguments[0],t=arguments[1];return Object.defineProperty(e,ee,{value(){return t},enumerable:!1}),t},X=Symbol.for("effect/Equal");function J(){return arguments.length===1?e=>wu(e,arguments[0]):wu(arguments[0],arguments[1])}function wu(e,t){if(e===t)return!0;const n=typeof e;if(n!==typeof t)return!1;if(n==="object"||n==="function"){if(e!==null&&t!==null){if(vu(e)&&vu(t))return K(e)===K(t)&&e[X](t)?!0:en.enabled&&en.tester?en.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(en.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((r,s)=>wu(r,t[s]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const r=Object.keys(e),s=Object.keys(t);if(r.length===s.length){for(const i of r)if(!(i in t&&wu(e[i],t[i])))return en.tester?en.tester(e,t):!1;return!0}}return en.tester?en.tester(e,t):!1}}return en.enabled&&en.tester?en.tester(e,t):!1}const vu=e=>z(e,X),Ep=()=>J,_e=Symbol.for("nodejs.util.inspect.custom"),Ce=e=>{try{if(z(e,"toJSON")&&eo(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(Ce)}catch{return{}}return ic(e)},Ke=e=>JSON.stringify(e,null,2),Ri=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?pS(e,t):String(e)}catch{return String(e)}},pS=(e,t)=>{let n=[];const r=JSON.stringify(e,(s,i)=>typeof i=="object"&&i!==null?n.includes(i)?void 0:n.push(i)&&(is.fiberRefs!==void 0&&mS(i)?i[Op](is.fiberRefs):i):i,t);return n=void 0,r},Op=Symbol.for("effect/Inspectable/Redactable"),mS=e=>typeof e=="object"&&e!==null&&Op in e,is=ne("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),L$=(e,t)=>{const n=is.fiberRefs;is.fiberRefs=e;try{return t()}finally{is.fiberRefs=n}},ic=e=>mS(e)&&is.fiberRefs!==void 0?e[Op](is.fiberRefs):e,B=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let n=e;for(let r=0,s=t.length;r<s;r++)n=t[r](n);return n}}},Qo="Async",Sl="Commit",tt="Failure",Ka="OnFailure",Eu="OnSuccess",Ou="OnSuccessAndFailure",nt="Success",gS="Sync",D$="Tag",to="UpdateRuntimeFlags",ku="While",Go="Iterator",yS="WithRuntime",qa="Yield",kp="RevertFlags",j$=Symbol.for("effect/Effect"),U$=Symbol.for("effect/Stream"),B$=Symbol.for("effect/Sink"),K$=Symbol.for("effect/Channel"),$i={_R:e=>e,_E:e=>e,_A:e=>e,_V:gl()},q$={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},z$={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},Lc={[j$]:$i,[U$]:$i,[B$]:q$,[K$]:z$,[X](e){return this===e},[ee](){return ke(this,vp(this))},[Symbol.iterator](){return new lS(new xc(this))},pipe(){return B(this,arguments)}},Cp={[ee](){return ke(this,dS(this))},[X](e){const t=Object.keys(this),n=Object.keys(e);if(t.length!==n.length)return!1;for(const r of t)if(!(r in e&&J(this[r],e[r])))return!1;return!0}},no={...Lc,_op:Sl},V$={...no,...Cp},H$=function(){function e(){}return e.prototype=no,e}(),bS=Symbol.for("effect/Option"),_S={...Lc,[bS]:{_A:e=>e},[_e](){return this.toJSON()},toString(){return Ke(this.toJSON())}},W$=Object.assign(Object.create(_S),{_tag:"Some",_op:"Some",[X](e){return SS(e)&&vS(e)&&J(this.value,e.value)},[ee](){return ke(this,ie(K(this._tag))(K(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:Ce(this.value)}}}),J$=K("None"),Q$=Object.assign(Object.create(_S),{_tag:"None",_op:"None",[X](e){return SS(e)&&wS(e)},[ee](){return J$},toJSON(){return{_id:"Option",_tag:this._tag}}}),SS=e=>z(e,bS),wS=e=>e._tag==="None",vS=e=>e._tag==="Some",ES=Object.create(Q$),jh=e=>{const t=Object.create(W$);return t.value=e,t},OS=Symbol.for("effect/Either"),kS={...Lc,[OS]:{_R:e=>e},[_e](){return this.toJSON()},toString(){return Ke(this.toJSON())}},G$=Object.assign(Object.create(kS),{_tag:"Right",_op:"Right",[X](e){return Pp(e)&&PS(e)&&J(this.right,e.right)},[ee](){return ie(K(this._tag))(K(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:Ce(this.right)}}}),Y$=Object.assign(Object.create(kS),{_tag:"Left",_op:"Left",[X](e){return Pp(e)&&CS(e)&&J(this.left,e.left)},[ee](){return ie(K(this._tag))(K(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:Ce(this.left)}}}),Pp=e=>z(e,OS),CS=e=>e._tag==="Left",PS=e=>e._tag==="Right",X$=e=>{const t=Object.create(Y$);return t.left=e,t},Z$=e=>{const t=Object.create(G$);return t.right=e,t},Y=Z$,V=X$,eT=e=>{if(eo(e))try{return Y(e())}catch(t){return V(t)}else try{return Y(e.try())}catch(t){return V(e.catch(t))}},tT=Pp,ft=CS,sr=PS,nT=g(2,(e,t)=>ft(e)?V(t(e.left)):Y(e.right)),rT=g(2,(e,t)=>sr(e)?Y(t(e.right)):V(e.left)),ot=g(2,(e,{onLeft:t,onRight:n})=>ft(e)?t(e.left):n(e.right)),sT=ot({onLeft:Z,onRight:Z}),RS=g(2,(e,t)=>{if(sr(e))return e.right;throw t(e.left)}),iT=RS(()=>new Error("getOrThrow called on a Left")),$S=e=>e.length>0,TS=e=>(t,n)=>t===n?0:e(t,n),oT=TS((e,t)=>e<t?-1:1),IS=g(2,(e,t)=>TS((n,r)=>e(t(n),t(r)))),cT=e=>g(2,(t,n)=>e(t,n)===1),A=()=>ES,N=jh,Qe=wS,Be=vS,we=g(2,(e,{onNone:t,onSome:n})=>Qe(e)?t():n(e.value)),Pe=g(2,(e,t)=>Qe(e)?t():e.value),Rr=g(2,(e,t)=>Qe(e)?t():e),aT=g(2,(e,t)=>Qe(e)?N(t()):e),Dc=e=>e==null?A():N(e),Dn=Pe(cS),uT=e=>(...t)=>{try{return N(e(...t))}catch{return A()}},os=g(2,(e,t)=>Qe(e)?A():N(t(e.value))),jc=g(2,(e,t)=>Qe(e)?A():t(e.value)),lT=g(2,(e,t)=>Qe(e)?A():Dc(t(e.value))),l3=g(2,(e,t)=>t(e)?N(e):A()),fT=e=>g(2,(t,n)=>Qe(t)?!1:e(t.value,n)),hT=Ep(),dT=fT(hT),pT=g(2,(e,t)=>Qe(e)?!1:t(e.value)),py=e=>(t,n)=>Qe(t)?n:Qe(n)?t:N(e(t.value,n.value)),mT=(...e)=>e,wl=e=>new Array(e),FS=g(2,(e,t)=>{const n=Math.max(1,Math.floor(e)),r=new Array(n);for(let s=0;s<n;s++)r[s]=t(s);return r}),ye=e=>Array.isArray(e)?e:Array.from(e),Rp=e=>Array.isArray(e)?e:[e],gT=g(2,(e,{onEmpty:t,onNonEmpty:n})=>pt(e)?n(Ft(e),_s(e)):t()),Cu=g(2,(e,t)=>[t,...e]),yT=g(2,(e,t)=>[...e,t]),MS=g(2,(e,t)=>ye(e).concat(ye(t))),bT=Array.isArray,_T=e=>e.length===0,ST=_T,za=$S,pt=$S,xS=(e,t)=>e<0||e>=t.length,wT=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),vT=g(2,(e,t)=>{const n=Math.floor(t);return xS(n,e)?A():N(e[n])}),AS=g(2,(e,t)=>{const n=Math.floor(t);if(xS(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),Yo=vT(0),Ft=AS(0),ET=e=>pt(e)?N(NS(e)):A(),NS=e=>e[e.length-1],_s=e=>e.slice(1),OT=(e,t)=>{let n=0;for(const r of e){if(!t(r,n))break;n++}return n},kT=g(2,(e,t)=>LS(e,OT(e,t))),CT=g(2,(e,t)=>{const n=ye(e);return n.slice(wT(t,n),n.length)}),my=e=>Array.from(e).reverse(),oc=g(2,(e,t)=>{const n=Array.from(e);return n.sort(t),n}),gy=g(2,(e,t)=>PT(e,t,mT)),PT=g(3,(e,t,n)=>{const r=ye(e),s=ye(t);if(pt(r)&&pt(s)){const i=[n(Ft(r),Ft(s))],o=Math.min(r.length,s.length);for(let c=1;c<o;c++)i[c]=n(r[c],s[c]);return i}return[]}),RT=Ep(),LS=g(2,(e,t)=>{const n=Array.from(e),r=Math.floor(t);return pt(n)?r>=1?$T(n,r):[[],n]:[n,[]]}),$T=g(2,(e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[Do(e),[]]:[Cu(e.slice(1,n),Ft(e)),e.slice(n)]}),Do=e=>e.slice(),TT=g(3,(e,t,n)=>{const r=ye(e),s=ye(t);return pt(r)?pt(s)?jS(n)(MS(r,s)):r:s}),Va=g(2,(e,t)=>TT(e,t,RT)),Fr=()=>[],vn=e=>[e],cs=g(2,(e,t)=>e.map(t)),DS=g(2,(e,t)=>{if(ST(e))return[];const n=[];for(let r=0;r<e.length;r++){const s=t(e[r],r);for(let i=0;i<s.length;i++)n.push(s[i])}return n}),IT=DS(Z),FT=g(2,(e,t)=>{const n=ye(e),r=[];for(let s=0;s<n.length;s++){const i=t(n[s],s);Be(i)&&r.push(i.value)}return r}),MT=g(2,(e,t)=>{const n=ye(e),r=[];for(let s=0;s<n.length;s++)t(n[s],s)&&r.push(n[s]);return r}),$p=g(3,(e,t,n)=>ye(e).reduce((r,s,i)=>n(r,s,i),t)),yy=(e,t)=>{const n=[];let r=e,s;for(;Be(s=t(r));){const[i,o]=s.value;n.push(i),r=o}return n},Tp=y$,f3=g(2,(e,t)=>ye(e).forEach((n,r)=>t(n,r))),jS=g(2,(e,t)=>{const n=ye(e);if(pt(n)){const r=[Ft(n)],s=_s(n);for(const i of s)r.every(o=>!t(i,o))&&r.push(i);return r}return[]}),xT=e=>jS(e,Ep()),Ns=g(2,(e,t)=>ye(e).join(t)),US=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return US(e,t.from)}},mi=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),BS=e=>{let t=!1,n;return()=>(t||(n=e(),t=!0),n)},AT=e=>{try{return e.toISOString()}catch{return String(e)}},Rn=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(n=>Rn(n,t)).join(",")}]`;if(v$(e))return AT(e);if(z(e,"toString")&&eo(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();if(dr(e))return JSON.stringify(e);if(bs(e)||e==null||_p(e)||Lh(e))return String(e);if(yl(e))return String(e)+"n";if(wp(e))return`${e.constructor.name}(${Rn(Array.from(e),t)})`;try{t&&JSON.stringify(e);const n=`{${mi(e).map(s=>`${dr(s)?JSON.stringify(s):String(s)}:${Rn(e[s],!1)}`).join(",")}}`,r=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${r}(${n})`:n}catch{return"<circular structure>"}},NT=e=>typeof e=="string"?JSON.stringify(e):String(e),KS=e=>Array.isArray(e),by=e=>`[${NT(e)}]`,LT=e=>KS(e)?e.map(by).join(""):by(e),Ls=(e,t,n,r)=>{let s=e;return t!==void 0&&(s+=`
details: ${t}`),r&&(s+=`
schema (${r._tag}): ${r}`),s},DT=e=>Ls("Unsupported key schema",void 0,void 0,e),jT=e=>Ls("Unsupported literal",`literal value: ${Rn(e)}`),_y=e=>Ls("Duplicate index signature",`${e} index signature`),UT=Ls("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),BT=Ls("Invalid element","A required element cannot follow an optional element. ts(1257)"),Sy=e=>Ls("Duplicate property signature transformation",`Duplicate key ${Rn(e)}`),KT=e=>Ls("Duplicate property signature",`Duplicate key ${Rn(e)}`),Ti=oT,Pu=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),qS=Symbol.for("effect/annotation/Brand"),qT=Symbol.for("effect/annotation/SchemaId"),zS=Symbol.for("effect/annotation/Message"),Ip=Symbol.for("effect/annotation/MissingMessage"),VS=Symbol.for("effect/annotation/Identifier"),ro=Symbol.for("effect/annotation/Title"),Uh=Symbol.for("effect/annotation/AutoTitle"),Fp=Symbol.for("effect/annotation/Description"),HS=Symbol.for("effect/annotation/Examples"),WS=Symbol.for("effect/annotation/Default"),JS=Symbol.for("effect/annotation/JSONSchema"),QS=Symbol.for("effect/annotation/Arbitrary"),GS=Symbol.for("effect/annotation/Pretty"),YS=Symbol.for("effect/annotation/Equivalence"),zT=Symbol.for("effect/annotation/Documentation"),XS=Symbol.for("effect/annotation/Concurrency"),ZS=Symbol.for("effect/annotation/Batching"),ew=Symbol.for("effect/annotation/ParseIssueTitle"),tw=Symbol.for("effect/annotation/ParseOptions"),nw=Symbol.for("effect/annotation/DecodingFallback"),rw=Symbol.for("effect/annotation/Surrogate"),VT=Symbol.for("effect/annotation/StableFilter"),At=g(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?N(e.annotations[t]):A()),sw=At(qS),HT=At(zS),WT=At(Ip),iw=At(ro),ow=At(Uh),vl=At(VS),cw=At(Fp),JT=At(XS),QT=At(ZS),GT=At(ew),YT=At(tw),XT=At(nw),aw=At(rw),ZT=At(VT),eI=e=>pT(ZT(e),t=>t===!0),uw=Symbol.for("effect/annotation/JSONIdentifier"),tI=At(uw),nI=e=>Rr(tI(e),()=>vl(e));class El{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(t,n,r,s={}){this.typeParameters=t,this.decodeUnknown=n,this.encodeUnknown=r,this.annotations=s}toString(){return Pe(Jn(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:Ot(this.annotations)}}}const Uc=e=>t=>t._tag===e;class lw{literal;annotations;_tag="Literal";constructor(t,n={}){this.literal=t,this.annotations=n}toString(){return Pe(Jn(this),()=>Rn(this.literal))}toJSON(){return{_tag:this._tag,literal:yl(this.literal)?String(this.literal):this.literal,annotations:Ot(this.annotations)}}}const wy=Uc("Literal"),rI=new lw(null);class sI{symbol;annotations;_tag="UniqueSymbol";constructor(t,n={}){this.symbol=t,this.annotations=n}toString(){return Pe(Jn(this),()=>Rn(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:Ot(this.annotations)}}}class iI{annotations;_tag="NeverKeyword";constructor(t={}){this.annotations=t}toString(){return kl(this)}toJSON(){return{_tag:this._tag,annotations:Ot(this.annotations)}}}const fw=new iI({[ro]:"never"});class oI{annotations;_tag="UnknownKeyword";constructor(t={}){this.annotations=t}toString(){return kl(this)}toJSON(){return{_tag:this._tag,annotations:Ot(this.annotations)}}}const cI=new oI({[ro]:"unknown"});class aI{annotations;_tag="AnyKeyword";constructor(t={}){this.annotations=t}toString(){return kl(this)}toJSON(){return{_tag:this._tag,annotations:Ot(this.annotations)}}}const uI=new aI({[ro]:"any"});class lI{annotations;_tag="StringKeyword";constructor(t={}){this.annotations=t}toString(){return kl(this)}toJSON(){return{_tag:this._tag,annotations:Ot(this.annotations)}}}const fI=new lI({[ro]:"string",[Fp]:"a string"}),hI=Uc("StringKeyword"),dI=Uc("SymbolKeyword");let Mp=class{type;annotations;constructor(t,n={}){this.type=t,this.annotations=n}toJSON(){return{type:this.type.toJSON(),annotations:Ot(this.annotations)}}toString(){return String(this.type)}};class xp extends Mp{isOptional;constructor(t,n,r={}){super(t,r),this.isOptional=n}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:Ot(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const hw=e=>e.map(t=>t.type);class dw{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(t,n,r,s={}){this.elements=t,this.rest=n,this.isReadonly=r,this.annotations=s;let i=!1,o=!1;for(const c of t)if(c.isOptional)i=!0;else if(i){o=!0;break}if(o||i&&n.length>1)throw new Error(BT)}toString(){return Pe(Jn(this),()=>pI(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:Ot(this.annotations)}}}const pI=e=>{const t=e.elements.map(String).join(", ");return gT(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const s=String(n),i=s.includes(" | ")?`(${s})`:s;if(r.length>0){const o=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${i}[], ${o}]`:`readonly [...${i}[], ${o}]`}else return e.elements.length>0?`readonly [${t}, ...${i}[]]`:`ReadonlyArray<${s}>`}})};class St extends xp{name;isReadonly;constructor(t,n,r,s,i){super(n,r,i),this.name=t,this.isReadonly=s}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:Ot(this.annotations)}}}const pw=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return pw(e.from)}return!1};class Ol{type;isReadonly;parameter;constructor(t,n,r){if(this.type=n,this.isReadonly=r,pw(t))this.parameter=t;else throw new Error(UT)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class as{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(t,n,r={}){this.annotations=r;const s={};for(let o=0;o<t.length;o++){const c=t[o].name;if(Object.prototype.hasOwnProperty.call(s,c))throw new Error(KT(c));s[c]=null}const i={string:!1,symbol:!1};for(let o=0;o<n.length;o++){const c=Ow(n[o].parameter);if(hI(c)){if(i.string)throw new Error(_y("string"));i.string=!0}else if(dI(c)){if(i.symbol)throw new Error(_y("symbol"));i.symbol=!0}}this.propertySignatures=t,this.indexSignatures=n}toString(){return Pe(Jn(this),()=>mI(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:Ot(this.annotations)}}}const vy=e=>e.map(String).join("; "),mI=e=>{if(e.propertySignatures.length>0){const t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${vy(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${vy(e.indexSignatures)} }`:"{}"},gI=oc(IS(Ti,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),yI={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},mw=e=>DS(e,t=>yw(t)?mw(t.types):[t]),bI=e=>{const t=gI(e),n=[],r={},s=[];for(const i of t)switch(i._tag){case"NeverKeyword":break;case"AnyKeyword":return[uI];case"UnknownKeyword":return[cI];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{r[i._tag]||(r[i._tag]=i,n.push(i));break}case"Literal":{const o=typeof i.literal;switch(o){case"string":case"number":case"bigint":case"boolean":{const c=yI[o];!r[c]&&!s.includes(i.literal)&&(s.push(i.literal),n.push(i));break}case"object":{s.includes(i.literal)||(s.push(i.literal),n.push(i));break}}break}case"UniqueSymbol":{!r.SymbolKeyword&&!s.includes(i.symbol)&&(s.push(i.symbol),n.push(i));break}case"TupleType":{r.ObjectKeyword||n.push(i);break}case"TypeLiteral":{i.propertySignatures.length===0&&i.indexSignatures.length===0?r["{}"]||(r["{}"]=i,n.push(i)):r.ObjectKeyword||n.push(i);break}default:n.push(i)}return n};let tr=class Bh{types;annotations;static make=(t,n)=>gw(t)?new Bh(t,n):t.length===1?t[0]:fw;static unify=(t,n)=>Bh.make(bI(mw(t)),n);_tag="Union";constructor(t,n={}){this.types=t,this.annotations=n}toString(){return Pe(Jn(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:Ot(this.annotations)}}};const gw=e=>e.length>1,yw=Uc("Union"),zf=ne(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class bw{f;annotations;_tag="Suspend";constructor(t,n={}){this.f=t,this.annotations=n,this.f=BS(t)}toString(){return Jn(this).pipe(Rr(()=>jc(uT(this.f)(),t=>Jn(t))),Pe(()=>"<suspended schema>"))}toJSON(){const t=this.f();let n=zf.get(t);return n||(zf.set(t,{_tag:this._tag}),n={_tag:this._tag,ast:t.toJSON(),annotations:Ot(this.annotations)},zf.set(t,n),n)}}let _I=class{from;filter;annotations;_tag="Refinement";constructor(t,n,r={}){this.from=t,this.filter=n,this.annotations=r}toString(){return vl(this).pipe(Pe(()=>we(kw(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>_w(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:Ot(this.annotations)}}};const _w=Uc("Refinement"),Vf={};let Sw=class{from;to;transformation;annotations;_tag="Transformation";constructor(t,n,r,s={}){this.from=t,this.to=n,this.transformation=r,this.annotations=s}toString(){return Pe(Jn(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:Ot(this.annotations)}}};class SI{decode;encode;_tag="FinalTransformation";constructor(t,n){this.decode=t,this.encode=n}}class wI{from;to;decode;encode;constructor(t,n,r,s){this.from=t,this.to=n,this.decode=r,this.encode=s}}class vI{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(t){this.propertySignatureTransformations=t;const n={},r={};for(const s of t){const i=s.from;if(n[i])throw new Error(Sy(i));n[i]=!0;const o=s.to;if(r[o])throw new Error(Sy(o));r[o]=!0}}}const Ss=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={...e.annotations,...t},s=aw(e);return Be(s)&&(r[rw]=Ss(s.value,t)),n.annotations.value=r,Object.create(Object.getPrototypeOf(e),n)},EI="[\\s\\S]*",OI="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",ww=(e,t)=>{switch(e._tag){case"Literal":return Pu(String(e.literal));case"StringKeyword":return EI;case"NumberKeyword":return OI;case"TemplateLiteral":return vw(e);case"Union":return e.types.map(n=>ww(n)).join("|")}},kI=(e,t,n,r)=>yw(e)?`(${t})`:t,vw=(e,t,n)=>{let r="";if(e.head!==""){const s=Pu(e.head);r+=s}for(const s of e.spans){const i=ww(s.type);if(r+=kI(s.type,i),s.literal!==""){const o=Pu(s.literal);r+=o}}return r},CI=e=>new RegExp(`^${vw(e)}$`),Ey=(e,t)=>{const n=[],r=[],s=i=>{switch(i._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new Ol(i,t,!0));break;case"Literal":if(dr(i.literal)||bs(i.literal))n.push(new St(i.literal,t,!1,!0));else throw new Error(jT(i.literal));break;case"Enums":{for(const[o,c]of i.enums)n.push(new St(c,t,!1,!0));break}case"UniqueSymbol":n.push(new St(i.symbol,t,!1,!0));break;case"Union":i.types.forEach(s);break;default:throw new Error(DT(i))}};return s(e),{propertySignatures:n,indexSignatures:r}},Ew=e=>t=>{let n;for(const r of e)Object.prototype.hasOwnProperty.call(t.annotations,r)&&(n===void 0&&(n={}),n[r]=t.annotations[r]);return n},PI=Ew([HS,WS,JS,QS,GS,YS]),Lt=e=>{switch(e._tag){case"Declaration":{const t=an(e.typeParameters,Lt);return t===e.typeParameters?e:new El(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=an(e.elements,s=>{const i=Lt(s.type);return i===s.type?s:new xp(i,s.isOptional)}),n=hw(e.rest),r=an(n,Lt);return t===e.elements&&r===n?e:new dw(t,r.map(s=>new Mp(s)),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=an(e.propertySignatures,r=>{const s=Lt(r.type);return s===r.type?r:new St(r.name,s,r.isOptional,r.isReadonly)}),n=an(e.indexSignatures,r=>{const s=Lt(r.type);return s===r.type?r:new Ol(r.parameter,s,r.isReadonly)});return t===e.propertySignatures&&n===e.indexSignatures?e:new as(t,n,e.annotations)}case"Union":{const t=an(e.types,Lt);return t===e.types?e:tr.make(t,e.annotations)}case"Suspend":return new bw(()=>Lt(e.f()),e.annotations);case"Refinement":{const t=Lt(e.from);return t===e.from?e:new _I(t,e.filter,e.annotations)}case"Transformation":{const t=PI(e);return Lt(t!==void 0?Ss(e.to,t):e.to)}}return e},Qs=e=>we(nI(e),{onNone:()=>{},onSome:t=>({[uw]:t})});function an(e,t){let n=!1;const r=wl(e.length);for(let s=0;s<e.length;s++){const i=e[s],o=t(i);o!==i&&(n=!0),r[s]=o}return n?r:e}const Nn=(e,t)=>{switch(e._tag){case"Declaration":{const n=an(e.typeParameters,r=>Nn(r));return n===e.typeParameters?e:new El(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=an(e.elements,i=>{const o=Nn(i.type);return o===i.type?i:new xp(o,i.isOptional)}),r=hw(e.rest),s=an(r,i=>Nn(i));return n===e.elements&&s===r?e:new dw(n,s.map(i=>new Mp(i)),e.isReadonly,Qs(e))}case"TypeLiteral":{const n=an(e.propertySignatures,s=>{const i=Nn(s.type);return i===s.type?s:new St(s.name,i,s.isOptional,s.isReadonly)}),r=an(e.indexSignatures,s=>{const i=Nn(s.type);return i===s.type?s:new Ol(s.parameter,i,s.isReadonly)});return n===e.propertySignatures&&r===e.indexSignatures?e:new as(n,r,Qs(e))}case"Union":{const n=an(e.types,r=>Nn(r));return n===e.types?e:tr.make(n,Qs(e))}case"Suspend":return new bw(()=>Nn(e.f()),Qs(e));case"Refinement":{const n=Nn(e.from),r=Qs(e);return r?Ss(n,r):n}case"Transformation":{const n=Qs(e);return Nn(n?Ss(e.from,n):e.from)}}return e},Oy=e=>Nn(e),Ot=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},Ow=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Ow(e.from)}},kl=e=>Pe(Jn(e),()=>e._tag);function RI(e){return we(sw(e),{onNone:()=>"",onSome:t=>t.map(n=>` & Brand<${Rn(n)}>`).join("")})}const kw=e=>iw(e).pipe(Rr(()=>cw(e)),Rr(()=>ow(e)),os(t=>t+RI(e))),Jn=e=>Rr(vl(e),()=>kw(e)),Cw=Symbol.for("effect/Context/Tag"),Ru=Symbol.for("effect/Context/Reference"),$I="effect/STM",TI=Symbol.for($I),Ap={...Lc,_op:"Tag",[TI]:$i,[Cw]:{_Service:e=>e,_Identifier:e=>e},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[_e](){return this.toJSON()},of(e){return e},context(e){return $w(this,e)}},II={...Ap,[Ru]:Ru},FI=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const r=Object.create(Ap);return Object.defineProperty(r,"stack",{get(){return n.stack}}),r.key=e,r},MI=()=>(e,t)=>{const n=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=new Error;Error.stackTraceLimit=n;function s(){}return Object.setPrototypeOf(s,II),s.key=e,s.defaultValue=t.defaultValue,Object.defineProperty(s,"stack",{get(){return r.stack}}),s},Pw=Symbol.for("effect/Context"),xI={[Pw]:{_Services:e=>e},[X](e){if(Rw(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!J(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[ee](){return ke(this,Ac(this.unsafeMap.size))},pipe(){return B(this,arguments)},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(Ce)}},[_e](){return this.toJSON()}},Ii=e=>{const t=Object.create(xI);return t.unsafeMap=e,t},AI=e=>{const t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){const n=e.stack.split(`
`);if(n.length>2){const r=n[2].match(/at (.*)/);r&&(t.message=t.message+` (defined at ${r[1]})`)}}if(t.stack){const n=t.stack.split(`
`);n.splice(1,3),t.stack=n.join(`
`)}return t},Rw=e=>z(e,Pw),NI=e=>z(e,Cw),LI=e=>z(e,Ru),DI=Ii(new Map),jI=()=>DI,$w=(e,t)=>Ii(new Map([[e.key,t]])),UI=g(3,(e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t.key,n),Ii(r)}),Hf=ne("effect/Context/defaultValueCache",()=>new Map),Np=e=>{if(Hf.has(e.key))return Hf.get(e.key);const t=e.defaultValue();return Hf.set(e.key,t),t},BI=(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):Np(t),Tw=g(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(Ru in t)return Np(t);throw AI(t)}return e.unsafeMap.get(t.key)}),KI=Tw,qI=g(2,(e,t)=>e.unsafeMap.has(t.key)?jh(e.unsafeMap.get(t.key)):LI(t)?jh(Np(t)):ES),zI=g(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[r,s]of t.unsafeMap)n.set(r,s);return Ii(n)}),Ds=FI,VI=Rw,Cl=NI,Fi=jI,Bc=$w,Or=UI,ar=KI,Iw=Tw,so=qI,io=zI,Kc=MI,Fw=Symbol.for("effect/Chunk");function HI(e,t,n,r,s){for(let i=t;i<Math.min(e.length,t+s);i++)n[r+i-t]=e[i];return n}const Mw=[],WI=e=>ml((t,n)=>t.length===n.length&&$n(t).every((r,s)=>e(r,$r(n,s)))),JI=WI(J),QI={[Fw]:{_A:e=>e},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"Chunk",values:$n(this).map(Ce)}},[_e](){return this.toJSON()},[X](e){return Lp(e)&&JI(this,e)},[ee](){return ke(this,Nc($n(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Mw[Symbol.iterator]();default:return $n(this)[Symbol.iterator]()}},pipe(){return B(this,arguments)}},Ie=e=>{const t=Object.create(QI);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=un,t.right=un;break}case"ISingleton":{t.length=1,t.depth=0,t.left=un,t.right=un;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=un,t.right=un;break}}return t},Lp=e=>z(e,Fw),un=Ie({_tag:"IEmpty"}),Oe=()=>un,Ha=(...e)=>ZI(e),de=e=>Ie({_tag:"ISingleton",a:e}),Mi=e=>Lp(e)?e:Fn(ye(e)),Kh=(e,t,n)=>{switch(e.backing._tag){case"IArray":{HI(e.backing.array,0,t,n,e.length);break}case"IConcat":{Kh(e.left,t,n),Kh(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}case"ISlice":{let r=0,s=n;for(;r<e.length;)t[s]=$r(e,r),r+=1,s+=1;break}}},GI=e=>{switch(e.backing._tag){case"IEmpty":return Mw;case"IArray":return e.backing.array;default:{const t=new Array(e.length);return Kh(e,t,0),e.backing={_tag:"IArray",array:t},e.left=un,e.right=un,e.depth=0,t}}},$n=GI,YI=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return Ie({_tag:"IArray",array:my(e.backing.array)});case"IConcat":return Ie({_tag:"IConcat",left:pr(e.backing.right),right:pr(e.backing.left)});case"ISlice":return Fn(my($n(e)))}},pr=YI,XI=g(2,(e,t)=>t<0||t>=e.length?A():N($r(e,t))),Fn=e=>e.length===0?Oe():e.length===1?de(e[0]):Ie({_tag:"IArray",array:e}),ZI=e=>Fn(e),$r=g(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?$r(e.left,t):$r(e.right,t-e.left.length);case"ISlice":return $r(e.backing.chunk,t+e.backing.offset)}}),cc=g(2,(e,t)=>$e(e,de(t))),mt=g(2,(e,t)=>$e(de(t),e)),qh=g(2,(e,t)=>{if(t<=0)return un;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return Ie({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?Ie({_tag:"IConcat",left:e.left,right:qh(e.right,t-e.left.length)}):qh(e.left,t);default:return Ie({_tag:"ISlice",chunk:e,offset:0,length:t})}}),$u=g(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return un;switch(e.backing._tag){case"ISlice":return Ie({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?$u(e.right,t-e.left.length):Ie({_tag:"IConcat",left:$u(e.left,t),right:e.right});default:return Ie({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),$e=g(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;const n=t.depth-e.depth;if(Math.abs(n)<=1)return Ie({_tag:"IConcat",left:e,right:t});if(n<-1)if(e.left.depth>=e.right.depth){const r=$e(e.right,t);return Ie({_tag:"IConcat",left:e.left,right:r})}else{const r=$e(e.right.right,t);if(r.depth===e.depth-3){const s=Ie({_tag:"IConcat",left:e.right.left,right:r});return Ie({_tag:"IConcat",left:e.left,right:s})}else{const s=Ie({_tag:"IConcat",left:e.left,right:e.right.left});return Ie({_tag:"IConcat",left:s,right:r})}}else if(t.right.depth>=t.left.depth){const r=$e(e,t.left);return Ie({_tag:"IConcat",left:r,right:t.right})}else{const r=$e(e,t.left.left);if(r.depth===t.depth-3){const s=Ie({_tag:"IConcat",left:r,right:t.left.right});return Ie({_tag:"IConcat",left:s,right:t.right})}else{const s=Ie({_tag:"IConcat",left:t.left.right,right:t.right});return Ie({_tag:"IConcat",left:r,right:s})}}}),xw=g(2,(e,t)=>Fn(FT(e,t))),Dp=g(2,(e,t)=>Fn(MT(e,t))),eF=g(2,(e,t)=>{if(e.backing._tag==="ISingleton")return t(e.backing.a,0);let n=un,r=0;for(const s of e)n=$e(n,t(s,r++));return n}),tF=eF(Z),qc=e=>e.length===0,Mn=e=>e.length>0,Pl=XI(0),Aw=e=>$r(e,0),Bn=Aw,Nw=g(2,(e,t)=>e.backing._tag==="ISingleton"?de(t(e.backing.a,0)):Fn(p($n(e),cs((n,r)=>t(n,r))))),Lw=g(2,(e,t)=>[qh(e,t),$u(e,t)]),nF=g(2,(e,t)=>{let n=0;for(const r of $n(e)){if(t(r))break;n++}return Lw(e,n)}),ir=e=>$u(e,1),rF=Ns,sF=$p,zh=Symbol.for("effect/Duration"),Dw=BigInt(0),ky=BigInt(24),Pa=BigInt(60),Vh=BigInt(1e3),Cy=BigInt(1e6),Py=BigInt(1e9),iF=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,Yt=e=>{if(jw(e))return e;if(bs(e))return ws(e);if(yl(e))return Wf(e);if(Array.isArray(e)&&e.length===2&&e.every(bs))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?xi:e[0]===1/0||e[1]===1/0?uF:Wf(BigInt(Math.round(e[0]*1e9))+BigInt(Math.round(e[1])));if(dr(e)){const t=iF.exec(e);if(t){const[n,r,s]=t,i=Number(r);switch(s){case"nano":case"nanos":return Wf(BigInt(r));case"micro":case"micros":return lF(BigInt(r));case"milli":case"millis":return ws(i);case"second":case"seconds":return fF(i);case"minute":case"minutes":return hF(i);case"hour":case"hours":return dF(i);case"day":case"days":return pF(i);case"week":case"weeks":return mF(i)}}}throw new Error("Invalid DurationInput")},Ry={_tag:"Millis",millis:0},oF={_tag:"Infinity"},cF={[zh]:zh,[ee](){return ke(this,dS(this.value))},[X](e){return jw(e)&&EF(this,e)},toString(){return`Duration(${kF(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:yF(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[_e](){return this.toJSON()},pipe(){return B(this,arguments)}},Kt=e=>{const t=Object.create(cF);return bs(e)?isNaN(e)||e<=0?t.value=Ry:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=oF:e<=Dw?t.value=Ry:t.value={_tag:"Nanos",nanos:e},t},jw=e=>z(e,zh),aF=e=>{switch(e.value._tag){case"Millis":return e.value.millis===0;case"Nanos":return e.value.nanos===Dw;case"Infinity":return!1}},xi=Kt(0),uF=Kt(1/0),Wf=e=>Kt(e),lF=e=>Kt(e*Vh),ws=e=>Kt(e),fF=e=>Kt(e*1e3),hF=e=>Kt(e*6e4),dF=e=>Kt(e*36e5),pF=e=>Kt(e*864e5),mF=e=>Kt(e*6048e5),vs=e=>Uw(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6}),gF=e=>{const t=Yt(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},yF=e=>{const t=Yt(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/Py),Number(t.value.nanos%Py)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},Uw=g(2,(e,t)=>{const n=Yt(e);switch(n.value._tag){case"Nanos":return t.onNanos(n.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(n.value.millis)}}),Rl=g(3,(e,t,n)=>{const r=Yt(e),s=Yt(t);if(r.value._tag==="Infinity"||s.value._tag==="Infinity")return n.onMillis(vs(r),vs(s));if(r.value._tag==="Nanos"||s.value._tag==="Nanos"){const i=r.value._tag==="Nanos"?r.value.nanos:BigInt(Math.round(r.value.millis*1e6)),o=s.value._tag==="Nanos"?s.value.nanos:BigInt(Math.round(s.value.millis*1e6));return n.onNanos(i,o)}return n.onMillis(r.value.millis,s.value.millis)}),bF=(e,t)=>Rl(e,t,{onMillis:(n,r)=>n===r,onNanos:(n,r)=>n===r}),_F=g(2,(e,t)=>Uw(e,{onMillis:n=>Kt(n*t),onNanos:n=>Kt(n*BigInt(t))})),SF=g(2,(e,t)=>Rl(e,t,{onMillis:(n,r)=>Kt(n+r),onNanos:(n,r)=>Kt(n+r)})),wF=g(2,(e,t)=>Rl(e,t,{onMillis:(n,r)=>n<=r,onNanos:(n,r)=>n<=r})),vF=g(2,(e,t)=>Rl(e,t,{onMillis:(n,r)=>n>=r,onNanos:(n,r)=>n>=r})),EF=g(2,(e,t)=>bF(Yt(e),Yt(t))),OF=e=>{const t=Yt(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};const n=gF(t),r=n/Cy,s=r/Vh,i=s/Pa,o=i/Pa,c=o/ky;return{days:Number(c),hours:Number(o%ky),minutes:Number(i%Pa),seconds:Number(s%Pa),millis:Number(r%Vh),nanos:Number(n%Cy)}},kF=e=>{const t=Yt(e);if(t.value._tag==="Infinity")return"Infinity";if(aF(t))return"0";const n=OF(t),r=[];return n.days!==0&&r.push(`${n.days}d`),n.hours!==0&&r.push(`${n.hours}h`),n.minutes!==0&&r.push(`${n.minutes}m`),n.seconds!==0&&r.push(`${n.seconds}s`),n.millis!==0&&r.push(`${n.millis}ms`),n.nanos!==0&&r.push(`${n.nanos}ns`),r.join(" ")},Es=5,jp=Math.pow(2,Es),CF=jp-1,PF=jp/2,RF=jp/4;function $F(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Ai(e,t){return t>>>e&CF}function ci(e){return 1<<e}function Bw(e,t){return $F(e&t-1)}const TF=(e,t)=>({value:e,previous:t});function gi(e,t,n,r){let s=r;if(!e){const i=r.length;s=new Array(i);for(let o=0;o<i;++o)s[o]=r[o]}return s[t]=n,s}function Kw(e,t,n){const r=n.length-1;let s=0,i=0,o=n;if(e)s=i=t;else for(o=new Array(r);s<t;)o[i++]=n[s++];for(++s;s<=r;)o[i++]=n[s++];return e&&(o.length=r),o}function IF(e,t,n,r){const s=r.length;if(e){let a=s;for(;a>=t;)r[a--]=r[a];return r[t]=n,r}let i=0,o=0;const c=new Array(s+1);for(;i<t;)c[o++]=r[i++];for(c[t]=n;i<s;)c[++o]=r[i++];return c}class Mr{_tag="EmptyNode";modify(t,n,r,s,i,o){const c=r(A());return Qe(c)?new Mr:(++o.value,new us(t,s,i,c))}}function Pn(e){return aS(e,"EmptyNode")}function FF(e){return Pn(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function $l(e,t){return Pn(e)?!1:t===e.edit}class us{edit;hash;key;value;_tag="LeafNode";constructor(t,n,r,s){this.edit=t,this.hash=n,this.key=r,this.value=s}modify(t,n,r,s,i,o){if(J(i,this.key)){const a=r(this.value);return a===this.value?this:Qe(a)?(--o.value,new Mr):$l(this,t)?(this.value=a,this):new us(t,s,i,a)}const c=r(A());return Qe(c)?this:(++o.value,qw(t,n,this.hash,this,s,new us(t,s,i,c)))}}class Up{edit;hash;children;_tag="CollisionNode";constructor(t,n,r){this.edit=t,this.hash=n,this.children=r}modify(t,n,r,s,i,o){if(s===this.hash){const a=$l(this,t),u=this.updateCollisionList(a,t,this.hash,this.children,r,i,o);return u===this.children?this:u.length>1?new Up(t,this.hash,u):u[0]}const c=r(A());return Qe(c)?this:(++o.value,qw(t,n,this.hash,this,s,new us(t,s,i,c)))}updateCollisionList(t,n,r,s,i,o,c){const a=s.length;for(let l=0;l<a;++l){const f=s[l];if("key"in f&&J(o,f.key)){const h=f.value,d=i(h);return d===h?s:Qe(d)?(--c.value,Kw(t,l,s)):gi(t,l,new us(n,r,o,d),s)}}const u=i(A());return Qe(u)?s:(++c.value,gi(t,a,new us(n,r,o,u),s))}}class Ni{edit;mask;children;_tag="IndexedNode";constructor(t,n,r){this.edit=t,this.mask=n,this.children=r}modify(t,n,r,s,i,o){const c=this.mask,a=this.children,u=Ai(n,s),l=ci(u),f=Bw(c,l),h=c&l,d=$l(this,t);if(!h){const S=new Mr().modify(t,n+Es,r,s,i,o);return S?a.length>=PF?xF(t,u,S,c,a):new Ni(t,c|l,IF(d,f,S,a)):this}const m=a[f],y=m.modify(t,n+Es,r,s,i,o);if(m===y)return this;let b=c,_;if(Pn(y)){if(b&=~l,!b)return new Mr;if(a.length<=2&&FF(a[f^1]))return a[f^1];_=Kw(d,f,a)}else _=gi(d,f,y,a);return d?(this.mask=b,this.children=_,this):new Ni(t,b,_)}}class Bp{edit;size;children;_tag="ArrayNode";constructor(t,n,r){this.edit=t,this.size=n,this.children=r}modify(t,n,r,s,i,o){let c=this.size;const a=this.children,u=Ai(n,s),l=a[u],f=(l||new Mr).modify(t,n+Es,r,s,i,o);if(l===f)return this;const h=$l(this,t);let d;if(Pn(l)&&!Pn(f))++c,d=gi(h,u,f,a);else if(!Pn(l)&&Pn(f)){if(--c,c<=RF)return MF(t,c,u,a);d=gi(h,u,new Mr,a)}else d=gi(h,u,f,a);return h?(this.size=c,this.children=d,this):new Bp(t,c,d)}}function MF(e,t,n,r){const s=new Array(t-1);let i=0,o=0;for(let c=0,a=r.length;c<a;++c)if(c!==n){const u=r[c];u&&!Pn(u)&&(s[i++]=u,o|=1<<c)}return new Ni(e,o,s)}function xF(e,t,n,r,s){const i=[];let o=r,c=0;for(let a=0;o;++a)o&1&&(i[a]=s[c++]),o>>>=1;return i[t]=n,new Bp(e,c+1,i)}function AF(e,t,n,r,s,i){if(n===s)return new Up(e,n,[i,r]);const o=Ai(t,n),c=Ai(t,s);if(o===c)return a=>new Ni(e,ci(o)|ci(c),[a]);{const a=o<c?[r,i]:[i,r];return new Ni(e,ci(o)|ci(c),a)}}function qw(e,t,n,r,s,i){let o,c=t;for(;;){const a=AF(e,c,n,r,s,i);if(typeof a=="function")o=TF(a,o),c=c+Es;else{let u=a;for(;o!=null;)u=o.value(u),o=o.previous;return u}}}const zw="effect/HashMap",Hh=Symbol.for(zw),NF={[Hh]:Hh,[Symbol.iterator](){return new Tl(this,(e,t)=>[e,t])},[ee](){let e=K(zw);for(const t of this)e^=p(K(t[0]),ie(K(t[1])));return ke(this,e)},[X](e){if(jF(e)){if(e._size!==this._size)return!1;for(const t of this){const n=p(e,qp(t[0],K(t[0])));if(Qe(n))return!1;if(!J(t[1],n.value))return!1}return!0}return!1},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(Ce)}},[_e](){return this.toJSON()},pipe(){return B(this,arguments)}},Kp=(e,t,n,r)=>{const s=Object.create(NF);return s._editable=e,s._edit=t,s._root=n,s._size=r,s};class Tl{map;f;v;constructor(t,n){this.map=t,this.f=n,this.v=Vw(this.map._root,this.f,void 0)}next(){if(Qe(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=Tu(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new Tl(this.map,this.f)}}const Tu=e=>e?Hw(e[0],e[1],e[2],e[3],e[4]):A(),Vw=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return Be(e.value)?N({value:t(e.key,e.value.value),cont:n}):Tu(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const r=e.children;return Hw(r.length,r,0,t,n)}default:return Tu(n)}},Hw=(e,t,n,r,s)=>{for(;n<e;){const i=t[n++];if(i&&!Pn(i))return Vw(i,r,[e,t,n,r,s])}return Tu(s)},LF=Kp(!1,0,new Mr,0),Il=()=>LF,DF=e=>{const t=Jw(Il());for(const n of e)ac(t,n[0],n[1]);return zF(t)},jF=e=>z(e,Hh),UF=e=>e&&Pn(e._root),BF=g(2,(e,t)=>qp(e,t,K(t))),qp=g(3,(e,t,n)=>{let r=e._root,s=0;for(;;)switch(r._tag){case"LeafNode":return J(t,r.key)?r.value:A();case"CollisionNode":{if(n===r.hash){const i=r.children;for(let o=0,c=i.length;o<c;++o){const a=i[o];if("key"in a&&J(t,a.key))return a.value}}return A()}case"IndexedNode":{const i=Ai(s,n),o=ci(i);if(r.mask&o){r=r.children[Bw(r.mask,o)],s+=Es;break}return A()}case"ArrayNode":{if(r=r.children[Ai(s,n)],r){s+=Es;break}return A()}default:return A()}}),KF=g(2,(e,t)=>Be(qp(e,t,K(t)))),ac=g(3,(e,t,n)=>zp(e,t,()=>N(n))),qF=g(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:Kp(e._editable,e._edit,t,n)),Ww=e=>new Tl(e,t=>t),Iu=e=>e._size,Jw=e=>Kp(!0,e._edit+1,e._root,e._size),zF=e=>(e._editable=!1,e),zp=g(3,(e,t,n)=>VF(e,t,K(t),n)),VF=g(4,(e,t,n,r)=>{const s={value:e._size},i=e._root.modify(e._editable?e._edit:NaN,0,r,n,t,s);return p(e,qF(i,s.value))}),$y=g(2,(e,t)=>zp(e,t,A)),HF=g(2,(e,t)=>Fl(e,Il(),(n,r,s)=>ac(n,s,t(r,s)))),Qw=g(2,(e,t)=>Fl(e,void 0,(n,r,s)=>t(r,s))),Fl=g(3,(e,t,n)=>{const r=e._root;if(r._tag==="LeafNode")return Be(r.value)?n(t,r.value.value,r.key):t;if(r._tag==="EmptyNode")return t;const s=[r.children];let i;for(;i=s.pop();)for(let o=0,c=i.length;o<c;){const a=i[o++];a&&!Pn(a)&&(a._tag==="LeafNode"?Be(a.value)&&(t=n(t,a.value.value,a.key)):s.push(a.children))}return t}),Gw="effect/HashSet",Wh=Symbol.for(Gw),WF={[Wh]:Wh,[Symbol.iterator](){return Ww(this._keyMap)},[ee](){return ke(this,ie(K(this._keyMap))(K(Gw)))},[X](e){return JF(e)?Iu(this._keyMap)===Iu(e._keyMap)&&J(this._keyMap,e._keyMap):!1},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(Ce)}},[_e](){return this.toJSON()},pipe(){return B(this,arguments)}},Ml=e=>{const t=Object.create(WF);return t._keyMap=e,t},JF=e=>z(e,Wh),QF=Ml(Il()),xl=()=>QF,GF=e=>{const t=Vp(xl());for(const n of e)uc(t,n);return Hp(t)},YF=(...e)=>{const t=Vp(xl());for(const n of e)uc(t,n);return Hp(t)},XF=g(2,(e,t)=>KF(e._keyMap,t)),ZF=e=>Iu(e._keyMap),Vp=e=>Ml(Jw(e._keyMap)),Hp=e=>(e._keyMap._editable=!1,e),Yw=g(2,(e,t)=>{const n=Vp(e);return t(n),Hp(n)}),uc=g(2,(e,t)=>e._keyMap._editable?(ac(t,!0)(e._keyMap),e):Ml(ac(t,!0)(e._keyMap))),Xw=g(2,(e,t)=>e._keyMap._editable?($y(t)(e._keyMap),e):Ml($y(t)(e._keyMap))),eM=g(2,(e,t)=>Yw(e,n=>{for(const r of t)Xw(n,r)})),tM=g(2,(e,t)=>Yw(xl(),n=>{nM(e,r=>uc(n,r));for(const r of t)uc(n,r)})),nM=g(2,(e,t)=>Qw(e._keyMap,(n,r)=>t(r))),rM=g(3,(e,t,n)=>Fl(e._keyMap,t,(r,s,i)=>n(r,i))),Os=xl,sM=GF,Wp=YF,iM=XF,Jp=ZF,yi=uc,Qp=Xw,Ty=eM,lc=tM,fc=rM,Iy=Symbol.for("effect/MutableRef"),oM={[Iy]:Iy,toString(){return Ke(this.toJSON())},toJSON(){return{_id:"MutableRef",current:Ce(this.current)}},[_e](){return this.toJSON()},pipe(){return B(this,arguments)}},js=e=>{const t=Object.create(oM);return t.current=e,t},cM=g(3,(e,t,n)=>J(t,e.current)?(e.current=n,!0):!1),ae=e=>e.current,Us=g(2,(e,t)=>(e.current=t,e)),Al="effect/FiberId",ks=Symbol.for(Al),Li="None",Jh="Runtime",Qh="Composite",aM=je(`${Al}-${Li}`);let uM=class{[ks]=ks;_tag=Li;id=-1;startTimeMillis=-1;[ee](){return aM}[X](t){return Gp(t)&&t._tag===Li}toString(){return Ke(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[_e](){return this.toJSON()}};class lM{id;startTimeMillis;[ks]=ks;_tag=Jh;constructor(t,n){this.id=t,this.startTimeMillis=n}[ee](){return ke(this,je(`${Al}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[X](t){return Gp(t)&&t._tag===Jh&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return Ke(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[_e](){return this.toJSON()}}let fM=class{left;right;[ks]=ks;_tag=Qh;constructor(t,n){this.left=t,this.right=n}_hash;[ee](){return p(je(`${Al}-${this._tag}`),ie(K(this.left)),ie(K(this.right)),ke(this))}[X](t){return Gp(t)&&t._tag===Qh&&J(this.left,t.left)&&J(this.right,t.right)}toString(){return Ke(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:Ce(this.left),right:Ce(this.right)}}[_e](){return this.toJSON()}};const Zw=new uM,Gp=e=>z(e,ks),ev=g(2,(e,t)=>e._tag===Li?t:t._tag===Li?e:new fM(e,t)),hM=e=>p(e,fc(Zw,(t,n)=>ev(n)(t))),Fu=e=>{switch(e._tag){case Li:return Os();case Jh:return Wp(e.id);case Qh:return p(Fu(e.left),lc(Fu(e.right)))}},Fy=ne(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>js(0)),Nl=e=>Array.from(Fu(e)).map(n=>`#${n}`).join(","),dM=()=>{const e=ae(Fy);return p(Fy,Us(e+1)),new lM(e,Date.now())},Cs=Zw,pM=ev,mM=hM,gM=Fu,yM=Nl,tv=dM,Ll=Il,bM=DF,_M=UF,nv=BF,rv=ac,sv=Ww,iv=Iu,SM=zp,wM=HF,vM=Qw,ov=Fl,hc=Symbol.for("effect/List"),Gh=e=>ye(e),EM=e=>g$(Tp(e),Gh),OM=EM(J),kM={[hc]:hc,_tag:"Cons",toString(){return Ke(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:Gh(this).map(Ce)}},[_e](){return this.toJSON()},[X](e){return av(e)&&this._tag===e._tag&&OM(this,e)},[ee](){return ke(this,Nc(Gh(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();const n=t.head;return t=t.tail,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},pipe(){return B(this,arguments)}},Mu=(e,t)=>{const n=Object.create(kM);return n.head=e,n.tail=t,n},CM=je("Nil"),PM={[hc]:hc,_tag:"Nil",toString(){return Ke(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[_e](){return this.toJSON()},[ee](){return CM},[X](e){return av(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return B(this,arguments)}},cv=Object.create(PM),av=e=>z(e,hc),ur=e=>e._tag==="Nil",Yp=e=>e._tag==="Cons",RM=()=>cv,Ps=(e,t)=>Mu(e,t),Di=RM,Xp=e=>Mu(e,cv),$M=g(2,(e,t)=>IM(t,e)),TM=g(2,(e,t)=>Ps(t,e)),IM=g(2,(e,t)=>{if(ur(e))return t;if(ur(t))return e;{const n=Mu(t.head,e);let r=n,s=t.tail;for(;!ur(s);){const i=Mu(s.head,e);r.tail=i,r=i,s=s.tail}return n}}),FM=g(3,(e,t,n)=>{let r=t,s=e;for(;!ur(s);)r=n(r,s.head),s=s.tail;return r}),MM=e=>{let t=Di(),n=e;for(;!ur(n);)t=TM(t,n.head),n=n.tail;return t},Zp=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=Cp,e}(),xM=Symbol.for("effect/DifferContextPatch");function My(e){return e}const zc={...Zp.prototype,[xM]:{_Value:My,_Patch:My}},AM=Object.assign(Object.create(zc),{_tag:"Empty"}),NM=Object.create(AM),uv=()=>NM,LM=Object.assign(Object.create(zc),{_tag:"AndThen"}),DM=(e,t)=>{const n=Object.create(LM);return n.first=e,n.second=t,n},jM=Object.assign(Object.create(zc),{_tag:"AddService"}),UM=(e,t)=>{const n=Object.create(jM);return n.key=e,n.service=t,n},BM=Object.assign(Object.create(zc),{_tag:"RemoveService"}),KM=e=>{const t=Object.create(BM);return t.key=e,t},qM=Object.assign(Object.create(zc),{_tag:"UpdateService"}),zM=(e,t)=>{const n=Object.create(qM);return n.key=e,n.update=t,n},VM=(e,t)=>{const n=new Map(e.unsafeMap);let r=uv();for(const[s,i]of t.unsafeMap.entries())if(n.has(s)){const o=n.get(s);n.delete(s),J(o,i)||(r=Wa(zM(s,()=>i))(r))}else n.delete(s),r=Wa(UM(s,i))(r);for(const[s]of n.entries())r=Wa(KM(s))(r);return r},Wa=g(2,(e,t)=>DM(e,t)),HM=g(2,(e,t)=>{if(e._tag==="Empty")return t;let n=!1,r=de(e);const s=new Map(t.unsafeMap);for(;Mn(r);){const o=Bn(r),c=ir(r);switch(o._tag){case"Empty":{r=c;break}case"AddService":{s.set(o.key,o.service),r=c;break}case"AndThen":{r=mt(mt(c,o.second),o.first);break}case"RemoveService":{s.delete(o.key),r=c;break}case"UpdateService":{s.set(o.key,o.update(s.get(o.key))),n=!0,r=c;break}}}if(!n)return Ii(s);const i=new Map;for(const[o]of t.unsafeMap)s.has(o)&&(i.set(o,s.get(o)),s.delete(o));for(const[o,c]of s)i.set(o,c);return Ii(i)}),WM=Symbol.for("effect/DifferHashSetPatch");function Jf(e){return e}const Dl={...Zp.prototype,[WM]:{_Value:Jf,_Key:Jf,_Patch:Jf}},JM=Object.assign(Object.create(Dl),{_tag:"Empty"}),QM=Object.create(JM),lv=()=>QM,GM=Object.assign(Object.create(Dl),{_tag:"AndThen"}),YM=(e,t)=>{const n=Object.create(GM);return n.first=e,n.second=t,n},XM=Object.assign(Object.create(Dl),{_tag:"Add"}),ZM=e=>{const t=Object.create(XM);return t.value=e,t},ex=Object.assign(Object.create(Dl),{_tag:"Remove"}),tx=e=>{const t=Object.create(ex);return t.value=e,t},nx=(e,t)=>{const[n,r]=fc([e,lv()],([s,i],o)=>iM(o)(s)?[Qp(o)(s),i]:[s,Yh(ZM(o))(i)])(t);return fc(r,(s,i)=>Yh(tx(i))(s))(n)},Yh=g(2,(e,t)=>YM(e,t)),rx=g(2,(e,t)=>{if(e._tag==="Empty")return t;let n=t,r=de(e);for(;Mn(r);){const s=Bn(r),i=ir(r);switch(s._tag){case"Empty":{r=i;break}case"AndThen":{r=mt(s.first)(mt(s.second)(i));break}case"Add":{n=yi(s.value)(n),r=i;break}case"Remove":n=Qp(s.value)(n),r=i}}return n}),sx=Symbol.for("effect/DifferReadonlyArrayPatch");function xy(e){return e}const Vc={...Zp.prototype,[sx]:{_Value:xy,_Patch:xy}},ix=Object.assign(Object.create(Vc),{_tag:"Empty"}),ox=Object.create(ix),fv=()=>ox,cx=Object.assign(Object.create(Vc),{_tag:"AndThen"}),ax=(e,t)=>{const n=Object.create(cx);return n.first=e,n.second=t,n},ux=Object.assign(Object.create(Vc),{_tag:"Append"}),lx=e=>{const t=Object.create(ux);return t.values=e,t},fx=Object.assign(Object.create(Vc),{_tag:"Slice"}),hx=(e,t)=>{const n=Object.create(fx);return n.from=e,n.until=t,n},dx=Object.assign(Object.create(Vc),{_tag:"Update"}),px=(e,t)=>{const n=Object.create(dx);return n.index=e,n.patch=t,n},mx=e=>{let t=0,n=fv();for(;t<e.oldValue.length&&t<e.newValue.length;){const r=e.oldValue[t],s=e.newValue[t],i=e.differ.diff(r,s);J(i,e.differ.empty)||(n=Ja(n,px(t,i))),t=t+1}return t<e.oldValue.length&&(n=Ja(n,hx(0,t))),t<e.newValue.length&&(n=Ja(n,lx(CT(t)(e.newValue)))),n},Ja=g(2,(e,t)=>ax(e,t)),gx=g(3,(e,t,n)=>{if(e._tag==="Empty")return t;let r=t.slice(),s=vn(e);for(;za(s);){const i=Ft(s),o=_s(s);switch(i._tag){case"Empty":{s=o;break}case"AndThen":{o.unshift(i.first,i.second),s=o;break}case"Append":{for(const c of i.values)r.push(c);s=o;break}case"Slice":{r=r.slice(i.from,i.until),s=o;break}case"Update":{r[i.index]=n.patch(i.patch,r[i.index]),s=o;break}}}return r}),yx=Symbol.for("effect/Differ"),bx={[yx]:{_P:Z,_V:Z},pipe(){return B(this,arguments)}},oo=e=>{const t=Object.create(bx);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},_x=()=>oo({empty:uv(),combine:(e,t)=>Wa(t)(e),diff:(e,t)=>VM(e,t),patch:(e,t)=>HM(t)(e)}),Sx=()=>oo({empty:lv(),combine:(e,t)=>Yh(t)(e),diff:(e,t)=>nx(e,t),patch:(e,t)=>rx(t)(e)}),wx=e=>oo({empty:fv(),combine:(t,n)=>Ja(t,n),diff:(t,n)=>mx({oldValue:t,newValue:n,differ:e}),patch:(t,n)=>gx(t,n,e)}),hv=()=>vx((e,t)=>t),vx=e=>oo({empty:Z,combine:(t,n)=>t===Z?n:n===Z?t:r=>n(t(r)),diff:(t,n)=>J(t,n)?Z:pl(n),patch:(t,n)=>e(n,t(n))}),dc=255,dv=8,Xh=e=>e&dc,Zh=e=>e>>dv&dc,Hc=(e,t)=>(e&dc)+((t&e&dc)<<dv),Ex=Hc(0,0),Ox=e=>Hc(e,e),kx=e=>Hc(e,0),Cx=g(2,(e,t)=>Hc(Xh(e)&~t,Zh(e))),Px=g(2,(e,t)=>e|t),Rx=e=>~e>>>0&dc,$x=0,Bs=1,Tx=2,pv=4,ed=16,mv=32,Ix=e=>jl(e,mv),Fx=g(2,(e,t)=>e&~t),Mx=g(2,(e,t)=>e|t),vr=e=>gv(e)&&!Ax(e),gv=e=>jl(e,Bs),jl=g(2,(e,t)=>(e&t)!==0),yv=(...e)=>e.reduce((t,n)=>t|n,0),xx=yv($x),Ay=e=>jl(e,pv),Ax=e=>jl(e,ed),ls=g(2,(e,t)=>Hc(e^t,t)),bi=g(2,(e,t)=>e&(Rx(Xh(t))|Zh(t))|Xh(t)&Zh(t)),Ny=oo({empty:Ex,diff:(e,t)=>ls(e,t),combine:(e,t)=>Px(t)(e),patch:(e,t)=>bi(t,e)}),Nx=Ox,bv=kx,Ly=Cx,_v=(e,t)=>({_tag:"Par",left:e,right:t}),Ra=(e,t)=>({_tag:"Seq",left:e,right:t}),Lx=e=>{let t=Xp(e),n=Di();for(;;){const[r,s]=FM(t,[Sv(),Di()],([i,o],c)=>{const[a,u]=Dx(c);return[qx(i,a),$M(o,u)]});if(n=jx(n,r),ur(s))return MM(n);t=s}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},Dx=e=>{let t=e,n=Sv(),r=Di(),s=Di();for(;;)switch(t._tag){case"Empty":{if(ur(r))return[n,s];t=r.head,r=r.tail;break}case"Par":{r=Ps(t.right,r),t=t.left;break}case"Seq":{const i=t.left,o=t.right;switch(i._tag){case"Empty":{t=o;break}case"Par":{const c=i.left,a=i.right;t=_v(Ra(c,o),Ra(a,o));break}case"Seq":{const c=i.left,a=i.right;t=Ra(c,Ra(a,o));break}case"Single":{t=i,s=Ps(o,s);break}}break}case"Single":{if(n=Kx(n,t),ur(r))return[n,s];t=r.head,r=r.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},jx=(e,t)=>{if(ur(e))return Xp(Qf(t));if(zx(t))return e;const n=Gx(e.head),r=Vx(t);return n.length===1&&r.length===1&&J(n[0],r[0])?Ps(Qx(e.head,Qf(t)),e.tail):Ps(Qf(t),e)},Ux=Symbol.for("effect/RequestBlock/RequestBlockParallel"),Bx={_R:e=>e};class em{map;[Ux]=Bx;constructor(t){this.map=t}}const Sv=()=>new em(Ll()),Kx=(e,t)=>new em(SM(e.map,t.dataSource,n=>aT(os(n,cc(t.blockedRequest)),()=>de(t.blockedRequest)))),qx=(e,t)=>new em(ov(e.map,t.map,(n,r,s)=>rv(n,s,we(nv(n,s),{onNone:()=>r,onSome:i=>$e(r,i)})))),zx=e=>_M(e.map),Vx=e=>Array.from(sv(e.map)),Qf=e=>Jx(wM(e.map,t=>de(t))),Hx=Symbol.for("effect/RequestBlock/RequestBlockSequential"),Wx={_R:e=>e};class wv{map;[Hx]=Wx;constructor(t){this.map=t}}const Jx=e=>new wv(e),Qx=(e,t)=>new wv(ov(t.map,e.map,(n,r,s)=>rv(n,s,we(nv(n,s),{onNone:()=>Oe(),onSome:i=>$e(i,r)})))),Gx=e=>Array.from(sv(e.map)),Yx=e=>Array.from(e.map),co="Die",Rs="Empty",Ks="Fail",ao="Interrupt",ji="Parallel",Ui="Sequential",vv="effect/Cause",Ev=Symbol.for(vv),Xx={_E:e=>e},uo={[Ev]:Xx,[ee](){return p(K(vv),ie(K(c1(this))),ke(this))},[X](e){return Ov(e)&&o1(this,e)},pipe(){return B(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:Ce(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:Ce(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:Ce(this.left),right:Ce(this.right)}}},toString(){return zr(this)},[_e](){return this.toJSON()}},xr=(()=>{const e=Object.create(uo);return e._tag=Rs,e})(),Ar=e=>{const t=Object.create(uo);return t._tag=Ks,t.error=e,t},Wt=e=>{const t=Object.create(uo);return t._tag=co,t.defect=e,t},ln=e=>{const t=Object.create(uo);return t._tag=ao,t.fiberId=e,t},Nr=(e,t)=>{const n=Object.create(uo);return n._tag=ji,n.left=e,n.right=t,n},ct=(e,t)=>{const n=Object.create(uo);return n._tag=Ui,n.left=e,n.right=t,n},Ov=e=>z(e,Ev),Zx=e=>e._tag===Rs,e1=e=>e._tag===Ks,kv=e=>e._tag===co,tm=e=>e._tag===Rs?!0:Bi(e,!0,(t,n)=>{switch(n._tag){case Rs:return N(t);case co:case Ks:case ao:return N(!1);default:return A()}}),Cv=e=>Be(r1(e)),Ul=e=>sm(void 0,u1)(e),t1=e=>pr(Bi(e,Oe(),(t,n)=>n._tag===Ks?N(p(t,mt(n.error))):A())),Pv=e=>pr(Bi(e,Oe(),(t,n)=>n._tag===co?N(p(t,mt(n.defect))):A())),nm=e=>Bi(e,Os(),(t,n)=>n._tag===ao?N(p(t,yi(n.fiberId))):A()),Rv=e=>rm(e,t=>t._tag===Ks?N(t.error):A()),$v=e=>{const t=Rv(e);switch(t._tag){case"None":return Y(e);case"Some":return V(t.value)}},n1=e=>Bl(e,{onEmpty:N(xr),onFail:os(Ar),onDie:t=>N(Wt(t)),onInterrupt:t=>N(ln(t)),onSequential:py(ct),onParallel:py(Nr)}),r1=e=>rm(e,t=>t._tag===ao?N(t.fiberId):A()),Dy=e=>Bl(e,{onEmpty:xr,onFail:()=>xr,onDie:Wt,onInterrupt:ln,onSequential:ct,onParallel:Nr}),s1=e=>Bl(e,{onEmpty:xr,onFail:Wt,onDie:Wt,onInterrupt:ln,onSequential:ct,onParallel:Nr}),Tv=g(2,(e,t)=>i1(e,n=>Ar(t(n)))),i1=g(2,(e,t)=>Bl(e,{onEmpty:xr,onFail:n=>t(n),onDie:n=>Wt(n),onInterrupt:n=>ln(n),onSequential:(n,r)=>ct(n,r),onParallel:(n,r)=>Nr(n,r)})),o1=(e,t)=>{let n=de(e),r=de(t);for(;Mn(n)&&Mn(r);){const[s,i]=p(Bn(n),Bi([Os(),Oe()],([a,u],l)=>{const[f,h]=td(l);return N([p(a,lc(f)),p(u,$e(h))])})),[o,c]=p(Bn(r),Bi([Os(),Oe()],([a,u],l)=>{const[f,h]=td(l);return N([p(a,lc(f)),p(u,$e(h))])}));if(!J(s,o))return!1;n=i,r=c}return!0},c1=e=>a1(de(e),Oe()),a1=(e,t)=>{for(;;){const[n,r]=p(e,$p([Os(),Oe()],([i,o],c)=>{const[a,u]=td(c);return[p(i,lc(a)),p(o,$e(u))]})),s=Jp(n)>0?p(t,mt(n)):t;if(qc(r))return pr(s);e=r,t=s}throw new Error(bl("Cause.flattenCauseLoop"))},rm=g(2,(e,t)=>{const n=[e];for(;n.length>0;){const r=n.pop(),s=t(r);switch(s._tag){case"None":{switch(r._tag){case Ui:case ji:{n.push(r.right),n.push(r.left);break}}break}case"Some":return s}}return A()}),td=e=>{let t=e;const n=[];let r=Os(),s=Oe();for(;t!==void 0;)switch(t._tag){case Rs:{if(n.length===0)return[r,s];t=n.pop();break}case Ks:{if(r=yi(r,Ha(t._tag,t.error)),n.length===0)return[r,s];t=n.pop();break}case co:{if(r=yi(r,Ha(t._tag,t.defect)),n.length===0)return[r,s];t=n.pop();break}case ao:{if(r=yi(r,Ha(t._tag,t.fiberId)),n.length===0)return[r,s];t=n.pop();break}case Ui:{switch(t.left._tag){case Rs:{t=t.right;break}case Ui:{t=ct(t.left.left,ct(t.left.right,t.right));break}case ji:{t=Nr(ct(t.left.left,t.right),ct(t.left.right,t.right));break}default:{s=mt(s,t.right),t=t.left;break}}break}case ji:{n.push(t.right),t=t.left;break}}throw new Error(bl("Cause.evaluateCauseLoop"))},u1={emptyCase:fy,failCase:_u,dieCase:_u,interruptCase:fy,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},jy="SequentialCase",Uy="ParallelCase",Bl=g(2,(e,{onDie:t,onEmpty:n,onFail:r,onInterrupt:s,onParallel:i,onSequential:o})=>sm(e,void 0,{emptyCase:()=>n,failCase:(c,a)=>r(a),dieCase:(c,a)=>t(a),interruptCase:(c,a)=>s(a),sequentialCase:(c,a,u)=>o(a,u),parallelCase:(c,a,u)=>i(a,u)})),Bi=g(3,(e,t,n)=>{let r=t,s=e;const i=[];for(;s!==void 0;){const o=n(r,s);switch(r=Be(o)?o.value:r,s._tag){case Ui:{i.push(s.right),s=s.left;break}case ji:{i.push(s.right),s=s.left;break}default:{s=void 0;break}}s===void 0&&i.length>0&&(s=i.pop())}return r}),sm=g(3,(e,t,n)=>{const r=[e],s=[];for(;r.length>0;){const o=r.pop();switch(o._tag){case Rs:{s.push(Y(n.emptyCase(t)));break}case Ks:{s.push(Y(n.failCase(t,o.error)));break}case co:{s.push(Y(n.dieCase(t,o.defect)));break}case ao:{s.push(Y(n.interruptCase(t,o.fiberId)));break}case Ui:{r.push(o.right),r.push(o.left),s.push(V({_tag:jy}));break}case ji:{r.push(o.right),r.push(o.left),s.push(V({_tag:Uy}));break}}}const i=[];for(;s.length>0;){const o=s.pop();switch(o._tag){case"Left":{switch(o.left._tag){case jy:{const c=i.pop(),a=i.pop(),u=n.sequentialCase(t,c,a);i.push(u);break}case Uy:{const c=i.pop(),a=i.pop(),u=n.parallelCase(t,c,a);i.push(u);break}}break}case"Right":{i.push(o.right);break}}}if(i.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return i.pop()}),zr=(e,t)=>Ul(e)?"All fibers interrupted without errors.":Fv(e).map(function(n){return t?.renderErrorCause!==!0||n.cause===void 0?n.stack:`${n.stack} {
${Iv(n.cause,"  ")}
}`}).join(`
`),Iv=(e,t)=>{const n=e.stack.split(`
`);let r=`${t}[cause]: ${n[0]}`;for(let s=1,i=n.length;s<i;s++)r+=`
${t}${n[s]}`;return e.cause&&(r+=` {
${Iv(e.cause,`${t}  `)}
${t}}`),r};class xu extends globalThis.Error{span=void 0;constructor(t){const n=typeof t=="object"&&t!==null,r=Error.stackTraceLimit;Error.stackTraceLimit=1,super(l1(t),n&&"cause"in t&&typeof t.cause<"u"?{cause:new xu(t.cause)}:void 0),this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=r,this.name=t instanceof Error?t.name:"Error",n&&(Ki in t&&(this.span=t[Ki]),Object.keys(t).forEach(s=>{s in this||(this[s]=t[s])})),this.stack=h1(`${this.name}: ${this.message}`,t instanceof Error&&t.stack?t.stack:"",this.span)}}const l1=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(z(e,"toString")&&eo(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return pS(e)},f1=/\((.*)\)/g,Au=ne("effect/Tracer/spanToTrace",()=>new WeakMap),h1=(e,t,n)=>{const r=[e],s=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let i=1;i<s.length;i++){if(s[i].includes(" at new BaseEffectError")||s[i].includes(" at new YieldableError")){i++;continue}if(s[i].includes("Generator.next")||s[i].includes("effect_internal_function"))break;r.push(s[i].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(n){let i=n,o=0;for(;i&&i._tag==="Span"&&o<10;){const c=Au.get(i);if(typeof c=="function"){const a=c();if(typeof a=="string"){const u=a.matchAll(f1);let l=!1;for(const[,f]of u)l=!0,r.push(`    at ${i.name} (${f})`);l||r.push(`    at ${i.name} (${a.replace(/^at /,"")})`)}else r.push(`    at ${i.name}`)}else r.push(`    at ${i.name}`);i=Dn(i.parent),o++}}return r.join(`
`)},Ki=Symbol.for("effect/SpanAnnotation"),Fv=e=>sm(e,void 0,{emptyCase:()=>[],dieCase:(t,n)=>[new xu(n)],failCase:(t,n)=>[new xu(n)],interruptCase:()=>[],parallelCase:(t,n,r)=>[...n,...r],sequentialCase:(t,n,r)=>[...n,...r]}),Wc="Pending",Kl="Done",d1="effect/Deferred",p1=Symbol.for(d1),m1={_E:e=>e,_A:e=>e},g1=e=>({_tag:Wc,joiners:e}),Mv=e=>({_tag:Kl,effect:e});class Jc{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new Jc(this.self)}}const xv=(e,t)=>{const n=new Ge("Blocked");return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n},y1=e=>{const t=new Ge("RunBlocked");return t.effect_instruction_i0=e,t},qi=Symbol.for("effect/Effect");class b1{patch;op;_op=kp;constructor(t,n){this.patch=t,this.op=n}}class Ge{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[qi]=$i;constructor(t){this._op=t}[X](t){return this===t}[ee](){return ke(this,vp(this))}pipe(){return B(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:Ce(this.effect_instruction_i0),effect_instruction_i1:Ce(this.effect_instruction_i1),effect_instruction_i2:Ce(this.effect_instruction_i2)}}toString(){return Ke(this.toJSON())}[_e](){return this.toJSON()}[Symbol.iterator](){return new Jc(new xc(this))}}class Av{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[qi]=$i;constructor(t){this._op=t,this._tag=t}[X](t){return pm(t)&&t._op==="Failure"&&J(this.effect_instruction_i0,t.effect_instruction_i0)}[ee](){return p(je(this._tag),ie(K(this.effect_instruction_i0)),ke(this))}get cause(){return this.effect_instruction_i0}pipe(){return B(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return Ke(this.toJSON())}[_e](){return this.toJSON()}[Symbol.iterator](){return new Jc(new xc(this))}}class Nv{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[qi]=$i;constructor(t){this._op=t,this._tag=t}[X](t){return pm(t)&&t._op==="Success"&&J(this.effect_instruction_i0,t.effect_instruction_i0)}[ee](){return p(je(this._tag),ie(K(this.effect_instruction_i0)),ke(this))}get value(){return this.effect_instruction_i0}pipe(){return B(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:Ce(this.value)}}toString(){return Ke(this.toJSON())}[_e](){return this.toJSON()}[Symbol.iterator](){return new Jc(new xc(this))}}const Yn=e=>z(e,qi),oe=e=>{const t=new Ge(yS);return t.effect_instruction_i0=e,t},Lv=g(3,(e,t,n)=>xn(r=>T(e,s=>T(Vn(G(()=>r(t(s)))),i=>G(()=>n(s,i)).pipe(Xt({onFailure:o=>{switch(i._tag){case tt:return qe(ct(i.effect_instruction_i0,o));case nt:return qe(o)}},onSuccess:()=>i})))))),Et=g(2,(e,t)=>T(e,()=>x(t))),Zt=e=>Et(e,void 0),Dv=function(){const e=new Ge(Sl);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(bl("you're not supposed to end up here"))}return e},pc=(e,t=Cs)=>{const n=new Ge(Qo);let r;return n.effect_instruction_i0=s=>{r=e(s)},n.effect_instruction_i1=t,Gc(n,s=>Yn(r)?r:fe)},im=(e,t=Cs)=>G(()=>pc(e,t)),Lr=(e,t=Cs)=>Dv(e,function(){let n,r;function s(a){n?n(a):r===void 0&&(r=a)}const i=new Ge(Qo);i.effect_instruction_i0=a=>{n=a,r&&a(r)},i.effect_instruction_i1=t;let o,c;return this.effect_instruction_i0.length!==1?(c=new AbortController,o=Rt(()=>this.effect_instruction_i0(s,c.signal))):o=Rt(()=>this.effect_instruction_i0(s)),o||c?Gc(i,a=>(c&&c.abort(),o??fe)):i}),jv=g(2,(e,t)=>{const n=new Ge(Ka);return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n}),zi=g(2,(e,t)=>mr(e,{onFailure:t,onSuccess:x})),By=Symbol.for("effect/OriginalAnnotation"),om=(e,t)=>Be(t)?new Proxy(e,{has(n,r){return r===Ki||r===By||r in n},get(n,r){return r===Ki?t.value:r===By?e:n[r]}}):e,Vi=e=>qr(e)&&!(Ki in e)?oe(t=>qe(Wt(om(e,bm(t))))):qe(Wt(e)),nd=e=>Uv(()=>Wt(new Z1(e))),Hi=e=>mr(e,{onFailure:t=>x(V(t)),onSuccess:t=>x(Y(t))}),Vn=e=>Bv(e,{onFailure:pe,onSuccess:Ee}),Fe=e=>qr(e)&&!(Ki in e)?oe(t=>qe(Ar(om(e,bm(t))))):qe(Ar(e)),ql=e=>T(I(e),Fe),qe=e=>{const t=new Av(tt);return t.effect_instruction_i0=e,t},Uv=e=>T(I(e),qe),zl=oe(e=>x(e.id())),Qc=e=>oe(t=>e(t.id())),T=g(2,(e,t)=>{const n=new Ge(Eu);return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n}),jo=g(2,(e,t)=>T(e,n=>{const r=typeof t=="function"?t(n):t;return Yn(r)?r:uS(r)?pc(s=>{r.then(i=>s(x(i)),i=>s(Fe(new dm(i,"An unknown error occurred in Effect.andThen"))))}):x(r)})),_1=e=>{const t=new Ge("OnStep");return t.effect_instruction_i0=e,t},lo=e=>T(e,Z),Bv=g(2,(e,t)=>Xt(e,{onFailure:n=>x(t.onFailure(n)),onSuccess:n=>x(t.onSuccess(n))})),Xt=g(2,(e,t)=>{const n=new Ge(Ou);return n.effect_instruction_i0=e,n.effect_instruction_i1=t.onFailure,n.effect_instruction_i2=t.onSuccess,n}),mr=g(2,(e,t)=>Xt(e,{onFailure:n=>{if(Pv(n).length>0)return qe(s1(n));const s=t1(n);return s.length>0?t.onFailure(Aw(s)):qe(n)},onSuccess:t.onSuccess})),or=g(2,(e,t)=>G(()=>{const n=ye(e),r=wl(n.length);let s=0;return Et(um({while:()=>s<n.length,body:()=>t(n[s],s),step:i=>{r[s++]=i}}),r)})),Vl=g(2,(e,t)=>G(()=>{const n=ye(e);let r=0;return um({while:()=>r<n.length,body:()=>t(n[r],r),step:()=>{r++}})})),st=T(zl,e=>Kv(e)),Kv=e=>qe(ln(e)),cm=e=>{const t=new Ge(to);return t.effect_instruction_i0=Nx(Bs),t.effect_instruction_i1=()=>e,t},S1=g(2,(e,t)=>xn(n=>T(Vn(n(e)),r=>hA(t,r)))),W=g(2,(e,t)=>T(e,n=>I(()=>t(n)))),am=g(2,(e,t)=>mr(e,{onFailure:n=>ql(()=>t.onFailure(n)),onSuccess:n=>I(()=>t.onSuccess(n))})),Hl=g(2,(e,t)=>Xt(e,{onFailure:n=>{const r=$v(n);switch(r._tag){case"Left":return ql(()=>t(r.left));case"Right":return qe(r.right)}},onSuccess:x})),$s=g(2,(e,t)=>xn(n=>Xt(n(e),{onFailure:r=>{const s=pe(r);return Xt(t(s),{onFailure:i=>pe(ct(r,i)),onSuccess:()=>s})},onSuccess:r=>{const s=Ee(r);return He(t(s),s)}}))),Gc=g(2,(e,t)=>$s(e,Zl({onFailure:n=>Ul(n)?Zt(t(nm(n))):fe,onSuccess:()=>fe}))),qv=e=>w1(e,Z),w1=g(2,(e,t)=>mr(e,{onFailure:n=>Vi(t(n)),onSuccess:x})),x=e=>{const t=new Nv(nt);return t.effect_instruction_i0=e,t},G=e=>{const t=new Ge(Sl);return t.commit=e,t},I=e=>{const t=new Ge(gS);return t.effect_instruction_i0=e,t},Yc=g(e=>e.length===3||e.length===2&&!(qr(e[1])&&"onlyEffect"in e[1]),(e,t)=>T(e,n=>{const r=typeof t=="function"?t(n):t;return Yn(r)?Et(r,n):uS(r)?pc(s=>{r.then(i=>s(x(n)),i=>s(Fe(new dm(i,"An unknown error occurred in Effect.tap"))))}):x(n)})),v1=e=>oe(t=>{const n=t.getFiberRef(sd),r=p(n,Pe(()=>t.scope()));return e(Zc(sd,N(r)))}),qs=e=>{const t=new Ge(to);return t.effect_instruction_i0=bv(Bs),t.effect_instruction_i1=()=>e,t},xn=e=>Dv(e,function(){const t=new Ge(to);return t.effect_instruction_i0=bv(Bs),t.effect_instruction_i1=n=>gv(n)?Rt(()=>this.effect_instruction_i0(cm)):Rt(()=>this.effect_instruction_i0(qs)),t}),fe=x(void 0),E1=e=>{const t=new Ge(to);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},Wl=g(2,(e,t)=>T(t,n=>n?p(e,W(N)):x(A()))),um=e=>{const t=new Ge(ku);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},O1=e=>G(()=>{const t=new Ge(Go);return t.effect_instruction_i0=e(),t}),k1=function(){const e=arguments.length===1?arguments[0]:arguments[1].bind(arguments[0]);return O1(()=>e(p))},C1=g(2,(e,t)=>{const n=new Ge(to);return n.effect_instruction_i0=t,n.effect_instruction_i1=()=>e,n}),Jl=e=>{const t=new Ge(qa);return typeof e?.priority<"u"?z1(t,e.priority):t},zv=g(2,(e,t)=>T(e,n=>W(t,r=>[n,r]))),Ql=g(2,(e,t)=>T(e,n=>Et(t,n))),He=g(2,(e,t)=>T(e,()=>t)),Vv=g(3,(e,t,n)=>T(e,r=>W(t,s=>n(r,s)))),lm=e=>T(zl,t=>p(e,mc(t))),mc=g(2,(e,t)=>T(e.interruptAsFork(t),()=>e.await)),P1={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return B(this,arguments)}},R1={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return B(this,arguments)}},$1={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return B(this,arguments)}},T1={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return B(this,arguments)}},Hv={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return B(this,arguments)}},Wv={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return B(this,arguments)}},I1={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return B(this,arguments)}},F1={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return B(this,arguments)}},M1="effect/FiberRef",x1=Symbol.for(M1),A1={_A:e=>e},Gl=e=>oe(t=>Ee(t.getFiberRef(e))),Xc=g(2,(e,t)=>T(Gl(e),t)),Nu=g(2,(e,t)=>N1(e,()=>[void 0,t])),N1=g(2,(e,t)=>oe(n=>{const[r,s]=t(n.getFiberRef(e));return n.setFiberRef(e,s),x(r)})),Zc=g(3,(e,t,n)=>Lv(Ql(Gl(t),Nu(t,n)),()=>e,r=>Nu(t,r))),L1=g(3,(e,t,n)=>Xc(t,r=>Zc(e,t,n(r)))),gt=(e,t)=>fo(e,{differ:hv(),fork:t?.fork??Z,join:t?.join}),D1=e=>{const t=Sx();return fo(e,{differ:t,fork:t.empty})},j1=e=>{const t=wx(hv());return fo(e,{differ:t,fork:t.empty})},Jv=e=>{const t=_x();return fo(e,{differ:t,fork:t.empty})},fo=(e,t)=>({...no,[x1]:A1,initial:e,commit(){return Gl(this)},diff:(r,s)=>t.differ.diff(r,s),combine:(r,s)=>t.differ.combine(r,s),patch:r=>s=>t.differ.patch(r,s),fork:t.fork,join:t.join??((r,s)=>s)}),U1=e=>fo(e,{differ:Ny,fork:Ny.empty}),_r=ne(Symbol.for("effect/FiberRef/currentContext"),()=>Jv(Fi())),ho=ne(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>gt(0)),Qv=ne(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>gt(2048)),B1=ne(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>gt(Ll())),K1=ne(Symbol.for("effect/FiberRef/currentLogLevel"),()=>gt(Hv)),q1=ne(Symbol.for("effect/FiberRef/currentLogSpan"),()=>gt(Di())),z1=g(2,(e,t)=>Zc(e,ho,t)),V1=ne(Symbol.for("effect/FiberRef/currentConcurrency"),()=>gt("unbounded")),H1=ne(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>gt(!0)),W1=ne(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>gt(N(Wv))),rd=ne(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>j1(Fr())),sd=ne(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>gt(A(),{fork:()=>A(),join:(e,t)=>e})),$a=ne(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>gt(xr,{fork:()=>xr,join:(e,t)=>e})),J1=ne(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>gt(!0)),Gv=ne(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>gt(!0)),Q1=ne(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>gt(Ll())),G1=ne(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>gt(Oe())),Ky=Symbol.for("effect/Scope"),qy=Symbol.for("effect/CloseableScope"),Yv=(e,t)=>e.addFinalizer(()=>Zt(t)),Lu=(e,t)=>e.addFinalizer(t),id=(e,t)=>e.close(t),Yl=(e,t)=>e.fork(t),Y1=e=>X1(Z)(e),X1=g(2,(e,t)=>{const n=p(e,Rv,os(t));switch(n._tag){case"None":return p(Pv(e),Pl,we({onNone:()=>{const r=ye(nm(e)).flatMap(s=>ye(gM(s)).map(i=>`#${i}`));return new eA(r?`Interrupted by fibers: ${r.join(", ")}`:void 0)},onSome:Z}));case"Some":return n.value}}),fm=function(){class e extends globalThis.Error{commit(){return Fe(this)}toJSON(){const n={...this};return this.message&&(n.message=this.message),this.cause&&(n.cause=this.cause),n}[_e](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?zr(Ar(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,V$),e}(),Xl=(e,t)=>{class n extends fm{_tag=t}return Object.assign(n.prototype,e),n.prototype.name=t,n},zy=Symbol.for("effect/Cause/errors/RuntimeException"),Z1=Xl({[zy]:zy},"RuntimeException"),od=Symbol.for("effect/Cause/errors/InterruptedException"),eA=Xl({[od]:od},"InterruptedException"),tA=e=>z(e,od),Vy=Symbol.for("effect/Cause/errors/IllegalArgument"),nA=Xl({[Vy]:Vy},"IllegalArgumentException"),Hy=Symbol.for("effect/Cause/errors/NoSuchElement"),hm=Xl({[Hy]:Hy},"NoSuchElementException"),Wy=Symbol.for("effect/Cause/errors/UnknownException"),dm=function(){class e extends fm{_tag="UnknownException";error;constructor(n,r){super(r??"An unknown error occurred",{cause:n}),this.error=n}}return Object.assign(e.prototype,{[Wy]:Wy,name:"UnknownException"}),e}(),pm=e=>Yn(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),Xv=e=>e._tag==="Failure",rA=e=>e._tag==="Success",sA=g(2,(e,t)=>{switch(e._tag){case tt:return pe(e.effect_instruction_i0);case nt:return Ee(t)}}),Gf=e=>sA(e,void 0),_i=(e,t)=>lA(e,t?.parallel?Nr:ct),Zv=e=>pe(Wt(e)),cd=e=>pe(Ar(e)),pe=e=>{const t=new Av(tt);return t.effect_instruction_i0=e,t},iA=g(2,(e,t)=>{switch(e._tag){case tt:return pe(e.effect_instruction_i0);case nt:return t(e.effect_instruction_i0)}}),oA=e=>p(e,iA(Z)),e0=e=>pe(ln(e)),Qa=g(2,(e,t)=>{switch(e._tag){case tt:return pe(e.effect_instruction_i0);case nt:return Ee(t(e.effect_instruction_i0))}}),cA=g(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case tt:return pe(p(e.effect_instruction_i0,Tv(t)));case nt:return Ee(n(e.effect_instruction_i0))}}),Zl=g(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case tt:return t(e.effect_instruction_i0);case nt:return n(e.effect_instruction_i0)}}),ad=g(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case tt:return t(e.effect_instruction_i0);case nt:return n(e.effect_instruction_i0)}}),Ee=e=>{const t=new Nv(nt);return t.effect_instruction_i0=e,t},Bt=Ee(void 0),aA=g(2,(e,t)=>mm(e,t,{onSuccess:(n,r)=>[n,r],onFailure:ct})),uA=g(2,(e,t)=>mm(e,t,{onSuccess:(n,r)=>r,onFailure:ct})),mm=g(3,(e,t,{onFailure:n,onSuccess:r})=>{switch(e._tag){case tt:switch(t._tag){case nt:return pe(e.effect_instruction_i0);case tt:return pe(n(e.effect_instruction_i0,t.effect_instruction_i0))}case nt:switch(t._tag){case nt:return Ee(r(e.effect_instruction_i0,t.effect_instruction_i0));case tt:return pe(t.effect_instruction_i0)}}}),lA=(e,t)=>{const n=Mi(e);return Mn(n)?p(ir(n),$p(p(Bn(n),Qa(de)),(r,s)=>p(r,mm(s,{onSuccess:(i,o)=>p(i,mt(o)),onFailure:t}))),Qa(pr),Qa(r=>$n(r)),N):A()},ea=e=>({...no,[p1]:m1,state:js(g1([])),commit(){return Qn(this)},blockingOn:e}),ta=()=>T(zl,e=>fA(e)),fA=e=>I(()=>ea(e)),Qn=e=>im(t=>{const n=ae(e.state);switch(n._tag){case Kl:return t(n.effect);case Wc:return n.joiners.push(t),pA(e,t)}},e.blockingOn),ef=g(2,(e,t)=>I(()=>{const n=ae(e.state);switch(n._tag){case Kl:return!1;case Wc:{Us(e.state,Mv(t));for(let r=0,s=n.joiners.length;r<s;r++)n.joiners[r](t);return!0}}})),hA=g(2,(e,t)=>ef(e,t)),t0=g(2,(e,t)=>ef(e,qe(t))),gm=g(2,(e,t)=>ef(e,Kv(t))),dA=e=>I(()=>ae(e.state)._tag===Kl),na=g(2,(e,t)=>ef(e,x(t))),tf=(e,t)=>{const n=ae(e.state);if(n._tag===Wc){Us(e.state,Mv(t));for(let r=0,s=n.joiners.length;r<s;r++)n.joiners[r](t)}},pA=(e,t)=>I(()=>{const n=ae(e.state);if(n._tag===Wc){const r=n.joiners.indexOf(t);r>=0&&n.joiners.splice(r,1)}}),mA=oe(e=>Ee(e.currentContext)),n0=()=>mA,zs=e=>T(n0(),e),po=g(2,(e,t)=>Zc(_r,t)(e)),ym=g(2,(e,t)=>L1(_r,n=>io(n,t))(e)),gA=g(2,(e,t)=>zs(n=>po(e,t(n)))),bm=e=>{const t=e.currentSpan;return t!==void 0&&t._tag==="Span"?N(t):A()},yA={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:Bt},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},bA=e=>Object.assign(Object.create(yA),e),It=ta,Ue=Qn,r0=t0,ud=dA,hn=na,_m=Xv,Du=rA,_A=_i,SA=Zv,s0=cd,dn=pe,wA=oA,vA=Qa,EA=cA,Kn=Zl,fn=Ee,OA=Bt,Jy=aA,gc=uA,Qy=Symbol.for("effect/MutableHashMap"),kA={[Qy]:Qy,[Symbol.iterator](){return new Sm(this)},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(Ce)}},[_e](){return this.toJSON()},pipe(){return B(this,arguments)}};class Sm{self;referentialIterator;bucketIterator;constructor(t){this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();const t=this.referentialIterator.next();return t.done?(this.bucketIterator=new CA(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new Sm(this.self)}}class CA{backing;constructor(t){this.backing=t}currentBucket;next(){if(this.currentBucket===void 0){const n=this.backing.next();if(n.done)return n;this.currentBucket=n.value[Symbol.iterator]()}const t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}}const PA=()=>{const e=Object.create(kA);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},Hr=g(2,(e,t)=>{if(vu(t)===!1)return e.referential.has(t)?N(e.referential.get(t)):A();const n=t[ee](),r=e.buckets.get(n);return r===void 0?A():RA(e,r,t)}),RA=(e,t,n,r=!1)=>{for(let s=0,i=t.length;s<i;s++)if(n[X](t[s][0])){const o=t[s][1];return r&&(t.splice(s,1),e.bucketsSize--),N(o)}return A()},$o=g(2,(e,t)=>Be(Hr(e,t))),To=g(3,(e,t,n)=>{if(vu(t)===!1)return e.referential.set(t,n),e;const r=t[ee](),s=e.buckets.get(r);return s===void 0?(e.buckets.set(r,[[t,n]]),e.bucketsSize++,e):($A(e,s,t),s.push([t,n]),e.bucketsSize++,e)}),$A=(e,t,n)=>{for(let r=0,s=t.length;r<s;r++)if(n[X](t[r][0])){t.splice(r,1),e.bucketsSize--;return}},Gy=Symbol.for("effect/MutableList"),TA={[Gy]:Gy,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(t==null)return e=!0,this.return();const n=t.value;return t=t.next,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(Ce)}},[_e](){return this.toJSON()},pipe(){return B(this,arguments)}},IA=e=>({value:e,removed:!1,prev:void 0,next:void 0}),FA=()=>{const e=Object.create(TA);return e.head=void 0,e.tail=void 0,e._length=0,e},i0=e=>wm(e)===0,wm=e=>e._length,MA=g(2,(e,t)=>{const n=IA(t);return e.head===void 0&&(e.head=n),e.tail===void 0||(e.tail.next=n,n.prev=e.tail),e.tail=n,e._length+=1,e}),xA=e=>{const t=e.head;if(t!==void 0)return AA(e,t),t.value},AA=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))},Yy=Symbol.for("effect/MutableQueue"),Me=Symbol.for("effect/mutable/MutableQueue/Empty"),NA={[Yy]:Yy,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return Ke(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(Ce)}},[_e](){return this.toJSON()},pipe(){return B(this,arguments)}},o0=e=>{const t=Object.create(NA);return t.queue=FA(),t.capacity=e,t},vm=e=>o0(e),nf=()=>o0(void 0),Em=e=>wm(e.queue),fs=e=>i0(e.queue),LA=e=>e.capacity===void 0?1/0:e.capacity,Wi=g(2,(e,t)=>{const n=wm(e.queue);return e.capacity!==void 0&&n===e.capacity?!1:(MA(t)(e.queue),!0)}),Om=g(2,(e,t)=>{const n=t[Symbol.iterator]();let r,s=Oe(),i=!0;for(;i&&(r=n.next())&&!r.done;)i=Wi(r.value)(e);for(;r!=null&&!r.done;)s=mt(r.value)(s),r=n.next();return pr(s)}),lr=g(2,(e,t)=>i0(e.queue)?t:xA(e.queue)),rf=g(2,(e,t)=>{let n=Oe(),r=0;for(;r<t;){const s=lr(Me)(e);if(s===Me)break;n=mt(s)(n),r+=1}return pr(n)}),DA="effect/Clock",Xy=Symbol.for(DA),mo=Ds("effect/Clock"),jA=2**31-1,Zy={unsafeSchedule(e,t){const n=vs(t);if(n>jA)return _u;let r=!1;const s=setTimeout(()=>{r=!0,e()},n);return()=>(clearTimeout(s),!r)}},eb=function(){const e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t;return()=>(t===void 0&&(t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6))),t+BigInt(Math.round(performance.now()*1e6)))}(),UA=function(){const e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return eb;const t=eb()-e.bigint();return()=>t+e.bigint()}();class BA{[Xy]=Xy;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return UA()}currentTimeMillis=I(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=I(()=>this.unsafeCurrentTimeNanos());scheduler(){return x(Zy)}sleep(t){return Lr(n=>{const r=Zy.unsafeSchedule(()=>n(fe),t);return Zt(I(r))})}}const KA=()=>new BA,c0="And",a0="Or",u0="InvalidData",l0="MissingData",f0="SourceUnavailable",h0="Unsupported",qA="effect/ConfigError",tb=Symbol.for(qA),go={_tag:"ConfigError",[tb]:tb},d0=(e,t)=>{const n=Object.create(go);return n._op=c0,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},p0=(e,t)=>{const n=Object.create(go);return n._op=a0,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},zA=(e,t,n={pathDelim:"."})=>{const r=Object.create(go);return r._op=u0,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Invalid data at ${p(this.path,Ns(n.pathDelim))}: "${this.message}")`}}),r},Ts=(e,t,n={pathDelim:"."})=>{const r=Object.create(go);return r._op=l0,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Missing data at ${p(this.path,Ns(n.pathDelim))}: "${this.message}")`}}),r},VA=(e,t,n,r={pathDelim:"."})=>{const s=Object.create(go);return s._op=f0,s.path=e,s.message=t,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){return`(Source unavailable at ${p(this.path,Ns(r.pathDelim))}: "${this.message}")`}}),s},HA=(e,t,n={pathDelim:"."})=>{const r=Object.create(go);return r._op=h0,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${p(this.path,Ns(n.pathDelim))}: "${this.message}")`}}),r},Zr=g(2,(e,t)=>{switch(e._op){case c0:return d0(Zr(e.left,t),Zr(e.right,t));case a0:return p0(Zr(e.left,t),Zr(e.right,t));case u0:return zA([...t,...e.path],e.message);case l0:return Ts([...t,...e.path],e.message);case f0:return VA([...t,...e.path],e.message,e.cause);case h0:return HA([...t,...e.path],e.message)}}),WA={_tag:"Empty"},Yf=g(2,(e,t)=>{let n=Xp(t),r=e;for(;Yp(n);){const s=n.head;switch(s._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=Ps(s.first,Ps(s.second,n.tail));break}case"MapName":{r=cs(r,s.f),n=n.tail;break}case"Nested":{r=Cu(r,s.name),n=n.tail;break}case"Unnested":{if(p(Yo(r),dT(s.name)))r=_s(r),n=n.tail;else return V(Ts(r,`Expected ${s.name} to be in path in ConfigProvider#unnested`));break}}}return Y(r)}),JA="Constant",QA="Fail",GA="Fallback",YA="Described",XA="Lazy",ZA="MapOrFail",eN="Nested",tN="Primitive",nN="Sequence",rN="HashMap",sN="ZipWith";var nb={};const ju=(e,t)=>[...e,...t],iN="effect/ConfigProvider",rb=Symbol.for(iN),oN=Ds("effect/ConfigProvider"),cN="effect/ConfigProviderFlat",sb=Symbol.for(cN),aN=e=>({[rb]:rb,pipe(){return B(this,arguments)},...e}),uN=e=>({[sb]:sb,patch:e.patch,load:(t,n,r=!0)=>e.load(t,n,r),enumerateChildren:e.enumerateChildren}),lN=e=>aN({load:t=>T(tn(e,Fr(),t,!1),n=>we(Yo(n),{onNone:()=>Fe(Ts(Fr(),`Expected a single value having structure: ${t}`)),onSome:x})),flattened:e}),fN=e=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),r=a=>p(a,Ns(t)),s=a=>a.split(t),i=()=>typeof process<"u"&&"env"in process&&typeof nb=="object"?nb:{};return lN(uN({load:(a,u,l=!0)=>{const f=r(a),h=i(),d=f in h?N(h[f]):A();return p(d,Hl(()=>Ts(a,`Expected ${f} to exist in the process context`)),T(m=>gN(m,a,u,n,l)))},enumerateChildren:a=>I(()=>{const u=i(),h=Object.keys(u).map(d=>s(d.toUpperCase())).filter(d=>{for(let m=0;m<a.length;m++){const y=p(a,AS(m)),b=d[m];if(b===void 0||y!==b)return!1}return!0}).flatMap(d=>d.slice(a.length,a.length+1));return sM(h)}),patch:WA}))},hN=(e,t,n,r)=>{const s=yy(n.length,a=>a>=r.length?A():N([e(a),a+1])),i=yy(r.length,a=>a>=n.length?A():N([t(a),a+1])),o=ju(n,s),c=ju(r,i);return[o,c]},dN=(e,t)=>{let n=t;if(n._tag==="Nested"){const r=e.slice();for(;n._tag==="Nested";)r.push(n.name),n=n.config;return r}return e},tn=(e,t,n,r)=>{const s=n;switch(s._tag){case JA:return x(vn(s.value));case YA:return G(()=>tn(e,t,s.config,r));case QA:return Fe(Ts(t,s.message));case GA:return p(G(()=>tn(e,t,s.first,r)),zi(i=>s.condition(i)?p(tn(e,t,s.second,r),zi(o=>Fe(p0(i,o)))):Fe(i)));case XA:return G(()=>tn(e,t,s.config(),r));case ZA:return G(()=>p(tn(e,t,s.original,r),T(or(i=>p(s.mapOrFail(i),Hl(Zr(dN(t,s.original))))))));case eN:return G(()=>tn(e,ju(t,vn(s.name)),s.config,r));case tN:return p(Yf(t,e.patch),T(i=>p(e.load(i,s,r),T(o=>{if(o.length===0){const c=p(ET(i),Pe(()=>"<n/a>"));return Fe(Ts([],`Expected ${s.description} with name ${c}`))}return x(o)}))));case nN:return p(Yf(t,e.patch),T(i=>p(e.enumerateChildren(i),T(bN),T(o=>o.length===0?G(()=>W(tn(e,t,s.config,!0),vn)):p(or(o,c=>tn(e,yT(t,`[${c}]`),s.config,!0)),W(c=>{const a=IT(c);return a.length===0?vn(Fr()):vn(a)}))))));case rN:return G(()=>p(Yf(t,e.patch),T(i=>p(e.enumerateChildren(i),T(o=>p(o,or(c=>tn(e,ju(i,vn(c)),s.valueConfig,r)),W(c=>c.length===0?vn(Ll()):p(yN(c),cs(a=>bM(gy(ye(o),a)))))))))));case sN:return G(()=>p(tn(e,t,s.left,r),Hi,T(i=>p(tn(e,t,s.right,r),Hi,T(o=>{if(ft(i)&&ft(o))return Fe(d0(i.left,o.left));if(ft(i)&&sr(o))return Fe(i.left);if(sr(i)&&ft(o))return Fe(o.left);if(sr(i)&&sr(o)){const c=p(t,Ns(".")),a=pN(t,c),[u,l]=hN(a,a,p(i.right,cs(Y)),p(o.right,cs(Y)));return p(u,gy(l),or(([f,h])=>p(zv(f,h),W(([d,m])=>s.zip(d,m)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},pN=(e,t)=>n=>V(Ts(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),mN=(e,t)=>e.split(new RegExp(`\\s*${Pu(t)}\\s*`)),gN=(e,t,n,r,s)=>s?p(mN(e,r),or(i=>n.parse(i.trim())),Hl(Zr(t))):p(n.parse(e),am({onFailure:Zr(t),onSuccess:vn})),yN=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),bN=e=>p(or(e,SN),am({onFailure:()=>Fr(),onSuccess:oc(Ti)}),Hi,W(sT)),_N=/^(\[(\d+)\])$/,SN=e=>{const t=e.match(_N);if(t!==null){const n=t[2];return p(n!==void 0&&n.length>0?N(n):A(),jc(wN))}return A()},wN=e=>{const t=Number.parseInt(e);return Number.isNaN(t)?A():N(t)},ib=Symbol.for("effect/Console"),sf=Ds("effect/Console"),vN={[ib]:ib,assert(e,...t){return I(()=>{console.assert(e,...t)})},clear:I(()=>{console.clear()}),count(e){return I(()=>{console.count(e)})},countReset(e){return I(()=>{console.countReset(e)})},debug(...e){return I(()=>{console.debug(...e)})},dir(e,t){return I(()=>{console.dir(e,t)})},dirxml(...e){return I(()=>{console.dirxml(...e)})},error(...e){return I(()=>{console.error(...e)})},group(e){return e?.collapsed?I(()=>console.groupCollapsed(e?.label)):I(()=>console.group(e?.label))},groupEnd:I(()=>{console.groupEnd()}),info(...e){return I(()=>{console.info(...e)})},log(...e){return I(()=>{console.log(...e)})},table(e,t){return I(()=>{console.table(e,t)})},time(e){return I(()=>console.time(e))},timeEnd(e){return I(()=>console.timeEnd(e))},timeLog(e,...t){return I(()=>{console.timeLog(e,...t)})},trace(...e){return I(()=>{console.trace(...e)})},warn(...e){return I(()=>{console.warn(...e)})},unsafe:console},EN="effect/Random",ob=Symbol.for(EN),m0=Ds("effect/Random");class ON{seed;[ob]=ob;PRNG;constructor(t){this.seed=t,this.PRNG=new T$(t)}get next(){return I(()=>this.PRNG.number())}get nextBoolean(){return W(this.next,t=>t>.5)}get nextInt(){return I(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,n){return W(this.next,r=>(n-t)*r+t)}nextIntBetween(t,n){return I(()=>this.PRNG.integer(n-t)+t)}shuffle(t){return kN(t,n=>this.nextIntBetween(0,n))}}const kN=(e,t)=>G(()=>p(I(()=>Array.from(e)),T(n=>{const r=[];for(let s=n.length;s>=2;s=s-1)r.push(s);return p(r,Vl(s=>p(t(s),W(i=>CN(n,s-1,i)))),Et(Mi(n)))}))),CN=(e,t,n)=>{const r=e[t];return e[t]=e[n],e[n]=r,e},PN=e=>new ON(K(e)),cb=Symbol.for("effect/Tracer"),RN=e=>({[cb]:cb,...e}),km=Ds("effect/Tracer"),of=Ds("effect/ParentSpan"),ab=function(){const e="abcdef0123456789",t=e.length;return function(n){let r="";for(let s=0;s<n;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}}();class $N{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(t,n,r,s,i,o){this.name=t,this.parent=n,this.context=r,this.startTime=i,this.kind=o,this.status={_tag:"Started",startTime:i},this.attributes=new Map,this.traceId=n._tag==="Some"?n.value.traceId:ab(32),this.spanId=ab(16),this.links=Array.from(s)}end(t,n){this.status={_tag:"Ended",endTime:t,exit:n,startTime:this.status.startTime}}attribute(t,n){this.attributes.set(t,n)}event(t,n,r){this.events.push([t,n,r??{}])}addLinks(t){this.links.push(...t)}}const TN=RN({span:(e,t,n,r,s,i)=>new $N(e,t,n,r,s,i),context:e=>e()}),g0=e=>{if(e?.captureStackTrace===!1)return e;if(e?.captureStackTrace!==void 0&&typeof e.captureStackTrace!="boolean")return e;const t=Error.stackTraceLimit;Error.stackTraceLimit=3;const n=new Error;Error.stackTraceLimit=t;let r=!1;return{...e,captureStackTrace:()=>{if(r!==!1)return r;if(n.stack!==void 0){const s=n.stack.split(`
`);if(s[3]!==void 0)return r=s[3].trim(),r}}}},ld=Kc()("effect/Tracer/DisablePropagation",{defaultValue:_u}),IN=p(Fi(),Or(mo,KA()),Or(sf,vN),Or(m0,PN(Math.random())),Or(oN,fN()),Or(km,TN)),Dr=ne(Symbol.for("effect/DefaultServices/currentServices"),()=>Jv(IN)),FN=e=>{const t=Yt(e);return b0(n=>n.sleep(t))},y0=e=>oe(t=>e(t.currentDefaultServices)),b0=e=>y0(t=>e(t.unsafeMap.get(mo.key))),MN=b0(e=>e.currentTimeMillis),xN=e=>y0(t=>e(t.unsafeMap.get(m0.key))),AN=(e,t)=>xN(n=>n.nextRange(e,t)),NN=FN,LN=MN,DN=mo;function jN(e){return new jr(e)}function UN(){return jN(new Map)}const ub=Symbol.for("effect/FiberRefs");class jr{locals;[ub]=ub;constructor(t){this.locals=t}pipe(){return B(this,arguments)}}const BN=(e,t,n,r=!1)=>{const s=e;let i=t,o=n,c=r,a;for(;a===void 0;)if(pt(i)&&pt(o)){const u=Ft(i)[0],l=_s(i),f=Ft(o)[0],h=Ft(o)[1],d=_s(o);u.startTimeMillis<f.startTimeMillis?(o=d,c=!0):u.startTimeMillis>f.startTimeMillis?i=l:u.id<f.id?(o=d,c=!0):u.id>f.id?i=l:a=[h,c]}else a=[s.initial,!0];return a},KN=g(3,(e,t,n)=>{const r=new Map(e.locals);return n.locals.forEach((s,i)=>{const o=s[0][1];if(!s[0][0][X](t)){if(!r.has(i)){if(J(o,i.initial))return;r.set(i,[[t,i.join(i.initial,o)]]);return}const c=r.get(i),[a,u]=BN(i,c,s);if(u){const l=i.diff(a,o),f=c[0][1],h=i.join(f,i.patch(l)(f));if(!J(f,h)){let d;const m=c[0][0];m[X](t)?d=[[m,h],...c.slice(1)]:d=[[t,h],...c],r.set(i,d)}}}}),new jr(r)}),qN=g(2,(e,t)=>{const n=new Map;return _0(e,n,t),new jr(n)}),_0=(e,t,n)=>{e.locals.forEach((r,s)=>{const i=r[0][1],o=s.patch(s.fork)(i);J(i,o)?t.set(s,r):t.set(s,[[n,o],...r])})},S0=g(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new jr(n)}),w0=g(2,(e,t)=>e.locals.has(t)?N(Ft(e.locals.get(t))[1]):A()),yc=g(2,(e,t)=>p(w0(e,t),Pe(()=>t.initial))),fd=g(2,(e,{fiberId:t,fiberRef:n,value:r})=>{if(e.locals.size===0)return new jr(new Map([[n,[[t,r]]]]));const s=new Map(e.locals);return hd(s,t,n,r),new jr(s)}),hd=(e,t,n,r)=>{const s=e.get(n)??[];let i;if(pt(s)){const[o,c]=Ft(s);if(o[X](t)){if(J(c,r))return;i=[[t,r],...s.slice(1)]}else i=[[t,r],...s]}else i=[[t,r]];e.set(n,i)},zN=g(2,(e,{entries:t,forkAs:n})=>{if(e.locals.size===0)return new jr(new Map(t));const r=new Map(e.locals);return n!==void 0&&_0(e,r,n),t.forEach(([s,i])=>{i.length===1?hd(r,i[0][0],s,i[0][1]):i.forEach(([o,c])=>{hd(r,o,s,c)})}),new jr(r)}),lb=w0,Cm=yc,VN=zN,HN=UN,WN=P1,JN=R1,v0=$1,QN=T1,GN=Hv,YN=Wv,XN=I1,ZN=F1,eL=p(Ti,IS(e=>e.ordinal)),tL=cT(eL),nL=e=>{switch(e){case"All":return WN;case"Debug":return YN;case"Error":return v0;case"Fatal":return JN;case"Info":return GN;case"Trace":return XN;case"None":return ZN;case"Warning":return QN}},E0=e=>e.replace(/[\s="]/g,"_"),Pm=e=>t=>`${E0(t.label)}=${e-t.startTime}ms`,rL=Lc,sL=no,iL=H$;class Vs extends iL{}const Ji=Symbol.for("effect/Readable"),Rm=Symbol.for("effect/Ref"),$m={_A:e=>e};class oL extends Vs{ref;commit(){return this.get}[Rm]=$m;[Ji]=Ji;constructor(t){super(),this.ref=t,this.get=I(()=>ae(this.ref))}get;modify(t){return I(()=>{const n=ae(this.ref),[r,s]=t(n);return n!==s&&Us(s)(this.ref),r})}}const Tm=e=>new oL(js(e)),Uu=e=>I(()=>Tm(e)),pn=e=>e.get,Si=g(2,(e,t)=>e.modify(()=>[void 0,t])),cL=g(2,(e,t)=>e.modify(n=>[n,t])),O0=g(2,(e,t)=>e.modify(t)),Bu=g(2,(e,t)=>e.modify(n=>[void 0,t(n)])),aL=Rm,Cr=Uu,Un=pn,uL=cL,Jr=O0,nn=Si,k0=Bu,C0="Empty",P0="Add",R0="Remove",$0="Update",T0="AndThen",lL={_tag:C0},I0=(e,t)=>{const n=new Map(e.locals);let r=lL;for(const[s,i]of t.locals.entries()){const o=Ft(i)[1],c=n.get(s);if(c!==void 0){const a=Ft(c)[1];J(a,o)||(r=Xf({_tag:$0,fiberRef:s,patch:s.diff(a,o)})(r))}else r=Xf({_tag:P0,fiberRef:s,value:o})(r);n.delete(s)}for(const[s]of n.entries())r=Xf({_tag:R0,fiberRef:s})(r);return r},Xf=g(2,(e,t)=>({_tag:T0,first:e,second:t})),F0=g(3,(e,t,n)=>{let r=n,s=vn(e);for(;pt(s);){const i=Ft(s),o=_s(s);switch(i._tag){case C0:{s=o;break}case P0:{r=fd(r,{fiberId:t,fiberRef:i.fiberRef,value:i.value}),s=o;break}case R0:{r=S0(r,i.fiberRef),s=o;break}case $0:{const c=yc(r,i.fiberRef);r=fd(r,{fiberId:t,fiberRef:i.fiberRef,value:i.fiberRef.patch(i.patch)(c)}),s=o;break}case T0:{s=Cu(i.first)(Cu(i.second)(o));break}}}return r}),M0="effect/MetricLabel",dd=Symbol.for(M0);class fL{key;value;[dd]=dd;_hash;constructor(t,n){this.key=t,this.value=n,this._hash=je(M0+this.key+this.value)}[ee](){return this._hash}[X](t){return dL(t)&&this.key===t.key&&this.value===t.value}pipe(){return B(this,arguments)}}const hL=(e,t)=>new fL(e,t),dL=e=>z(e,dd),pL=e=>W(e,N),mL=g(2,(e,t)=>Xt(e,{onFailure:n=>{const r=t(n);switch(r._tag){case"None":return qe(n);case"Some":return r.value}},onSuccess:x})),gL=e=>kL(e,bL,I0),x0=g(2,(e,t)=>mr(e,{onFailure:n=>x(t.onFailure(n)),onSuccess:n=>x(t.onSuccess(n))})),yL=e=>{const t=T(T(e,()=>Jl()),()=>t);return t},bL=oe(e=>x(e.getFiberRefs())),_L=e=>x0(e,{onFailure:Su,onSuccess:Su}),A0=e=>(...t)=>{const n=Dc(e);let r;for(let s=0,i=t.length;s<i;s++){const o=t[s];Ov(o)&&(r!==void 0?r=ct(r,o):r=o,t=[...t.slice(0,s),...t.slice(s+1)],s--)}return r===void 0&&(r=xr),oe(s=>(s.log(t,r,n),fe))},SL=A0(),wL=A0(v0),fb=g(2,(e,t)=>Xt(e,{onFailure:n=>Uv(()=>t(n)),onSuccess:x})),vL=e=>W(e,t=>!t),EL=e=>RL((t,n)=>p(e,F0(t,n))),N0=g(3,(e,t,n)=>zs(r=>po(e,Or(r,t,n)))),Ku=g(3,(e,t,n)=>zs(r=>T(n,s=>po(e,p(r,Or(t,s)))))),L0=NN,OL=x(A()),kL=g(3,(e,t,n)=>T(t,r=>T(e,s=>W(t,i=>[n(r,i),s])))),CL=g(2,(e,t)=>Xt(e,{onFailure:n=>He(t(n),qe(n)),onSuccess:x})),PL=e=>{let t,n;typeof e=="function"?t=e:(t=e.try,n=e.catch);const r=s=>n?ql(()=>n(s)):Fe(new dm(s,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?Lr((s,i)=>{try{t(i).then(o=>s(Ee(o)),o=>s(r(o)))}catch(o){s(r(o))}}):Lr(s=>{try{t().then(i=>s(Ee(i)),i=>s(r(i)))}catch(i){s(r(i))}})},RL=e=>oe(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),fe)),$L=g(2,(e,t)=>G(()=>t()?W(e,N):x(A()))),D0=BigInt(0),j0=jc(e=>ar(e.context,ld)?e._tag==="Span"?j0(e.parent):A():N(e)),TL=(e,t,n)=>{const r=!e.getFiberRef(J1)||n.context&&ar(n.context,ld),s=e.getFiberRef(_r),i=n.parent?N(n.parent):n.root?A():j0(so(s,of));let o;if(r)o=bA({name:t,parent:i,context:Or(n.context??Fi(),ld,!0)});else{const c=e.getFiberRef(Dr),a=ar(c,km),u=ar(c,DN),l=e.getFiberRef(Gv),f=e.getFiberRefs(),h=lb(f,Q1),d=lb(f,G1),m=d._tag==="Some"?n.links!==void 0?[...$n(d.value),...n.links??[]]:$n(d.value):n.links??Fr();o=a.span(t,i,n.context??Fi(),m,l?u.unsafeCurrentTimeNanos():D0,n.kind??"internal"),h._tag==="Some"&&vM(h.value,(y,b)=>o.attribute(b,y)),n.attributes!==void 0&&Object.entries(n.attributes).forEach(([y,b])=>o.attribute(y,b))}return typeof n.captureStackTrace=="function"&&Au.set(o,n.captureStackTrace),o},IL=(e,t,n,r)=>I(()=>{e.status._tag!=="Ended"&&(Xv(t)&&Au.has(e)&&e.attribute("code.stacktrace",Au.get(e)()),e.end(r?n.unsafeCurrentTimeNanos():D0,t))}),hb=(e,...t)=>{const n=g0(t.length===1?void 0:t[0]),r=t[t.length-1];return oe(s=>{const i=TL(s,e,n),o=s.getFiberRef(Gv),c=ar(s.getFiberRef(Dr),mo);return $s(r(i),a=>IL(i,a,c,o))})},db=g(2,(e,t)=>N0(e,of,t)),FL=function(){const e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],n=g0(e?arguments[2]:arguments[1]);if(e){const r=arguments[0];return hb(t,n,s=>db(r,s))}return r=>hb(t,n,s=>db(r,s))},U0="Sequential",B0="Parallel",ML="ParallelN",ra={_tag:U0},xL={_tag:B0},AL=e=>({_tag:ML,parallelism:e}),NL=e=>e._tag===U0,LL=e=>e._tag===B0,qu=ra,pd=xL,md=AL,bc=I0,_c=F0,cf="effect/FiberStatus",Is=Symbol.for(cf),zu="Done",pb="Running",mb="Suspended",DL=je(`${cf}-${zu}`);let jL=class{[Is]=Is;_tag=zu;[ee](){return DL}[X](t){return Im(t)&&t._tag===zu}};class UL{runtimeFlags;[Is]=Is;_tag=pb;constructor(t){this.runtimeFlags=t}[ee](){return p(K(cf),ie(K(this._tag)),ie(K(this.runtimeFlags)),ke(this))}[X](t){return Im(t)&&t._tag===pb&&this.runtimeFlags===t.runtimeFlags}}class BL{runtimeFlags;blockingOn;[Is]=Is;_tag=mb;constructor(t,n){this.runtimeFlags=t,this.blockingOn=n}[ee](){return p(K(cf),ie(K(this._tag)),ie(K(this.runtimeFlags)),ie(K(this.blockingOn)),ke(this))}[X](t){return Im(t)&&t._tag===mb&&this.runtimeFlags===t.runtimeFlags&&J(this.blockingOn,t.blockingOn)}}const KL=new jL,qL=e=>new UL(e),zL=(e,t)=>new BL(e,t),Im=e=>z(e,Is),VL=e=>e._tag===zu,HL=KL,K0=qL,WL=zL,JL=VL,QL=Symbol.for("effect/Micro"),Vu=Symbol.for("effect/Micro/MicroExit"),gb=Symbol.for("effect/Micro/MicroCause"),GL={_E:Z};class q0 extends globalThis.Error{_tag;traces;[gb];constructor(t,n,r){const s=`MicroCause.${t}`;let i,o,c;if(n instanceof globalThis.Error){i=`(${s}) ${n.name}`,o=n.message;const a=o.split(`
`).length;c=n.stack?`(${s}) ${n.stack.split(`
`).slice(0,a+3).join(`
`)}`:`${i}: ${o}`}else i=s,o=Ri(n,0),c=`${i}: ${o}`;r.length>0&&(c+=`
    ${r.join(`
    `)}`),super(o),this._tag=t,this.traces=r,this[gb]=GL,this.name=i,this.stack=c}pipe(){return B(this,arguments)}toString(){return this.stack}[_e](){return this.stack}}class YL extends q0{defect;constructor(t,n=[]){super("Die",t,n),this.defect=t}}const XL=(e,t=[])=>new YL(e,t);class ZL extends q0{constructor(t=[]){super("Interrupt","interrupted",t)}}const eD=(e=[])=>new ZL(e),tD=e=>e._tag==="Interrupt",yb=Symbol.for("effect/Micro/MicroFiber"),nD={_A:Z,_E:Z};class rD{context;interruptible;[yb];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(t,n=!0){this.context=t,this.interruptible=n,this[yb]=nD}getRef(t){return BI(this.context,t)}addObserver(t){return this._exit?(t(this._exit),Su):(this._observers.push(t),()=>{const n=this._observers.indexOf(t);n>=0&&this._observers.splice(n,1)})}_interrupted=!1;unsafeInterrupt(){this._exit||(this._interrupted=!0,this.interruptible&&this.evaluate(Nm))}unsafePoll(){return this._exit}evaluate(t){if(this._exit)return;if(this._yielded!==void 0){const s=this._yielded;this._yielded=void 0,s()}const n=this.runLoop(t);if(n===Ta)return;const r=bb.interruptChildren&&bb.interruptChildren(this);if(r!==void 0)return this.evaluate(Wu(r,()=>n));this._exit=n;for(let s=0;s<this._observers.length;s++)this._observers[s](n);this._observers.length=0}runLoop(t){let n=!1,r=t;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!n&&this.getRef(Lm).shouldYield(this)){n=!0;const s=r;r=Wu(aD,()=>s)}if(r=r[gd](this),r===Ta){const s=this._yielded;return Vu in s?(this._yielded=void 0,s):Ta}}}catch(s){return z(r,gd)?yd(s):yd(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`)}}getCont(t){for(;;){const n=this._stack.pop();if(!n)return;const r=n[Hu]&&n[Hu](this);if(r)return{[t]:r};if(n[t])return n}}_yielded=void 0;yieldWith(t){return this._yielded=t,Ta}children(){return this._children??=new Set}}const bb=ne("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),z0=Symbol.for("effect/Micro/identifier"),Xe=Symbol.for("effect/Micro/args"),gd=Symbol.for("effect/Micro/evaluate"),Qi=Symbol.for("effect/Micro/successCont"),wi=Symbol.for("effect/Micro/failureCont"),Hu=Symbol.for("effect/Micro/ensureCont"),Ta=Symbol.for("effect/Micro/Yield"),sD={_A:Z,_E:Z,_R:Z},iD={...rL,_op:"Micro",[QL]:sD,pipe(){return B(this,arguments)},[Symbol.iterator](){return new lS(new xc(this))},toJSON(){return{_id:"Micro",op:this[z0],...Xe in this?{args:this[Xe]}:void 0}},toString(){return Ke(this)},[_e](){return Ke(this)}};function oD(e){return yd("Micro.evaluate: Not implemented")}const af=e=>({...iD,[z0]:e.op,[gd]:e.eval??oD,[Qi]:e.contA,[wi]:e.contE,[Hu]:e.ensure}),Fm=e=>{const t=af(e);return function(){const n=Object.create(t);return n[Xe]=e.single===!1?arguments:arguments[0],n}},V0=e=>{const t={...af(e),[Vu]:Vu,_tag:e.op,get[e.prop](){return this[Xe]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[Xe]}},[X](n){return fD(n)&&n._tag===e.op&&J(this[Xe],n[Xe])},[ee](){return ke(this,ie(je(e.op))(K(this[Xe])))}};return function(n){const r=Object.create(t);return r[Xe]=n,r[Qi]=void 0,r[wi]=void 0,r[Hu]=void 0,r}},Mm=V0({op:"Success",prop:"value",eval(e){const t=e.getCont(Qi);return t?t[Qi](this[Xe],e):e.yieldWith(this)}}),H0=V0({op:"Failure",prop:"cause",eval(e){let t=e.getCont(wi);for(;tD(this[Xe])&&t&&e.interruptible;)t=e.getCont(wi);return t?t[wi](this[Xe],e):e.yieldWith(this)}}),cD=Fm({op:"Yield",eval(e){let t=!1;return e.getRef(Lm).scheduleTask(()=>{t||e.evaluate(hD)},this[Xe]??0),e.yieldWith(()=>{t=!0})}}),aD=cD(0),uD=Mm(void 0),xm=Fm({op:"WithMicroFiber",eval(e){return this[Xe](e)}}),Wu=g(2,(e,t)=>{const n=Object.create(lD);return n[Xe]=e,n[Qi]=t,n}),lD=af({op:"OnSuccess",eval(e){return e._stack.push(this),this[Xe]}}),fD=e=>z(e,Vu),W0=Mm,Am=H0,Nm=Am(eD()),yd=e=>Am(XL(e)),hD=W0(void 0),dD="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class J0{tasks=[];running=!1;scheduleTask(t,n){this.tasks.push(t),this.running||(this.running=!0,dD(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){const t=this.tasks;this.tasks=[];for(let n=0,r=t.length;n<r;n++)t[n]()}shouldYield(t){return t.currentOpCount>=t.getRef(gD)}flush(){for(;this.tasks.length>0;)this.runTasks()}}const pD=g(2,(e,t)=>xm(n=>{const r=n.context;return n.context=t(r),_D(e,()=>(n.context=r,uD))})),mD=g(2,(e,t)=>pD(e,io(t)));class gD extends Kc()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class Lm extends Kc()("effect/Micro/currentScheduler",{defaultValue:()=>new J0}){}const yD=g(2,(e,t)=>{const n=Object.create(bD);return n[Xe]=e,n[Qi]=t.onSuccess,n[wi]=t.onFailure,n}),bD=af({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[Xe]}}),_D=g(2,(e,t)=>wD(n=>yD(n(e),{onFailure:r=>Wu(t(Am(r)),()=>H0(r)),onSuccess:r=>Wu(t(W0(r)),()=>Mm(r))}))),Q0=Fm({op:"SetInterruptible",ensure(e){if(e.interruptible=this[Xe],e._interrupted&&e.interruptible)return()=>Nm}}),SD=e=>xm(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(Q0(!1)),t._interrupted?Nm:e)),wD=e=>xm(t=>t.interruptible?(t.interruptible=!1,t._stack.push(Q0(!0)),e(SD)):e(Z)),vD=(e,t)=>{const n=new rD(Lm.context(new J0));return n.evaluate(e),n};class G0{buckets=[];scheduleTask(t,n){const r=this.buckets.length;let s,i=0;for(;i<r&&this.buckets[i][0]<=n;i++)s=this.buckets[i];s&&s[0]===n?s[1].push(t):i===r?this.buckets.push([n,[t]]):this.buckets.splice(i,0,[n,[t]])}}class ED{maxNextTickBeforeTimer;running=!1;tasks=new G0;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){const n=this.tasks.buckets;this.tasks.buckets=[];for(const[r,s]of n)for(let i=0;i<s.length;i++)s[i]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(Qv)?t.getFiberRef(ho):!1}scheduleTask(t,n){this.tasks.scheduleTask(t,n),this.running||(this.running=!0,this.starve())}}const Y0=ne(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new ED(2048));class X0{tasks=new G0;deferred=!1;scheduleTask(t,n){this.deferred?Y0.scheduleTask(t,n):this.tasks.scheduleTask(t,n)}shouldYield(t){return t.currentOpCount>t.getFiberRef(Qv)?t.getFiberRef(ho):!1}flush(){for(;this.tasks.buckets.length>0;){const t=this.tasks.buckets;this.tasks.buckets=[];for(const[n,r]of t)for(let s=0;s<r.length;s++)r[s]()}this.deferred=!0}}const Dm=ne(Symbol.for("effect/FiberRef/currentScheduler"),()=>gt(Y0)),Z0=ne(Symbol.for("effect/FiberRef/currentRequestMap"),()=>gt(new Map)),_b=(e,t,n,r)=>{switch(e){case void 0:return t();case"unbounded":return n();case"inherit":return Xc(V1,s=>s==="unbounded"?n():s>1?r(s):t());default:return e>1?r(e):t()}},jm="InterruptSignal",Um="Stateful",Bm="Resume",Km="YieldNow",Zf=e=>({_tag:jm,cause:e}),Ga=e=>({_tag:Um,onFiber:e}),Gs=e=>({_tag:Bm,effect:e}),OD=()=>({_tag:Km}),kD="effect/FiberScope",Ju=Symbol.for(kD);class CD{[Ju]=Ju;fiberId=Cs;roots=new Set;add(t,n){this.roots.add(n),n.addObserver(()=>{this.roots.delete(n)})}}class PD{fiberId;parent;[Ju]=Ju;constructor(t,n){this.fiberId=t,this.parent=n}add(t,n){this.parent.tell(Ga(r=>{r.addChild(n),n.addObserver(()=>{r.removeChild(n)})}))}}const RD=e=>new PD(e.id(),e),uf=ne(Symbol.for("effect/FiberScope/Global"),()=>new CD),$D="effect/Fiber",TD=Symbol.for($D),ID={_E:e=>e,_A:e=>e},FD="effect/Fiber",MD=Symbol.for(FD),xD=e=>e.await,AD=e=>e.inheritAll,Sc=e=>Ql(lo(e.await),e.inheritAll);({...no});const Vr="effect/FiberCurrent",ND="effect/Logger",LD=Symbol.for(ND),DD={_Message:e=>e,_Output:e=>e},sa=e=>({[LD]:DD,log:e,pipe(){return B(this,arguments)}}),jD=/^[^\s"=]*$/,UD=(e,t)=>({annotations:n,cause:r,date:s,fiberId:i,logLevel:o,message:c,spans:a})=>{const u=m=>m.match(jD)?m:e(m),l=(m,y)=>`${E0(m)}=${u(y)}`,f=(m,y)=>" "+l(m,y);let h=l("timestamp",s.toISOString());h+=f("level",o.label),h+=f("fiber",Nl(i));const d=Rp(c);for(let m=0;m<d.length;m++)h+=f("message",Ri(d[m],t));Zx(r)||(h+=f("cause",zr(r,{renderErrorCause:!0})));for(const m of a)h+=" "+Pm(s.getTime())(m);for(const[m,y]of n)h+=f(m,Ri(y,t));return h},BD=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,KD=sa(UD(BD)),eE=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return Ce(e)}},qD=(e,...t)=>{let n="";for(let r=0;r<t.length;r++)n+=`\x1B[${t[r]}m`;return n+e+"\x1B[0m"},zD=(e,...t)=>e,cn={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},VD={None:[],All:[],Trace:[cn.gray],Debug:[cn.blue],Info:[cn.green],Warning:[cn.yellow],Error:[cn.red],Fatal:[cn.bgBrightRed,cn.black]},HD={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},WD=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,tE=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null,JD=tE&&process.stdout.isTTY===!0,QD=tE||"Deno"in globalThis,GD=e=>{const t=e?.mode??"auto",r=(t==="auto"?QD?"tty":"browser":t)==="browser",s=typeof e?.colors=="boolean"?e.colors:JD||r,i=e?.formatDate??WD;return r?XD({colors:s,formatDate:i}):YD({colors:s,formatDate:i,stderr:e?.stderr===!0})},YD=e=>{const t=typeof process=="object"&&"isBun"in process&&process.isBun===!0,n=e.colors?qD:zD;return sa(({annotations:r,cause:s,context:i,date:o,fiberId:c,logLevel:a,message:u,spans:l})=>{const f=Cm(i,Dr),h=ar(f,sf).unsafe,d=e.stderr===!0?h.error:h.log,m=Rp(u);let y=n(`[${e.formatDate(o)}]`,cn.white)+` ${n(a.label,...VD[a._tag])} (${Nl(c)})`;if(Yp(l)){const _=o.getTime(),S=Pm(_);for(const E of l)y+=" "+S(E)}y+=":";let b=0;if(m.length>0){const _=eE(m[0]);typeof _=="string"&&(y+=" "+n(_,cn.bold,cn.cyan),b++)}if(d(y),t||h.group(),tm(s)||d(zr(s,{renderErrorCause:!0})),b<m.length)for(;b<m.length;b++)d(ic(m[b]));if(iv(r)>0)for(const[_,S]of r)d(n(`${_}:`,cn.bold,cn.white),ic(S));t||h.groupEnd()})},XD=e=>{const t=e.colors?"%c":"";return sa(({annotations:n,cause:r,context:s,date:i,fiberId:o,logLevel:c,message:a,spans:u})=>{const l=Cm(s,Dr),f=ar(l,sf).unsafe,h=Rp(a);let d=`${t}[${e.formatDate(i)}]`;const m=[];if(e.colors&&m.push("color:gray"),d+=` ${t}${c.label}${t} (${Nl(o)})`,e.colors&&m.push(HD[c._tag],""),Yp(u)){const b=i.getTime(),_=Pm(b);for(const S of u)d+=" "+_(S)}d+=":";let y=0;if(h.length>0){const b=eE(h[0]);typeof b=="string"&&(d+=` ${t}${b}`,e.colors&&m.push("color:deepskyblue"),y++)}if(f.groupCollapsed(d,...m),tm(r)||f.error(zr(r,{renderErrorCause:!0})),y<h.length)for(;y<h.length;y++)f.log(ic(h[y]));if(iv(n)>0)for(const[b,_]of n){const S=ic(_);e.colors?f.log(`%c${b}:`,"color:gray",S):f.log(`${b}:`,S)}f.groupEnd()})},ZD=ne("effect/Logger/prettyLoggerDefault",()=>GD()),nE="effect/MetricBoundaries",bd=Symbol.for(nE);class e2{values;[bd]=bd;constructor(t){this.values=t,this._hash=p(je(nE),ie(Nc(this.values)))}_hash;[ee](){return this._hash}[X](t){return t2(t)&&J(this.values,t.values)}pipe(){return B(this,arguments)}}const t2=e=>z(e,bd),n2=e=>{const t=p(e,MS(de(Number.POSITIVE_INFINITY)),xT);return new e2(t)},r2=e=>p(FS(e.count-1,t=>e.start*Math.pow(e.factor,t)),Fn,n2),s2="effect/MetricKeyType",rE=Symbol.for(s2),sE="effect/MetricKeyType/Counter",_d=Symbol.for(sE),i2="effect/MetricKeyType/Frequency",o2=Symbol.for(i2),c2="effect/MetricKeyType/Gauge",a2=Symbol.for(c2),iE="effect/MetricKeyType/Histogram",Sd=Symbol.for(iE),u2="effect/MetricKeyType/Summary",l2=Symbol.for(u2),oE={_In:e=>e,_Out:e=>e};class f2{incremental;bigint;[rE]=oE;[_d]=_d;constructor(t,n){this.incremental=t,this.bigint=n,this._hash=je(sE)}_hash;[ee](){return this._hash}[X](t){return cE(t)}pipe(){return B(this,arguments)}}class h2{boundaries;[rE]=oE;[Sd]=Sd;constructor(t){this.boundaries=t,this._hash=p(je(iE),ie(K(this.boundaries)))}_hash;[ee](){return this._hash}[X](t){return aE(t)&&J(this.boundaries,t.boundaries)}pipe(){return B(this,arguments)}}const d2=e=>new f2(e?.incremental??!1,e?.bigint??!1),p2=e=>new h2(e),cE=e=>z(e,_d),m2=e=>z(e,o2),g2=e=>z(e,a2),aE=e=>z(e,Sd),y2=e=>z(e,l2),b2="effect/MetricKey",uE=Symbol.for(b2),_2={_Type:e=>e},S2=Tp(J);class qm{name;keyType;description;tags;[uE]=_2;constructor(t,n,r,s=[]){this.name=t,this.keyType=n,this.description=r,this.tags=s,this._hash=p(je(this.name+this.description),ie(K(this.keyType)),ie(Nc(this.tags)))}_hash;[ee](){return this._hash}[X](t){return w2(t)&&this.name===t.name&&J(this.keyType,t.keyType)&&J(this.description,t.description)&&S2(this.tags,t.tags)}pipe(){return B(this,arguments)}}const w2=e=>z(e,uE),v2=(e,t)=>new qm(e,d2(t),Dc(t?.description)),E2=(e,t,n)=>new qm(e,p2(t),Dc(n)),O2=g(2,(e,t)=>t.length===0?e:new qm(e.name,e.keyType,e.description,Va(e.tags,t))),k2="effect/MetricState",ia=Symbol.for(k2),lE="effect/MetricState/Counter",wd=Symbol.for(lE),fE="effect/MetricState/Frequency",vd=Symbol.for(fE),hE="effect/MetricState/Gauge",Ed=Symbol.for(hE),dE="effect/MetricState/Histogram",Od=Symbol.for(dE),pE="effect/MetricState/Summary",kd=Symbol.for(pE),oa={_A:e=>e};class C2{count;[ia]=oa;[wd]=wd;constructor(t){this.count=t}[ee](){return p(K(lE),ie(K(this.count)),ke(this))}[X](t){return L2(t)&&this.count===t.count}pipe(){return B(this,arguments)}}const P2=Tp(J);class R2{occurrences;[ia]=oa;[vd]=vd;constructor(t){this.occurrences=t}_hash;[ee](){return p(je(fE),ie(Nc(ye(this.occurrences.entries()))),ke(this))}[X](t){return D2(t)&&P2(ye(this.occurrences.entries()),ye(t.occurrences.entries()))}pipe(){return B(this,arguments)}}class $2{value;[ia]=oa;[Ed]=Ed;constructor(t){this.value=t}[ee](){return p(K(hE),ie(K(this.value)),ke(this))}[X](t){return j2(t)&&this.value===t.value}pipe(){return B(this,arguments)}}class T2{buckets;count;min;max;sum;[ia]=oa;[Od]=Od;constructor(t,n,r,s,i){this.buckets=t,this.count=n,this.min=r,this.max=s,this.sum=i}[ee](){return p(K(dE),ie(K(this.buckets)),ie(K(this.count)),ie(K(this.min)),ie(K(this.max)),ie(K(this.sum)),ke(this))}[X](t){return U2(t)&&J(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return B(this,arguments)}}class I2{error;quantiles;count;min;max;sum;[ia]=oa;[kd]=kd;constructor(t,n,r,s,i,o){this.error=t,this.quantiles=n,this.count=r,this.min=s,this.max=i,this.sum=o}[ee](){return p(K(pE),ie(K(this.error)),ie(K(this.quantiles)),ie(K(this.count)),ie(K(this.min)),ie(K(this.max)),ie(K(this.sum)),ke(this))}[X](t){return B2(t)&&this.error===t.error&&J(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return B(this,arguments)}}const F2=e=>new C2(e),M2=e=>new R2(e),x2=e=>new $2(e),A2=e=>new T2(e.buckets,e.count,e.min,e.max,e.sum),N2=e=>new I2(e.error,e.quantiles,e.count,e.min,e.max,e.sum),L2=e=>z(e,wd),D2=e=>z(e,vd),j2=e=>z(e,Ed),U2=e=>z(e,Od),B2=e=>z(e,kd),K2="effect/MetricHook",q2=Symbol.for(K2),z2={_In:e=>e,_Out:e=>e},ca=e=>({[q2]:z2,pipe(){return B(this,arguments)},...e}),Sb=BigInt(0),V2=e=>{let t=e.keyType.bigint?Sb:0;const n=e.keyType.incremental?e.keyType.bigint?s=>s>=Sb:s=>s>=0:s=>!0,r=s=>{n(s)&&(t=t+s)};return ca({get:()=>F2(t),update:r,modify:r})},H2=e=>{const t=new Map;for(const r of e.keyType.preregisteredWords)t.set(r,0);const n=r=>{const s=t.get(r)??0;t.set(r,s+1)};return ca({get:()=>M2(t),update:n,modify:n})},W2=(e,t)=>{let n=t;return ca({get:()=>x2(n),update:r=>{n=r},modify:r=>{n=n+r}})},J2=e=>{const t=e.keyType.boundaries.values,n=t.length,r=new Uint32Array(n+1),s=new Float32Array(n);let i=0,o=0,c=Number.MAX_VALUE,a=Number.MIN_VALUE;p(t,oc(Ti),cs((f,h)=>{s[h]=f}));const u=f=>{let h=0,d=n;for(;h!==d;){const m=Math.floor(h+(d-h)/2),y=s[m];f<=y?d=m:h=m,d===h+1&&(f<=s[h]?d=h:h=d)}r[h]=r[h]+1,i=i+1,o=o+f,f<c&&(c=f),f>a&&(a=f)},l=()=>{const f=wl(n);let h=0;for(let d=0;d<n;d++){const m=s[d],y=r[d];h=h+y,f[d]=[m,h]}return f};return ca({get:()=>A2({buckets:l(),count:i,min:c,max:a,sum:o}),update:u,modify:u})},Q2=e=>{const{error:t,maxAge:n,maxSize:r,quantiles:s}=e.keyType,i=p(s,oc(Ti)),o=wl(r);let c=0,a=0,u=0,l=0,f=0;const h=m=>{const y=[];let b=0;for(;b!==r-1;){const _=o[b];if(_!=null){const[S,E]=_,O=ws(m-S);vF(O,xi)&&wF(O,n)&&y.push(E)}b=b+1}return G2(t,i,oc(y,Ti))},d=(m,y)=>{if(r>0){c=c+1;const b=c%r;o[b]=[y,m]}l=a===0?m:Math.min(l,m),f=a===0?m:Math.max(f,m),a=a+1,u=u+m};return ca({get:()=>N2({error:t,quantiles:h(Date.now()),count:a,min:l,max:f,sum:u}),update:([m,y])=>d(m,y),modify:([m,y])=>d(m,y)})},G2=(e,t,n)=>{const r=n.length;if(!pt(t))return Fr();const s=t[0],i=t.slice(1),o=wb(e,r,A(),0,s,n),c=vn(o);return i.forEach(a=>{c.push(wb(e,r,o.value,o.consumed,a,o.rest))}),cs(c,a=>[a.quantile,a.value])},wb=(e,t,n,r,s,i)=>{let o=e,c=t,a=n,u=r,l=s,f=i,h=e,d=t,m=n,y=r,b=s,_=i;for(;;){if(!pt(f))return{quantile:l,value:A(),consumed:u,rest:[]};if(l===1)return{quantile:l,value:N(NS(f)),consumed:u+f.length,rest:[]};const S=Ft(f),E=kT(f,w=>w===S),O=l*c,C=o/2*O,v=u+E[0].length,$=Math.abs(v-O);if(v<O-C){h=o,d=c,m=Yo(f),y=v,b=l,_=E[1],o=h,c=d,a=m,u=y,l=b,f=_;continue}if(v>O+C){const w=Qe(a)?N(S):a;return{quantile:l,value:w,consumed:u,rest:f}}switch(a._tag){case"None":{h=o,d=c,m=Yo(f),y=v,b=l,_=E[1],o=h,c=d,a=m,u=y,l=b,f=_;continue}case"Some":{const w=Math.abs(O-a.value);if($<w){h=o,d=c,m=Yo(f),y=v,b=l,_=E[1],o=h,c=d,a=m,u=y,l=b,f=_;continue}return{quantile:l,value:N(a.value),consumed:u,rest:f}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},Y2="effect/MetricPair",X2=Symbol.for(Y2),Z2={_Type:e=>e},ej=(e,t)=>({[X2]:Z2,metricKey:e,metricState:t,pipe(){return B(this,arguments)}}),tj="effect/MetricRegistry",vb=Symbol.for(tj);class nj{[vb]=vb;map=PA();snapshot(){const t=[];for(const[n,r]of this.map)t.push(ej(n,r.get()));return t}get(t){const n=p(this.map,Hr(t),Dn);if(n==null){if(cE(t.keyType))return this.getCounter(t);if(g2(t.keyType))return this.getGauge(t);if(m2(t.keyType))return this.getFrequency(t);if(aE(t.keyType))return this.getHistogram(t);if(y2(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return n}getCounter(t){let n=p(this.map,Hr(t),Dn);if(n==null){const r=V2(t);p(this.map,$o(t))||p(this.map,To(t,r)),n=r}return n}getFrequency(t){let n=p(this.map,Hr(t),Dn);if(n==null){const r=H2(t);p(this.map,$o(t))||p(this.map,To(t,r)),n=r}return n}getGauge(t){let n=p(this.map,Hr(t),Dn);if(n==null){const r=W2(t,t.keyType.bigint?BigInt(0):0);p(this.map,$o(t))||p(this.map,To(t,r)),n=r}return n}getHistogram(t){let n=p(this.map,Hr(t),Dn);if(n==null){const r=J2(t);p(this.map,$o(t))||p(this.map,To(t,r)),n=r}return n}getSummary(t){let n=p(this.map,Hr(t),Dn);if(n==null){const r=Q2(t);p(this.map,$o(t))||p(this.map,To(t,r)),n=r}return n}}const rj=()=>new nj,sj="effect/Metric",ij=Symbol.for(sj),oj={_Type:e=>e,_In:e=>e,_Out:e=>e},Eb=ne(Symbol.for("effect/Metric/globalMetricRegistry"),()=>rj()),mE=function(e,t,n,r){const s=Object.assign(i=>Yc(i,o=>lj(s,o)),{[ij]:oj,keyType:e,unsafeUpdate:t,unsafeValue:n,unsafeModify:r,register(){return this.unsafeValue([]),this},pipe(){return B(this,arguments)}});return s},lf=(e,t)=>gE(v2(e,t)),gE=e=>{let t;const n=new WeakMap,r=s=>{if(s.length===0)return t!==void 0||(t=Eb.get(e)),t;let i=n.get(s);return i!==void 0||(i=Eb.get(O2(e,s)),n.set(s,i)),i};return mE(e.keyType,(s,i)=>r(i).update(s),s=>r(s).get(),(s,i)=>r(i).modify(s))},cj=(e,t,n)=>gE(E2(e,t,n)),aj=g(3,(e,t,n)=>uj(e,[hL(t,n)])),uj=g(2,(e,t)=>mE(e.keyType,(n,r)=>e.unsafeUpdate(n,Va(t,r)),n=>e.unsafeValue(Va(t,n)),(n,r)=>e.unsafeModify(n,Va(t,r)))),lj=g(2,(e,t)=>Xc(rd,n=>I(()=>e.unsafeUpdate(t,n))));({...Cp});const fj=g(2,(e,t)=>Xc(Z0,n=>I(()=>{if(n.has(e)){const r=n.get(e);r.state.completed||(r.state.completed=!0,tf(r.result,t))}}))),hj="effect/Supervisor",ff=Symbol.for(hj),zm={_T:e=>e};class hf{underlying;value0;[ff]=zm;constructor(t,n){this.underlying=t,this.value0=n}get value(){return this.value0}onStart(t,n,r,s){this.underlying.onStart(t,n,r,s)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new hf(this,p(this.value,W(t)))}zip(t){return new df(this,t)}}class df{left;right;_tag="Zip";[ff]=zm;constructor(t,n){this.left=t,this.right=n}get value(){return zv(this.left.value,this.right.value)}onStart(t,n,r,s){this.left.onStart(t,n,r,s),this.right.onStart(t,n,r,s)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new hf(this,p(this.value,W(t)))}zip(t){return new df(this,t)}}const yE=e=>z(e,ff)&&aS(e,"Zip");class dj{effect;[ff]=zm;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,n,r,s){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new hf(this,p(this.value,W(t)))}zip(t){return new df(this,t)}onRun(t,n){return t()}}const pj=e=>new dj(e),pf=ne("effect/Supervisor/none",()=>pj(fe)),mj=oo,bE="Empty",_E="AddSupervisor",SE="RemoveSupervisor",wE="AndThen",Xo={_tag:bE},Ya=(e,t)=>({_tag:wE,first:e,second:t}),gj=(e,t)=>yj(t,de(e)),yj=(e,t)=>{let n=e,r=t;for(;Mn(r);){const s=Bn(r);switch(s._tag){case bE:{r=ir(r);break}case _E:{n=n.zip(s.supervisor),r=ir(r);break}case SE:{n=Cd(n,s.supervisor),r=ir(r);break}case wE:{r=mt(s.first)(mt(s.second)(ir(r)));break}}}return n},Cd=(e,t)=>J(e,t)?pf:yE(e)?Cd(e.left,t).zip(Cd(e.right,t)):e,Qu=e=>J(e,pf)?Os():yE(e)?p(Qu(e.left),lc(Qu(e.right))):Wp(e),bj=(e,t)=>{if(J(e,t))return Xo;const n=Qu(e),r=Qu(t),s=p(r,Ty(n),fc(Xo,(o,c)=>Ya(o,{_tag:_E,supervisor:c}))),i=p(n,Ty(r),fc(Xo,(o,c)=>Ya(o,{_tag:SE,supervisor:c})));return Ya(s,i)},_j=mj({empty:Xo,patch:gj,combine:Ya,diff:bj}),Sj=lf("effect_fiber_started",{incremental:!0}),Ob=lf("effect_fiber_active"),wj=lf("effect_fiber_successes",{incremental:!0}),vj=lf("effect_fiber_failures",{incremental:!0}),Ej=aj(cj("effect_fiber_lifetimes",r2({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Io="Continue",Oj="Done",kb="Yield",kj={_E:e=>e,_A:e=>e},Ia=e=>{throw new Error(`BUG: FiberRuntime - ${Ri(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},Xn=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),Zn=ne("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),Fo={[Eu]:(e,t,n)=>Rt(()=>t.effect_instruction_i1(n)),OnStep:(e,t,n)=>Ee(Ee(n)),[Ou]:(e,t,n)=>Rt(()=>t.effect_instruction_i2(n)),[kp]:(e,t,n)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),vr(e.currentRuntimeFlags)&&e.isInterrupted()?pe(e.getInterruptedCause()):Ee(n)),[ku]:(e,t,n)=>(Rt(()=>t.effect_instruction_i2(n)),Rt(()=>t.effect_instruction_i0())?(e.pushStack(t),Rt(()=>t.effect_instruction_i1())):fe),[Go]:(e,t,n)=>{const r=Rt(()=>t.effect_instruction_i0.next(n));return r.done?Ee(r.value):(e.pushStack(t),F$(r.value))}},Cj={[jm]:(e,t,n,r)=>(e.processNewInterruptSignal(r.cause),vr(t)?pe(r.cause):n),[Bm]:(e,t,n,r)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[Um]:(e,t,n,r)=>(r.onFiber(e,K0(t)),n),[Km]:(e,t,n,r)=>T(Jl(),()=>n)},Pj=e=>Vl(Lx(e),t=>fr(Yx(t),([n,r])=>{const s=new Map,i=[];for(const c of r){i.push($n(c));for(const a of c)s.set(a.request,a)}const o=i.flat();return Zc(Jj(n.runAll(i),o,()=>o.forEach(c=>{c.listeners.interrupted=!0})),Z0,s)},!1,!1)),Rj=gl();class vE extends Vs{[TD]=ID;[MD]=kj;_fiberRefs;_fiberId;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(t,n,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=t,this._fiberRefs=n,Ay(r)){const s=this.getFiberRef(rd);Sj.unsafeUpdate(1,s),Ob.unsafeUpdate(1,s)}this.refreshRefCache()}commit(){return Sc(this)}id(){return this._fiberId}resume(t){this.tell(Gs(t))}get status(){return this.ask((t,n)=>n)}get runtimeFlags(){return this.ask((t,n)=>JL(n)?t.currentRuntimeFlags:n.runtimeFlags)}scope(){return RD(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef($a)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return G(()=>{const n=ea(this._fiberId);return this.tell(Ga((r,s)=>{tf(n,I(()=>t(r,s)))})),Qn(n)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return Lr(t=>{const n=r=>t(x(r));return this.tell(Ga((r,s)=>{r._exitValue!==null?n(this._exitValue):r.addObserver(n)})),I(()=>this.tell(Ga((r,s)=>{r.removeObserver(n)})))},this.id())}get inheritAll(){return oe((t,n)=>{const r=t.id(),s=t.getFiberRefs(),i=n.runtimeFlags,o=this.getFiberRefs(),c=KN(s,r,o);t.setFiberRefs(c);const a=t.getFiberRef($b),u=p(ls(i,a),Ly(Bs),Ly(ed));return E1(u)})}get poll(){return I(()=>Dc(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return I(()=>this.tell(Zf(ln(t))))}unsafeInterruptAsFork(t){this.tell(Zf(ln(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(n=>n!==t)}getFiberRefs(){return this.setFiberRef($b,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=S0(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,n){this._fiberRefs=fd(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:n}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(Dr),this.currentTracer=this.currentDefaultServices.unsafeMap.get(km.key),this.currentSupervisor=this.getFiberRef(Hj),this.currentScheduler=this.getFiberRef(Dm),this.currentContext=this.getFiberRef(_r),this.currentSpan=this.currentContext.unsafeMap.get(of.key)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}transferChildren(t){const n=this._children;if(this._children=null,n!==null&&n.size>0)for(const r of n)r._exitValue===null&&t.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let n=Io;const r=globalThis[Vr];globalThis[Vr]=this;try{for(;n===Io;)n=this._queue.length===0?Oj:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Vr]=r}this._queue.length>0&&!this._running?(this._running=!0,n===kb?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(ho))}drainQueueWhileRunning(t,n){let r=n;for(;this._queue.length>0;){const s=this._queue.splice(0,1)[0];r=Cj[s._tag](this,t,r,s)}return r}isInterrupted(){return!tm(this.getFiberRef($a))}addInterruptedCause(t){const n=this.getFiberRef($a);this.setFiberRef($a,ct(n,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(const n of this._children)n.tell(Zf(ln(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const t=this._children.values();this._children=null;let n=!1;return um({while:()=>!n,body:()=>{const s=t.next();return s.done?I(()=>{n=!0}):Zt(s.value.await)},step:()=>{}})}return null}reportExitValue(t){if(Ay(this.currentRuntimeFlags)){const n=this.getFiberRef(rd),r=this.id().startTimeMillis,s=Date.now();switch(Ej.unsafeUpdate(s-r,n),Ob.unsafeUpdate(-1,n),t._tag){case nt:{wj.unsafeUpdate(1,n);break}case tt:{vj.unsafeUpdate(1,n);break}}}if(t._tag==="Failure"){const n=this.getFiberRef(W1);!Ul(t.cause)&&n._tag==="Some"&&this.log("Fiber terminated with an unhandled error",t.cause,n)}}setExitValue(t){this._exitValue=t,this.reportExitValue(t);for(let n=this._observers.length-1;n>=0;n--)this._observers[n](t);this._observers=[]}getLoggers(){return this.getFiberRef(Vm)}log(t,n,r){const s=Be(r)?r.value:this.getFiberRef(K1),i=this.getFiberRef($j);if(tL(i,s))return;const o=this.getFiberRef(q1),c=this.getFiberRef(B1),a=this.getLoggers(),u=this.getFiberRefs();if(Jp(a)>0){const l=ar(this.getFiberRef(Dr),mo),f=new Date(l.unsafeCurrentTimeMillis());L$(u,()=>{for(const h of a)h.log({fiberId:this.id(),logLevel:s,message:t,cause:n,context:u,spans:o,annotations:c,date:f})})}}evaluateMessageWhileSuspended(t){switch(t._tag){case Km:return kb;case jm:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(pe(t.cause)),this._asyncInterruptor=null),Io;case Bm:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Io;case Um:return t.onFiber(this,this._exitValue!==null?HL:WL(this.currentRuntimeFlags,this._asyncBlockingOn)),Io;default:return Ia(t)}}evaluateEffect(t){this.currentSupervisor.onResume(this);try{let n=vr(this.currentRuntimeFlags)&&this.isInterrupted()?pe(this.getInterruptedCause()):t;for(;n!==null;){const r=n,s=this.runLoop(r);if(s===Xn){const i=Zn.currentOp;Zn.currentOp=null,i._op===qa?Ix(this.currentRuntimeFlags)?(this.tell(OD()),this.tell(Gs(Bt)),n=null):n=Bt:i._op===Qo&&(n=null)}else{this.currentRuntimeFlags=p(this.currentRuntimeFlags,Mx(ed));const i=this.interruptAllChildren();i!==null?n=T(i,()=>s):(this._queue.length===0?this.setExitValue(s):this.tell(Gs(s)),n=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Gs(t));else{this._running=!0;const n=globalThis[Vr];globalThis[Vr]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Vr]=n,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Gs(t))}patchRuntimeFlags(t,n){const r=bi(t,n);return globalThis[Vr]=this,this.currentRuntimeFlags=r,r}initiateAsync(t,n){let r=!1;const s=i=>{r||(r=!0,this.tell(Gs(i)))};vr(t)&&(this._asyncInterruptor=s);try{n(s)}catch(i){s(qe(Wt(i)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){const t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==Ka)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==Eu&&t._op!==ku&&t._op!==Go)return t;t=this.popStack()}}[D$](t){return I(()=>Iw(this.currentContext,t))}Left(t){return Fe(t.left)}None(t){return Fe(new hm)}Right(t){return Ee(t.right)}Some(t){return Ee(t.value)}Micro(t){return pc(n=>{let r=n;const s=vD(mD(t,this.currentContext));return s.addObserver(i=>{if(i._tag==="Success")return r(Ee(i.value));switch(i.cause._tag){case"Interrupt":return r(pe(ln(Cs)));case"Fail":return r(Fe(i.cause.error));case"Die":return r(Vi(i.cause.defect))}}),pc(i=>{r=o=>{i(fe)},s.unsafeInterrupt()})})}[gS](t){const n=Rt(()=>t.effect_instruction_i0()),r=this.getNextSuccessCont();return r!==void 0?(r._op in Fo||Ia(r),Fo[r._op](this,r,n)):(Zn.currentOp=Ee(n),Xn)}[nt](t){const n=t,r=this.getNextSuccessCont();return r!==void 0?(r._op in Fo||Ia(r),Fo[r._op](this,r,n.effect_instruction_i0)):(Zn.currentOp=n,Xn)}[tt](t){const n=t.effect_instruction_i0,r=this.getNextFailCont();if(r!==void 0)switch(r._op){case Ka:case Ou:return vr(this.currentRuntimeFlags)&&this.isInterrupted()?pe(Dy(n)):Rt(()=>r.effect_instruction_i1(n));case"OnStep":return vr(this.currentRuntimeFlags)&&this.isInterrupted()?pe(Dy(n)):Ee(pe(n));case kp:return this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),vr(this.currentRuntimeFlags)&&this.isInterrupted()?pe(ct(n,this.getInterruptedCause())):pe(n);default:Ia(r)}else return Zn.currentOp=pe(n),Xn}[yS](t){return Rt(()=>t.effect_instruction_i0(this,K0(this.currentRuntimeFlags)))}Blocked(t){const n=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){const s=[],i=this._steps[this._steps.length-1];let o=this.popStack();for(;o&&o._op!=="OnStep";)s.push(o),o=this.popStack();this.setFiberRefs(i.refs),this.currentRuntimeFlags=i.flags;const c=bc(i.refs,n),a=ls(i.flags,r);return Ee(xv(t.effect_instruction_i0,oe(u=>{for(;s.length>0;)u.pushStack(s.pop());return u.setFiberRefs(_c(u.id(),u.getFiberRefs())(c)),u.currentRuntimeFlags=bi(a)(u.currentRuntimeFlags),t.effect_instruction_i1})))}return xn(s=>T(Qm(y1(t.effect_instruction_i0)),()=>s(t.effect_instruction_i1)))}RunBlocked(t){return Pj(t.effect_instruction_i0)}[to](t){const n=t.effect_instruction_i0,r=this.currentRuntimeFlags,s=bi(r,n);if(vr(s)&&this.isInterrupted())return pe(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,n),t.effect_instruction_i1){const i=ls(s,r);return this.pushStack(new b1(i,t)),Rt(()=>t.effect_instruction_i1(r))}else return Bt}[Eu](t){return this.pushStack(t),t.effect_instruction_i0}OnStep(t){return this.pushStack(t),t.effect_instruction_i0}[Ka](t){return this.pushStack(t),t.effect_instruction_i0}[Ou](t){return this.pushStack(t),t.effect_instruction_i0}[Qo](t){return this._asyncBlockingOn=t.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,t.effect_instruction_i0),Zn.currentOp=t,Xn}[qa](t){return this._isYielding=!1,Zn.currentOp=t,Xn}[ku](t){const n=t.effect_instruction_i0,r=t.effect_instruction_i1;return n()?(this.pushStack(t),r()):Bt}[Go](t){return Fo[Go](this,t,void 0)}[Sl](t){return Rt(()=>t.commit())}runLoop(t){let n=t;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&Tx)!==0&&this.currentSupervisor.onEffect(this,n),this._queue.length>0&&(n=this.drainQueueWhileRunning(this.currentRuntimeFlags,n)),!this._isYielding){this.currentOpCount+=1;const r=this.currentScheduler.shouldYield(this);if(r!==!1){this._isYielding=!0,this.currentOpCount=0;const s=n;n=T(Jl({priority:r}),()=>s)}}try{if(n=this.currentTracer.context(()=>Rj!==n[qi]._V?nd(`Cannot execute an Effect versioned ${n[qi]._V} with a Runtime of version ${gl()}`):this[n._op](n),this),n===Xn){const r=Zn.currentOp;return r._op===qa||r._op===Qo?Xn:(Zn.currentOp=null,r._op===nt||r._op===tt?r:pe(Wt(r)))}}catch(r){n!==Xn&&!z(n,"_op")||!(n._op in this)?n=nd(`Not a valid effect: ${Ri(n)}`):tA(r)?n=pe(ct(Wt(r),ln(Cs))):n=Vi(r)}}}run=()=>{this.drainQueueOnCurrentThread()}}const $j=ne("effect/FiberRef/currentMinimumLogLevel",()=>gt(nL("Info"))),Tj=e=>sa(t=>{const n=Cm(t.context,Dr);ar(n,sf).unsafe.log(e.log(t))}),EE=ne(Symbol.for("effect/Logger/defaultLogger"),()=>Tj(KD)),Ij=ne(Symbol.for("effect/Logger/prettyLogger"),()=>ZD),Fj=ne(Symbol.for("effect/Logger/tracerLogger"),()=>sa(({annotations:e,cause:t,context:n,fiberId:r,logLevel:s,message:i})=>{const o=so(yc(n,_r),of);if(o._tag==="None"||o.value._tag==="ExternalSpan")return;const c=Iw(yc(n,Dr),mo),a={};for(const[u,l]of e)a[u]=l;a["effect.fiberId"]=yM(r),a["effect.logLevel"]=s.label,t!==null&&t._tag!=="Empty"&&(a["effect.cause"]=zr(t,{renderErrorCause:!0})),o.value.event(Ri(Array.isArray(i)?i[0]:i),c.unsafeCurrentTimeNanos(),a)})),Vm=ne(Symbol.for("effect/FiberRef/currentLoggers"),()=>D1(Wp(EE,Fj))),Hm=g(e=>Yn(e[0]),(e,t)=>qs(Yc(e,n=>Mj(r=>t(n,r))))),Mj=e=>oe(t=>{const n=t.getFiberRefs(),r=Fx(t.currentRuntimeFlags,Bs);return T(PE,s=>Lu(s,i=>oe(o=>{const c=o.getFiberRefs(),a=o.currentRuntimeFlags,u=bc(c,n),l=ls(a,r),f=bc(n,c);return o.setFiberRefs(_c(u,o.id(),n)),wc(C1(e(i),l),I(()=>{o.setFiberRefs(_c(f,o.id(),o.getFiberRefs()))}))})))}),xj=e=>{if(Array.isArray(e)||wp(e))return[e,A()];const t=Object.keys(e),n=t.length;return[t.map(r=>e[r]),N(r=>{const s={};for(let i=0;i<n;i++)s[t[i]]=r[i];return s})]},Aj=(e,t,n)=>{const r=[];for(const s of e)r.push(Hi(s));return T(Gi(r,Z,{concurrency:n?.concurrency,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),s=>{const i=A(),o=s.length,c=new Array(o),a=new Array(o);let u=!1;for(let l=0;l<o;l++){const f=s[l];f._tag==="Left"?(c[l]=N(f.left),u=!0):(a[l]=f.right,c[l]=i)}return u?t._tag==="Some"?Fe(t.value(c)):Fe(c):n?.discard?fe:t._tag==="Some"?x(t.value(a)):x(a)})},Nj=(e,t,n)=>{const r=[];for(const s of e)r.push(Hi(s));return n?.discard?Gi(r,Z,{concurrency:n?.concurrency,batching:n?.batching,discard:!0,concurrentFinalizers:n?.concurrentFinalizers}):W(Gi(r,Z,{concurrency:n?.concurrency,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),s=>t._tag==="Some"?t.value(s):s)},Wm=(e,t)=>{const[n,r]=xj(e);return t?.mode==="validate"?Aj(n,r,t):t?.mode==="either"?Nj(n,r,t):t?.discard!==!0&&r._tag==="Some"?W(Gi(n,Z,t),r.value):Gi(n,Z,t)},Gi=g(e=>wp(e[0]),(e,t,n)=>oe(r=>{const s=n?.batching===!0||n?.batching==="inherit"&&r.getFiberRef(H1);return n?.discard?_b(n.concurrency,()=>Ys(qu,n?.concurrentFinalizers)(i=>s?fr(e,(o,c)=>i(t(o,c)),!0,!1,1):Vl(e,(o,c)=>i(t(o,c)))),()=>Ys(pd,n?.concurrentFinalizers)(i=>fr(e,(o,c)=>i(t(o,c)),s,!1)),i=>Ys(md(i),n?.concurrentFinalizers)(o=>fr(e,(c,a)=>o(t(c,a)),s,!1,i))):_b(n?.concurrency,()=>Ys(qu,n?.concurrentFinalizers)(i=>s?Pd(e,1,(o,c)=>i(t(o,c)),!0):or(e,(o,c)=>i(t(o,c)))),()=>Ys(pd,n?.concurrentFinalizers)(i=>Jm(e,(o,c)=>i(t(o,c)),s)),i=>Ys(md(i),n?.concurrentFinalizers)(o=>Pd(e,i,(c,a)=>o(t(c,a)),s)))})),Jm=(e,t,n)=>G(()=>{const r=ye(e),s=new Array(r.length);return He(fr(r,(o,c)=>T(t(o,c),a=>I(()=>s[c]=a)),n,!1),x(s))}),fr=(e,t,n,r,s)=>xn(i=>v1(o=>oe(c=>{let a=Array.from(e).reverse(),u=a.length;if(u===0)return fe;let l=0,f=!1;const h=s?Math.min(a.length,s):a.length,d=new Set,m=new Array,y=()=>d.forEach(w=>{w.currentScheduler.scheduleTask(()=>{w.unsafeInterruptAsFork(c.id())},0)}),b=new Array,_=new Array,S=new Array,E=()=>{const w=m.filter(({exit:P})=>P._tag==="Failure").sort((P,k)=>P.index<k.index?-1:P.index===k.index?0:1).map(({exit:P})=>P);return w.length===0&&w.push(Bt),w},O=(w,P=!1)=>{const k=qs(o(w)),R=Lj(k,c,c.currentRuntimeFlags,uf);return c.currentScheduler.scheduleTask(()=>{P&&R.unsafeInterruptAsFork(c.id()),R.resume(k)},0),R},C=()=>{r||(u-=a.length,a=[]),f=!0,y()},v=n?_1:Vn,$=O(Lr(w=>{const P=(R,F)=>{R._op==="Blocked"?S.push(R):(m.push({index:F,exit:R}),R._op==="Failure"&&!f&&C())},k=()=>{if(a.length>0){const R=a.pop();let F=l++;const L=()=>{const j=a.pop();return F=l++,T(Jl(),()=>T(v(i(t(j,F))),U))},U=j=>a.length>0&&(P(j,F),a.length>0)?L():x(j),re=T(v(i(t(R,F))),U),H=O(re);b.push(H),d.add(H),f&&H.currentScheduler.scheduleTask(()=>{H.unsafeInterruptAsFork(c.id())},0),H.addObserver(j=>{let Q;if(j._op==="Failure"?Q=j:Q=j.effect_instruction_i0,_.push(H),d.delete(H),P(Q,F),m.length===u)w(x(Pe(_i(E(),{parallel:!0}),()=>Bt)));else if(S.length+m.length===u){const Ye=E(),yt=S.map(me=>me.effect_instruction_i0).reduce(_v);w(x(xv(yt,fr([Pe(_i(Ye,{parallel:!0}),()=>Bt),...S.map(me=>me.effect_instruction_i1)],me=>me,n,!0,s))))}else k()})}};for(let R=0;R<h;R++)k()}));return Zt($s(lo(i(Sc($))),Zl({onFailure:w=>{C();const P=S.length+1,k=Math.min(typeof s=="number"?s:S.length,S.length),R=Array.from(S);return Lr(F=>{let L=0,U=0;const re=(j,Q)=>Ye=>{L++,L===P&&F(Ee(pe(w))),R.length>0&&Q&&H()},H=()=>{O(R.pop(),!0).addObserver(re(U,!0)),U++};$.addObserver(re(U,!1)),U++;for(let j=0;j<k;j++)H()})},onSuccess:()=>or(_,w=>w.inheritAll)})))}))),Pd=(e,t,n,r)=>G(()=>{const s=ye(e),i=new Array(s.length);return He(fr(s,(c,a)=>W(n(c,a),u=>i[a]=u),r,!1,t),x(i))}),Qm=e=>Dj(e,uf),OE=(e,t,n,r=null)=>{const s=Gu(e,t,n,r);return s.resume(e),s},Lj=(e,t,n,r=null)=>Gu(e,t,n,r),Gu=(e,t,n,r=null)=>{const s=tv(),i=t.getFiberRefs(),o=qN(i,s),c=new vE(s,o,n),a=yc(o,_r),u=c.currentSupervisor;return u.onStart(a,e,N(t),c),c.addObserver(f=>u.onEnd(f,c)),(r!==null?r:p(t.getFiberRef(sd),Pe(()=>t.scope()))).add(n,c),c},Dj=(e,t)=>oe((n,r)=>x(OE(e,n,r.runtimeFlags,t))),Cb=e=>zs(t=>we(so(t,Hs),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return T(Yl(n,pd),r=>la(e,r))}}})),Pb=e=>t=>zs(n=>we(so(n,Hs),{onNone:()=>t,onSome:r=>r.strategy._tag==="ParallelN"&&r.strategy.parallelism===e?t:T(Yl(r,md(e)),s=>la(t,s))})),Ys=(e,t)=>n=>zs(r=>we(so(r,Hs),{onNone:()=>n(Z),onSome:s=>{if(t===!0){const i=e._tag==="Parallel"?Cb:e._tag==="Sequential"?Rb:Pb(e.parallelism);switch(s.strategy._tag){case"Parallel":return i(n(Cb));case"Sequential":return i(n(Rb));case"ParallelN":return i(n(Pb(s.strategy.parallelism)))}}else return n(Z)}})),kE=e=>T(Hs,e),CE=e=>T(ua(),t=>$s(e(t),n=>t.close(n))),Rb=e=>zs(t=>we(so(t,Hs),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return T(Yl(n,qu),r=>la(e,r))}}})),jj=g(e=>Yn(e[1]),(e,t,n)=>aa(e,t,(r,s)=>[r,s],n)),Uj=g(e=>Yn(e[1]),(e,t,n)=>n?.concurrent!==!0&&(n?.batching===void 0||n.batching===!1)?Ql(e,t):aa(e,t,(r,s)=>r,n)),Bj=g(e=>Yn(e[1]),(e,t,n)=>n?.concurrent!==!0&&(n?.batching===void 0||n.batching===!1)?He(e,t):aa(e,t,(r,s)=>s,n)),aa=g(e=>Yn(e[1]),(e,t,n,r)=>W(Wm([e,t],{concurrency:r?.concurrent?2:1,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),([s,i])=>n(s,i))),Hs=Ds("effect/Scope"),PE=Hs,Kj=(e,t)=>{e.state._tag==="Open"&&e.state.finalizers.set({},t)},qj={[Ky]:Ky,[qy]:qy,pipe(){return B(this,arguments)},fork(e){return I(()=>{const t=RE(e);if(this.state._tag==="Closed")return t.state=this.state,t;const n={},r=s=>t.close(s);return this.state.finalizers.set(n,r),Kj(t,s=>I(()=>{this.state._tag==="Open"&&this.state.finalizers.delete(n)})),t})},close(e){return G(()=>{if(this.state._tag==="Closed")return fe;const t=Array.from(this.state.finalizers.values()).reverse();return this.state={_tag:"Closed",exit:e},t.length===0?fe:NL(this.strategy)?p(or(t,n=>Vn(n(e))),T(n=>p(_i(n),os(Gf),Pe(()=>Bt)))):LL(this.strategy)?p(Jm(t,n=>Vn(n(e)),!1),T(n=>p(_i(n,{parallel:!0}),os(Gf),Pe(()=>Bt)))):p(Pd(t,this.strategy.parallelism,n=>Vn(n(e)),!1),T(n=>p(_i(n,{parallel:!0}),os(Gf),Pe(()=>Bt))))})},addFinalizer(e){return G(()=>this.state._tag==="Closed"?e(this.state.exit):(this.state.finalizers.set({},e),fe))}},RE=(e=ra)=>{const t=Object.create(qj);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},ua=(e=ra)=>I(()=>RE(e)),la=g(2,(e,t)=>gA(e,io(Bc(Hs,t)))),zj=e=>fo(e,{differ:_j,fork:Xo}),Vj=g(2,(e,t)=>Zt(Hm(T(Gl(e),n=>Et(Nu(e,t),n)),n=>Nu(e,n)))),$E=g(2,(e,t)=>Xc(e,n=>Vj(e,t(n)))),$b=U1(xx),Hj=zj(pf),TE=g(3,(e,t,n)=>Wj(e,t,{onSelfWin:(r,s)=>T(r.await,i=>{switch(i._tag){case nt:return T(r.inheritAll,()=>n.onSelfDone(i,s));case tt:return n.onSelfDone(i,s)}}),onOtherWin:(r,s)=>T(r.await,i=>{switch(i._tag){case nt:return T(r.inheritAll,()=>n.onOtherDone(i,s));case tt:return n.onOtherDone(i,s)}})})),IE=g(2,(e,t)=>Qc(n=>TE(e,t,{onSelfDone:(r,s)=>ad(r,{onFailure:i=>p(Sc(s),fb(o=>Nr(i,o))),onSuccess:i=>p(s,mc(n),Et(i))}),onOtherDone:(r,s)=>ad(r,{onFailure:i=>p(Sc(s),fb(o=>Nr(o,i))),onSuccess:i=>p(s,mc(n),Et(i))})}))),Wj=g(3,(e,t,n)=>oe((r,s)=>{const i=s.runtimeFlags,o=js(!0),c=Gu(e,r,i,n.selfScope),a=Gu(t,r,i,n.otherScope);return Lr(u=>{c.addObserver(()=>Tb(c,a,n.onSelfWin,o,u)),a.addObserver(()=>Tb(a,c,n.onOtherWin,o,u)),c.startFork(e),a.startFork(t)},pM(c.id(),a.id()))})),Tb=(e,t,n,r,s)=>{cM(!0,!1)(r)&&s(n(e,t))},wc=g(2,(e,t)=>xn(n=>Xt(n(e),{onFailure:r=>Xt(t,{onFailure:s=>qe(ct(r,s)),onSuccess:()=>qe(r)}),onSuccess:r=>Et(t,r)}))),Jj=(e,t,n)=>Qc(r=>T(T(Qm(cm(e)),s=>Lr(i=>{const o=t.map(u=>u.listeners.count),c=()=>{o.every(u=>u===0)&&t.every(u=>u.result.state.current._tag==="Pending"?!0:!!(u.result.state.current._tag==="Done"&&pm(u.result.state.current.effect)&&u.result.state.current.effect._tag==="Failure"&&Cv(u.result.state.current.effect.cause)))&&(a.forEach(u=>u()),n?.(),i(lm(s)))};s.addObserver(u=>{a.forEach(l=>l()),i(u)});const a=t.map((u,l)=>{const f=h=>{o[l]=h,c()};return u.listeners.addObserver(f),()=>u.listeners.removeObserver(f)});return c(),I(()=>{a.forEach(u=>u())})})),()=>G(()=>{const s=t.flatMap(i=>i.state.completed?[]:[i]);return Vl(s,i=>fj(i.request,e0(r)))}))),FE=Ar,Rd=Wt,Qj=ln,Gj=e1,Yj=kv,Gm=Cv,eh=Ul,Xj=nm,mf=$v,ME=n1,Ym=Tv,Zj=Y1,eU=nA,tU=zr,nU="effect/ScheduleInterval",Yu=Symbol.for(nU),xE={[Yu]:Yu,startMillis:0,endMillis:0},Xm=(e,t)=>e>t?xE:{[Yu]:Yu,startMillis:e,endMillis:t},rU=g(2,(e,t)=>sU(e,t)===e),sU=g(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t),iU=e=>e.startMillis>=e.endMillis,oU=g(2,(e,t)=>{const n=Math.max(e.startMillis,t.startMillis),r=Math.min(e.endMillis,t.endMillis);return Xm(n,r)}),cU=e=>ws(e.endMillis-e.startMillis),aU=e=>Xm(e,Number.POSITIVE_INFINITY),Ib=Xm,AE=xE,uU=rU,lU=iU,fU=oU,hU=cU,dU=aU,pU="effect/ScheduleIntervals",Fb=Symbol.for(pU),NE=e=>({[Fb]:Fb,intervals:e}),mU=g(2,(e,t)=>gU(e.intervals,t.intervals,Oe())),gU=(e,t,n)=>{let r=e,s=t,i=n;for(;Mn(r)&&Mn(s);){const o=p(Bn(r),fU(Bn(s))),c=lU(o)?i:p(i,mt(o));p(Bn(r),uU(Bn(s)))?r=ir(r):s=ir(s),i=c}return NE(pr(i))},$d=e=>p(e.intervals,Pl,Pe(()=>AE)).startMillis,yU=e=>p(e.intervals,Pl,Pe(()=>AE)).endMillis,bU=g(2,(e,t)=>$d(e)<$d(t)),_U=e=>Mn(e.intervals),SU=NE,wU=mU,Td=$d,Id=yU,vU=bU,EU=_U,Zm="Continue",LE="Done",OU=e=>({_tag:Zm,intervals:e}),kU=e=>({_tag:Zm,intervals:SU(de(e))}),CU={_tag:LE},PU=e=>e._tag===Zm,RU=e=>e._tag===LE,$U=OU,DE=kU,vc=CU,Mb=PU,Ec=RU,Oc=Yv,TU=Lu,Xu=id,jE=la,UE=Yl,IU=ua;class FU{permits;waiters=new Set;taken=0;constructor(t){this.permits=t}get free(){return this.permits-this.taken}take=t=>im(n=>{if(this.free<t){const r=()=>{this.free<t||(this.waiters.delete(r),this.taken+=t,n(x(t)))};return this.waiters.add(r),I(()=>{this.waiters.delete(r)})}return this.taken+=t,n(x(t))});updateTaken=t=>oe(n=>(this.taken=t(this.taken),this.waiters.size>0&&n.getFiberRef(Dm).scheduleTask(()=>{const r=this.waiters.values();let s=r.next();for(;s.done===!1&&this.free>0;)s.value(),s=r.next()},n.getFiberRef(ho)),x(this.free)));release=t=>this.updateTaken(n=>n-t);releaseAll=this.updateTaken(t=>0);withPermits=t=>n=>xn(r=>T(r(this.take(t)),s=>wc(r(n),this.release(s))));withPermitsIfAvailable=t=>n=>xn(r=>G(()=>this.free<t?OL:(this.taken+=t,wc(r(pL(n)),this.release(t)))))}const BE=e=>new FU(e),MU=e=>I(()=>BE(e));class xU extends Vs{isOpen;waiters=[];scheduled=!1;constructor(t){super(),this.isOpen=t}commit(){return this.await}unsafeSchedule(t){return this.scheduled||this.waiters.length===0||(this.scheduled=!0,t.currentScheduler.scheduleTask(this.flushWaiters,t.getFiberRef(ho))),fe}flushWaiters=()=>{this.scheduled=!1;const t=this.waiters;this.waiters=[];for(let n=0;n<t.length;n++)t[n](Bt)};open=oe(t=>this.isOpen?fe:(this.isOpen=!0,this.unsafeSchedule(t)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=oe(t=>this.isOpen?fe:this.unsafeSchedule(t));await=im(t=>this.isOpen?t(fe):(this.waiters.push(t),I(()=>{const n=this.waiters.indexOf(t);n!==-1&&this.waiters.splice(n,1)})));unsafeClose(){this.isOpen=!1}close=I(()=>{this.isOpen=!1});whenOpen=t=>He(this.await,t)}const AU=e=>new xU(e??!1),NU=e=>I(()=>AU(e)),LU=g(2,(e,t)=>oe((n,r)=>{const s=t,i=OE(e,n,r.runtimeFlags,uf);if(s.state._tag==="Open"){const o=()=>Qc(a=>J(a,i.id())?fe:Zt(lm(i))),c={};s.state.finalizers.set(c,o),i.addObserver(()=>{s.state._tag!=="Closed"&&s.state.finalizers.delete(c)})}else i.unsafeInterruptAsFork(n.id());return x(i)})),DU=g(2,(e,t)=>p(Vn(e),IE(Vn(t)),n=>lo(n))),jU="effect/Ref/SynchronizedRef",KE=Symbol.for(jU),qE={_A:e=>e};class UU extends Vs{ref;withLock;[KE]=qE;[Rm]=$m;[Ji]=Ji;constructor(t,n){super(),this.ref=t,this.withLock=n,this.get=pn(this.ref)}get;commit(){return this.get}modify(t){return this.modifyEffect(n=>x(t(n)))}modifyEffect(t){return this.withLock(p(T(pn(this.ref),t),T(([n,r])=>Et(Si(this.ref,r),n))))}}const BU=e=>I(()=>zE(e)),zE=e=>{const t=Tm(e),n=BE(1);return new UU(t,n.withPermits(1))},Fd=Symbol.for("effect/ManagedRuntime"),KU="Fold",qU="Fresh",zU="FromEffect",VU="Scoped",HU="Suspend",WU="Provide",JU="ProvideMerge",QU="ZipWith",VE=xD,xb=AD,Hn=lm,HE=mc,Qr=Sc,yo=e=>function(){if(arguments.length===1){const t=arguments[0];return(n,...r)=>e(t,n,...r)}return e.apply(this,arguments)},fa=yo((e,t,n)=>{const r=tv(),s=[[_r,[[r,e.context]]]];n?.scheduler&&s.push([Dm,[[r,n.scheduler]]]);let i=VN(e.fiberRefs,{entries:s,forkAs:r});n?.updateRefs&&(i=n.updateRefs(i,r));const o=new vE(r,i,e.runtimeFlags);let c=t;n?.scope&&(c=T(UE(n.scope,ra),u=>He(Yv(u,Qc(l=>J(l,o.id())?fe:mc(o,l))),$s(t,l=>Xu(u,l)))));const a=o.currentSupervisor;return a!==pf&&(a.onStart(e.context,c,A(),o),o.addObserver(u=>a.onEnd(u,o))),uf.add(e.runtimeFlags,o),n?.immediate===!1?o.resume(c):o.start(c),o}),Md=yo((e,t,n={})=>{const r=fa(e,t,n);return n.onExit&&r.addObserver(s=>{n.onExit(s)}),(s,i)=>Md(e)(p(r,HE(s??Cs)),{...i,onExit:i?.onExit?o=>i.onExit(wA(o)):void 0})}),WE=yo((e,t)=>{const n=eg(e)(t);if(n._tag==="Failure")throw JE(n.effect_instruction_i0);return n.effect_instruction_i0});class GU extends Error{fiber;_tag="AsyncFiberException";constructor(t){super(`Fiber #${t.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=t,this.name=this._tag,this.stack=this.message}}const YU=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new GU(e);return Error.stackTraceLimit=t,n},th=Symbol.for("effect/Runtime/FiberFailure"),Fa=Symbol.for("effect/Runtime/FiberFailure/Cause");class XU extends Error{[th];[Fa];constructor(t){const n=Fv(t)[0];super(n?.message||"An error has occurred"),this[th]=th,this[Fa]=t,this.name=n?`(FiberFailure) ${n.name}`:"FiberFailure",n?.stack&&(this.stack=n.stack)}toJSON(){return{_id:"FiberFailure",cause:this[Fa].toJSON()}}toString(){return"(FiberFailure) "+zr(this[Fa],{renderErrorCause:!0})}[_e](){return this.toString()}}const JE=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new XU(e);return Error.stackTraceLimit=t,n},QE=e=>{const t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return cd(t.left);case"Right":return Ee(t.right);case"Some":return Ee(t.value);case"None":return cd(hm())}},eg=yo((e,t)=>{const n=QE(t);if(n)return n;const r=new X0,s=fa(e)(t,{scheduler:r});r.flush();const i=s.unsafePoll();return i||Zv(om(YU(s),bm(s)))}),GE=yo((e,t,n)=>gf(e,t,n).then(r=>{switch(r._tag){case nt:return r.effect_instruction_i0;case tt:throw JE(r.effect_instruction_i0)}})),gf=yo((e,t,n)=>new Promise(r=>{const s=QE(t);s&&r(s);const i=fa(e)(t);i.addObserver(o=>{r(o)}),n?.signal!==void 0&&(n.signal.aborted?i.unsafeInterruptAsFork(i.id()):n.signal.addEventListener("abort",()=>{i.unsafeInterruptAsFork(i.id())},{once:!0}))}));class YE{context;runtimeFlags;fiberRefs;constructor(t,n,r){this.context=t,this.runtimeFlags=n,this.fiberRefs=r}pipe(){return B(this,arguments)}}const ZU=e=>new YE(e.context,e.runtimeFlags,e.fiberRefs),XE=()=>oe((e,t)=>x(new YE(e.getFiberRef(_r),t.runtimeFlags,e.getFiberRefs()))),eB=yv(Bs,mv,pv),Ur=ZU({context:Fi(),runtimeFlags:eB,fiberRefs:HN()}),xd=fa(Ur),nh=GE(Ur),tB=gf(Ur),Ad=WE(Ur),nB=eg(Ur),rB=g(2,(e,t)=>e.modifyEffect(t)),sB="effect/Layer",ZE=Symbol.for(sB),iB={_RIn:e=>e,_E:e=>e,_ROut:e=>e},Fs={[ZE]:iB,pipe(){return B(this,arguments)}},oB="effect/Layer/MemoMap",rh=Symbol.for(oB),cB=Kc()("effect/Layer/CurrentMemoMap",{defaultValue:()=>tO()}),aB=e=>z(e,ZE),uB=e=>e._op_layer===qU;class eO{ref;[rh];constructor(t){this.ref=t,this[rh]=rh}getOrElseMemoize(t,n){return p(rB(this.ref,r=>{const s=r.get(t);if(s!==void 0){const[i,o]=s,c=p(i,T(([a,u])=>p(EL(a),Et(u))),$s(Zl({onFailure:()=>fe,onSuccess:()=>Lu(n,o)})));return x([c,r])}return p(Uu(0),T(i=>p(ta(),T(o=>p(Uu(()=>fe),W(c=>{const a=xn(l=>p(ua(),T(f=>p(l(T(sO(t,f,!0),h=>gL(h(this)))),Vn,T(h=>{switch(h._tag){case tt:return p(t0(o,h.effect_instruction_i0),He(id(f,h)),He(qe(h.effect_instruction_i0)));case nt:return p(Si(c,d=>p(id(f,d),Wl(O0(i,m=>[m===1,m-1])),Zt)),He(Bu(i,d=>d+1)),He(Lu(n,d=>p(I(()=>r.delete(t)),He(pn(c)),T(m=>m(d))))),He(na(o,h.effect_instruction_i0)),Et(h.effect_instruction_i0[1]))}}))))),u=[p(Qn(o),$s(ad({onFailure:()=>fe,onSuccess:()=>Bu(i,l=>l+1)}))),l=>p(pn(c),T(f=>f(l)))];return[a,uB(t)?r:r.set(t,u)]}))))))}),lo)}}const lB=G(()=>W(BU(new Map),e=>new eO(e))),tO=()=>new eO(zE(new Map)),nO=g(2,(e,t)=>T(lB,n=>rO(e,n,t))),rO=g(3,(e,t,n)=>T(sO(e,n),r=>N0(r(t),cB,t))),sO=(e,t,n=!1)=>{const r=e;switch(r._op_layer){case"Locally":return I(()=>s=>r.f(s.getOrElseMemoize(r.self,t)));case"ExtendScope":return I(()=>s=>kE(i=>s.getOrElseMemoize(r.layer,i)));case"Fold":return I(()=>s=>p(s.getOrElseMemoize(r.layer,t),Xt({onFailure:i=>s.getOrElseMemoize(r.failureK(i),t),onSuccess:i=>s.getOrElseMemoize(r.successK(i),t)})));case"Fresh":return I(()=>s=>p(r.layer,nO(t)));case"FromEffect":return I(n?()=>s=>r.effect:()=>s=>s.getOrElseMemoize(e,t));case"Provide":return I(()=>s=>p(s.getOrElseMemoize(r.first,t),T(i=>p(s.getOrElseMemoize(r.second,t),po(i)))));case"Scoped":return I(n?()=>s=>la(r.effect,t):()=>s=>s.getOrElseMemoize(e,t));case"Suspend":return I(()=>s=>s.getOrElseMemoize(r.evaluate(),t));case"ProvideMerge":return I(()=>s=>p(s.getOrElseMemoize(r.first,t),Vv(s.getOrElseMemoize(r.second,t),r.zipK)));case"ZipWith":return I(()=>s=>p(s.getOrElseMemoize(r.first,t),aa(s.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})))}},fB=()=>ha(n0()),hB=e=>iO(FE(e)),iO=e=>ha(qe(e)),dB=g(2,(e,t)=>mB(e,{onFailure:hB,onSuccess:t})),Ab=g(2,(e,t)=>{const n=Cl(e),r=n?e:t;return ha(W(n?t:e,i=>Bc(r,i)))});function ha(e){const t=Object.create(Fs);return t._op_layer=zU,t.effect=e,t}const pB=g(2,(e,{onFailure:t,onSuccess:n})=>{const r=Object.create(Fs);return r._op_layer=KU,r.layer=e,r.failureK=t,r.successK=n,r}),mB=g(2,(e,{onFailure:t,onSuccess:n})=>pB(e,{onFailure:r=>{const s=mf(r);switch(s._tag){case"Left":return t(s.left);case"Right":return iO(s.right)}},onSuccess:n})),gB=g(2,(e,t)=>SB(e,t,(n,r)=>io(n,r))),tg=(...e)=>{let t=e[0];for(let n=1;n<e.length;n++)t=gB(t,e[n]);return t},Nb=g(2,(e,t)=>{const n=Cl(e),r=n?e:t;return cO(W(n?t:e,i=>Bc(r,i)))}),oO=e=>cO(p(e,Et(Fi()))),cO=e=>{const t=Object.create(Fs);return t._op_layer=VU,t.effect=e,t},yB=g(2,(e,t)=>{const n=Cl(e);return ha(x(Bc(n?e:t,n?t:e)))}),aO=e=>{const t=Object.create(Fs);return t._op_layer=HU,t.evaluate=e,t},bB=g(2,(e,t)=>{const n=Cl(e),r=n?e:t,s=n?t:e;return ha(I(()=>Bc(r,s())))}),_B=g(2,(e,t)=>T(kE(n=>rO(e,t,n)),n=>p(XE(),po(n)))),Nd=g(2,(e,t)=>aO(()=>{const n=Object.create(Fs);return n._op_layer=WU,n.first=Object.create(Fs,{_op_layer:{value:JU,enumerable:!0},first:{value:fB(),enumerable:!0},second:{value:Array.isArray(t)?tg(...t):t},zipK:{value:(r,s)=>p(r,io(s))}}),n.second=e,n})),SB=g(3,(e,t,n)=>aO(()=>{const r=Object.create(Fs);return r._op_layer=QU,r.first=e,r.second=t,r.zipK=n,r})),Lb=g(2,(e,t)=>CE(n=>T(nO(t,n),r=>ym(e,r)))),Db=g(2,(e,t)=>{const n=bc(Ur.fiberRefs,t.fiberRefs),r=ls(Ur.runtimeFlags,t.runtimeFlags);return xn(s=>oe(i=>{const o=i.getFiberRef(_r),c=i.getFiberRefs(),a=_c(i.id(),c)(n),u=i.currentRuntimeFlags,l=bi(r)(u),f=bc(a,c),h=ls(l,u);return i.setFiberRefs(a),i.currentRuntimeFlags=l,wc(ym(s(e),io(o,t.context)),oe(d=>(d.setFiberRefs(_c(d.id(),d.getFiberRefs())(f)),d.currentRuntimeFlags=bi(h)(d.currentRuntimeFlags),fe)))}))}),wB=g(2,(e,t)=>Array.isArray(t)?Lb(e,tg(...t)):aB(t)?Lb(e,t):VI(t)?ym(e,t):Fd in t?T(t.runtimeEffect,n=>Db(e,n)):Db(e,t)),vB=function(){const e=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends fm{constructor(n){super(n?.message,n?.cause?{cause:n.cause}:void 0),n&&(Object.assign(this,n),Object.defineProperty(this,e,{value:n,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}.BaseEffectError}(),EB=e=>{const t={BaseEffectError:class extends vB{_tag=e}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError},Ld=Symbol.for("effect/DateTime"),uO={[Ld]:Ld,pipe(){return B(this,arguments)},[_e](){return this.toString()},toJSON(){return yf(this).toJSON()}},OB={...uO,_tag:"Utc",[ee](){return ke(this,Ac(this.epochMillis))},[X](e){return da(e)&&e._tag==="Utc"&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${yf(this).toJSON()})`}},kB={...uO,_tag:"Zoned",[ee](){return p(Ac(this.epochMillis),ie(K(this.zone)),ke(this))},[X](e){return da(e)&&e._tag==="Zoned"&&this.epochMillis===e.epochMillis&&J(this.zone,e.zone)},toString(){return`DateTime.Zoned(${zB(this)})`}},lO=(e,t,n)=>{const r=Object.create(kB);return r.epochMillis=e,r.zone=t,Object.defineProperty(r,"partsUtc",{value:n,enumerable:!1,writable:!0}),Object.defineProperty(r,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(r,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),r},da=e=>z(e,Ld),CB=e=>da(e[0]),PB=e=>e._tag==="Utc",RB=ml((e,t)=>e.epochMillis===t.epochMillis),ng=e=>{const t=Object.create(OB);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},Uo=e=>{const t=e.getTime();if(Number.isNaN(t))throw new eU("Invalid date");return ng(t)},$B=e=>{if(da(e))return e;if(e instanceof Date)return Uo(e);if(typeof e=="object"){const t=new Date(0);return AB(t,e),Uo(t)}else if(typeof e=="string"&&!TB(e))return Uo(new Date(e+"Z"));return Uo(new Date(e))},TB=e=>/Z|[+-]\d{2}$|[+-]\d{2}:\d{2}$|\]$/.test(e),IB=()=>ng(Date.now()),yf=e=>new Date(e.epochMillis),rg=e=>{if(e._tag==="Utc")return new Date(e.epochMillis);if(e.zone._tag==="Offset")return new Date(e.epochMillis+e.zone.offset);if(e.adjustedEpochMillis!==void 0)return new Date(e.adjustedEpochMillis);const t=e.zone.format.formatToParts(e.epochMillis).filter(r=>r.type!=="literal"),n=new Date(0);return n.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),n.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=n.getTime(),n},fO=e=>rg(e).getTime()-xB(e),FB=e=>{const t=Math.abs(e);let n=Math.floor(t/(60*60*1e3)),r=Math.round(t%(60*60*1e3)/(60*1e3));return r===60&&(n+=1,r=0),`${e<0?"-":"+"}${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`},MB=e=>FB(fO(e)),xB=e=>e.epochMillis,AB=(e,t)=>{if(t.year!==void 0&&e.setUTCFullYear(t.year),t.month!==void 0&&e.setUTCMonth(t.month-1),t.day!==void 0&&e.setUTCDate(t.day),t.weekDay!==void 0){const n=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+n)}t.hours!==void 0&&e.setUTCHours(t.hours),t.minutes!==void 0&&e.setUTCMinutes(t.minutes),t.seconds!==void 0&&e.setUTCSeconds(t.seconds),t.millis!==void 0&&e.setUTCMilliseconds(t.millis)},NB=(e,t)=>{const n=t._tag==="Offset"?t.offset:jB(e,t);return lO(e-n,t)},LB=/([+-])(\d{2}):(\d{2})$/,DB=e=>{const t=LB.exec(e);if(t===null)return null;const[,n,r,s]=t;return(n==="+"?1:-1)*(Number(r)*60+Number(s))*60*1e3},jB=(e,t)=>{const n=t.format.formatToParts(e).find(s=>s.type==="timeZoneName")?.value??"";if(n==="GMT")return 0;const r=DB(n);return r===null?fO(lO(e,t)):r},UB=g(2,(e,t)=>{if(e._tag==="Utc"){const s=yf(e);return t(s),ng(s.getTime())}const n=rg(e),r=new Date(n.getTime());return t(r),NB(r.getTime(),e.zone)}),Ma=(e,t)=>{e.setTime(e.getTime()+t)},BB=g(2,(e,t)=>UB(e,n=>{if(t.millis&&Ma(n,t.millis),t.seconds&&Ma(n,t.seconds*1e3),t.minutes&&Ma(n,t.minutes*60*1e3),t.hours&&Ma(n,t.hours*60*60*1e3),t.days&&n.setUTCDate(n.getUTCDate()+t.days),t.weeks&&n.setUTCDate(n.getUTCDate()+t.weeks*7),t.months){const r=n.getUTCDate();n.setUTCMonth(n.getUTCMonth()+t.months+1,0),r<n.getUTCDate()&&n.setUTCDate(r)}if(t.years){const r=n.getUTCDate(),s=n.getUTCMonth();n.setUTCFullYear(n.getUTCFullYear()+t.years,s+1,0),r<n.getUTCDate()&&n.setUTCDate(r)}})),KB=g(CB,(e,t)=>new Intl.DateTimeFormat(t?.locale,t).format(e.epochMillis)),qB=e=>yf(e).toISOString(),jb=e=>{const t=rg(e);return e._tag==="Utc"?t.toISOString():`${t.toISOString().slice(0,-1)}${MB(e)}`},zB=e=>e.zone._tag==="Offset"?jb(e):`${jb(e)}[${e.zone.id}]`,Ub=AN,VB="effect/Schedule",hO=Symbol.for(VB),dO=e=>z(e,hO),HB="effect/ScheduleDriver",WB=Symbol.for(HB),Dd={start:0,now:0,input:void 0,elapsed:xi,elapsedSincePrevious:xi,recurrence:0},Zu=Kc()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>Dd}),JB={_Out:e=>e,_In:e=>e,_R:e=>e},QB={_Out:e=>e,_In:e=>e,_R:e=>e};class GB{initial;step;[hO]=JB;constructor(t,n){this.initial=t,this.step=n}pipe(){return B(this,arguments)}}const Bb=(e,t,n)=>Bu(e,r=>r.recurrence===0?{now:t,input:n,recurrence:r.recurrence+1,elapsed:xi,elapsedSincePrevious:xi,start:t}:{now:t,input:n,recurrence:r.recurrence+1,elapsed:ws(t-r.start),elapsedSincePrevious:ws(t-r.now),start:r.start});class YB{schedule;ref;[WB]=QB;constructor(t,n){this.schedule=t,this.ref=n}get state(){return W(pn(this.ref),t=>t[1])}get last(){return T(pn(this.ref),([t,n])=>{switch(t._tag){case"None":return ql(()=>new hm);case"Some":return x(t.value)}})}iterationMeta=Tm(Dd);get reset(){return Si(this.ref,[A(),this.schedule.initial]).pipe(Ql(Si(this.iterationMeta,Dd)))}next(t){return p(W(pn(this.ref),n=>n[1]),T(n=>p(LN,T(r=>p(G(()=>this.schedule.step(r,t,n)),T(([s,i,o])=>{const c=Si(this.ref,[N(i),s]);if(Ec(o))return c.pipe(He(Fe(A())));const a=Td(o.intervals)-r;if(a<=0)return c.pipe(He(Bb(this.iterationMeta,r,t)),Et(i));const u=ws(a);return p(c,He(Bb(this.iterationMeta,r,t)),He(L0(u)),Et(i))}))))))}}const bo=(e,t)=>new GB(e,t),pO=g(2,(e,t)=>XB(e,n=>I(()=>t(n)))),XB=g(2,(e,t)=>sK(e,(n,r)=>W(t(n),s=>SF(r,Yt(s))))),ZB=g(2,(e,t)=>sg(e,(n,r)=>I(()=>t(n,r)))),sg=g(2,(e,t)=>bo(e.initial,(n,r,s)=>T(e.step(n,r,s),([i,o,c])=>Ec(c)?x([i,o,vc]):W(t(r,o),a=>a?[i,o,c]:[i,o,vc])))),eK=e=>pO(e,t=>t),ig=e=>p(Uu([A(),e.initial]),W(t=>new YB(e,t))),tK=(e,t=2)=>{const n=Yt(e);return eK(gO(pa,r=>_F(n,Math.pow(t,r))))},mO=g(2,(e,t)=>nK(e,t,wU)),nK=g(3,(e,t,n)=>bo([e.initial,t.initial],(r,s,i)=>p(Vv(e.step(r,s,i[0]),t.step(r,s,i[1]),(o,c)=>[o,c]),T(([[o,c,a],[u,l,f]])=>Mb(a)&&Mb(f)?jd(e,t,s,o,c,a.intervals,u,l,f.intervals,n):x([[o,u],[c,l],vc]))))),jd=(e,t,n,r,s,i,o,c,a,u)=>{const l=u(i,a);return EU(l)?x([[r,o],[s,c],$U(l)]):p(i,vU(a))?T(e.step(Id(i),n,r),([f,h,d])=>Ec(d)?x([[f,o],[h,c],vc]):jd(e,t,n,f,h,d.intervals,o,c,a,u)):T(t.step(Id(a),n,o),([f,h,d])=>Ec(d)?x([[r,f],[s,h],vc]):jd(e,t,n,r,s,i,f,h,d.intervals,u))},gO=g(2,(e,t)=>rK(e,n=>I(()=>t(n)))),rK=g(2,(e,t)=>bo(e.initial,(n,r,s)=>T(e.step(n,r,s),([i,o,c])=>W(t(o),a=>[i,a,c])))),sK=g(2,(e,t)=>bo(e.initial,(n,r,s)=>T(e.step(n,r,s),([i,o,c])=>{if(Ec(c))return x([i,o,c]);const a=c.intervals,u=hU(Ib(n,Td(a)));return W(t(o,u),l=>{const f=Yt(l),h=Td(a),d=n+vs(f),m=d-h,y=Math.max(0,Id(a)+m),b=Ib(d,y);return[i,o,DE(b)]})}))),iK=e=>bo(e.initial,(t,n,r)=>p(e.step(t,n,r),W(([s,i,o])=>[s,n,o]))),yO=e=>aK(pa,t=>t<e),oK=e=>pO(pa,()=>e),cK=(e,t)=>bo(e,(n,r,s)=>I(()=>[t(s),s,DE(dU(n))])),bO=g(2,(e,t)=>sg(e,(n,r)=>vL(t(n)))),_O=g(2,(e,t)=>sg(e,(n,r)=>t(n))),aK=g(2,(e,t)=>ZB(e,(n,r)=>t(r))),Xa=Symbol.for("effect/Schedule/ScheduleDefect");class uK{error;[Xa];constructor(t){this.error=t,this[Xa]=Xa}}const lK=e=>z(e,Xa),el=e=>zi(e,t=>Vi(new uK(t))),fK=e=>we(rm(e,t=>kv(t)&&lK(t.defect)?N(t.defect):A()),{onNone:()=>e,onSome:t=>Ar(t.error)}),SO=e=>jv(e,t=>qe(fK(t))),Kb=g(2,(e,t)=>dK(e,t,(n,r)=>Fe(n))),hK=g(2,(e,t)=>{if(dO(t))return Kb(e,t);const n=t.schedule??iK(pa),r=t.while?_O(n,o=>{const c=t.while(o);return typeof c=="boolean"?x(c):el(c)}):n,s=t.until?bO(r,o=>{const c=t.until(o);return typeof c=="boolean"?x(c):el(c)}):r,i=t.times?mO(s,yO(t.times)).pipe(gO(o=>o[0])):s;return SO(Kb(e,i))}),dK=g(3,(e,t,n)=>T(ig(t),r=>mr(e,{onFailure:s=>n(s,A()),onSuccess:s=>wO(Ku(e,Zu,pn(r.iterationMeta)),r,(i,o)=>Ku(n(i,o),Zu,pn(r.iterationMeta)),s)}))),wO=(e,t,n,r)=>mr(t.next(r),{onFailure:()=>qv(t.last),onSuccess:s=>mr(e,{onFailure:i=>n(i,N(s)),onSuccess:i=>wO(e,t,n,i)})}),qb=g(2,(e,t)=>gK(e,t,(n,r)=>Fe(n))),pK=g(2,(e,t)=>dO(t)?qb(e,t):SO(qb(e,mK(t)))),mK=e=>{const t=e.schedule??pa,n=e.while?_O(t,s=>{const i=e.while(s);return typeof i=="boolean"?x(i):el(i)}):t,r=e.until?bO(n,s=>{const i=e.until(s);return typeof i=="boolean"?x(i):el(i)}):n;return e.times?mO(r,yO(e.times)):r},gK=g(3,(e,t,n)=>T(ig(t),r=>vO(Ku(e,Zu,pn(r.iterationMeta)),r,(s,i)=>Ku(n(s,i),Zu,pn(r.iterationMeta))))),vO=(e,t,n)=>zi(e,r=>mr(t.next(r),{onFailure:()=>p(t.last,qv,T(s=>n(r,s))),onSuccess:()=>vO(e,t,n)})),pa=cK(0,e=>e+1),gr=Yn,tl=Wm,Wn=Gi,zb=oe,nl=Fe,Tn=qe,yK=Vi,EO=nd,Jt=k1,We=x,Re=G,De=I,ce=fe,OO=zi,og=jv,sh=mL,bK=_L,_K=pK,SK=PL,Xs=st,zt=cm,Bo=qs,cg=xn,hs=Et,ag=Zt,te=W,wK=am,bf=Hl,vK=Hm,EK=Lv,ai=wc,OK=PE,Ud=CE,kK=Qc,ds=Qm,$t=LU,Vb=L0,Bd=wB,Zs=Hi,Ze=Vn,kO=S1,CO=$L,q=T,nr=lo,ih=IE,CK=DU,ug=TE,PK=Yc,_f=CL,lg=yL,Hb=hK,PO=x0,kc=Bv,Cn=Xt,RO=SL,RK=wL,$O=XE,fg=MU,$K=NU,TK=xd,IK=Ad,Kd=jj,TO=Uj,se=Bj,Sf=aa,FK=FL,MK=e=>{const t=new Map;return new Proxy(e,{get(n,r,s){if(r in n)return Reflect.get(n,r,s);if(t.has(r))return t.get(r);const i=(...c)=>jo(n,a=>typeof a[r]=="function"?(t.set(r,(...u)=>jo(n,l=>l[r](...u))),a[r](...c)):(t.set(r,jo(n,u=>u[r])),a[r])),o=jo(n,c=>c[r]);return Object.assign(i,o),Object.setPrototypeOf(i,Object.getPrototypeOf(o)),t.set(r,i),i}})},IO=function(){return function(){const[e,t]=arguments,n="accessors"in t?t.accessors:!1,r=Error.stackTraceLimit;Error.stackTraceLimit=2;const s=new Error;Error.stackTraceLimit=r;let i="unchecked";const o=function(f){if(i==="unchecked"){const h=Object.getPrototypeOf(f);if(h===Object.prototype||h===null)i="plain";else{const d=Object.getPrototypeOf(this);Object.setPrototypeOf(d,h),i="patched"}}if(i==="plain")Object.assign(this,f);else if(i==="patched")return Object.setPrototypeOf(f,Object.getPrototypeOf(this)),f};o.prototype._tag=e,Object.defineProperty(o,"make",{get(){return f=>new this(f)}}),Object.defineProperty(o,"use",{get(){return f=>jo(this,f)}}),o.key=e,Object.assign(o,Ap),Object.defineProperty(o,"stack",{get(){return s.stack}});const c="dependencies"in t&&t.dependencies.length>0,a=c?"DefaultWithoutDependencies":"Default";let u,l=!1;if("effect"in t?(l=typeof t.effect=="function",Object.defineProperty(o,a,{get(){return l?(function(){return Ab(o,te(t.effect.apply(null,arguments),f=>new this(f)))}).bind(this):u??=Ab(o,te(t.effect,f=>new this(f)))}})):"scoped"in t?(l=typeof t.scoped=="function",Object.defineProperty(o,a,{get(){return l?(function(){return Nb(o,te(t.scoped.apply(null,arguments),f=>new this(f)))}).bind(this):u??=Nb(o,te(t.scoped,f=>new this(f)))}})):"sync"in t?Object.defineProperty(o,a,{get(){return u??=bB(o,()=>new this(t.sync()))}}):Object.defineProperty(o,a,{get(){return u??=yB(o,new this(t.succeed))}}),c){let f;Object.defineProperty(o,"Default",{get(){return l?function(){return Nd(this.DefaultWithoutDependencies.apply(null,arguments),t.dependencies)}:f??=Nd(this.DefaultWithoutDependencies,t.dependencies)}})}return n===!0?MK(o):o}},xK=e=>oO($E(Vm,yi(e))),AK=e=>oO($E(Vm,Qp(e))),NK=g(2,(e,t)=>dB(AK(e),()=>xK(t))),LK=tg,DK=Nd,jK="effect/QueueEnqueue",FO=Symbol.for(jK),UK="effect/QueueDequeue",hg=Symbol.for(UK),BK="effect/QueueStrategy",dg=Symbol.for(BK),KK="effect/BackingQueue",qK=Symbol.for(KK),pg={_A:e=>e},zK={_A:e=>e},MO={_In:e=>e},mg={_Out:e=>e};class VK extends Vs{queue;takers;shutdownHook;shutdownFlag;strategy;[FO]=MO;[hg]=mg;constructor(t,n,r,s,i){super(),this.queue=t,this.takers=n,this.shutdownHook=r,this.shutdownFlag=s,this.strategy=i}pipe(){return B(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return G(()=>zi(this.unsafeSize(),()=>st))}unsafeSize(){return ae(this.shutdownFlag)?A():N(this.queue.length()-Em(this.takers)+this.strategy.surplusSize())}get isEmpty(){return W(this.size,t=>t<=0)}get isFull(){return W(this.size,t=>t>=this.capacity())}get shutdown(){return qs(oe(t=>(p(this.shutdownFlag,Us(!0)),p(fr(vi(this.takers),n=>gm(n,t.id()),!1,!1),He(this.strategy.shutdown),Wl(na(this.shutdownHook,void 0)),Zt))))}get isShutdown(){return I(()=>ae(this.shutdownFlag))}get awaitShutdown(){return Qn(this.shutdownHook)}isActive(){return!ae(this.shutdownFlag)}unsafeOffer(t){if(ae(this.shutdownFlag))return!1;let n;if(this.queue.length()===0){const s=p(this.takers,lr(Me));s!==Me?(ps(s,t),n=!0):n=!1}else n=!1;if(n)return!0;const r=this.queue.offer(t);return es(this.strategy,this.queue,this.takers),r}offer(t){return G(()=>{if(ae(this.shutdownFlag))return st;let n;if(this.queue.length()===0){const s=p(this.takers,lr(Me));s!==Me?(ps(s,t),n=!0):n=!1}else n=!1;if(n)return x(!0);const r=this.queue.offer(t);return es(this.strategy,this.queue,this.takers),r?x(!0):this.strategy.handleSurplus([t],this.queue,this.takers,this.shutdownFlag)})}offerAll(t){return G(()=>{if(ae(this.shutdownFlag))return st;const n=ye(t),r=this.queue.length()===0?ye(uq(this.takers,n.length)):Fr,[s,i]=p(n,LS(r.length));for(let c=0;c<r.length;c++){const a=r[c],u=s[c];ps(a,u)}if(i.length===0)return x(!0);const o=this.queue.offerAll(i);return es(this.strategy,this.queue,this.takers),qc(o)?x(!0):this.strategy.handleSurplus(o,this.queue,this.takers,this.shutdownFlag)})}get take(){return oe(t=>{if(ae(this.shutdownFlag))return st;const n=this.queue.poll(Me);if(n!==Me)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),x(n);{const r=ea(t.id());return p(G(()=>(p(this.takers,Wi(r)),es(this.strategy,this.queue,this.takers),ae(this.shutdownFlag)?st:Qn(r))),Gc(()=>I(()=>lq(this.takers,r))))}})}get takeAll(){return G(()=>ae(this.shutdownFlag)?st:I(()=>{const t=this.queue.pollUpTo(Number.POSITIVE_INFINITY);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),Mi(t)}))}takeUpTo(t){return G(()=>ae(this.shutdownFlag)?st:I(()=>{const n=this.queue.pollUpTo(t);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),Mi(n)}))}takeBetween(t,n){return G(()=>xO(this,t,n,Oe()))}}const xO=(e,t,n,r)=>n<t?x(r):p(nq(e,n),T(s=>{const i=t-s.length;return i===1?p(qd(e),W(o=>p(r,$e(s),cc(o)))):i>1?p(qd(e),T(o=>xO(e,i-1,n-s.length-1,p(r,$e(s),cc(o))))):x(p(r,$e(s)))})),HK=e=>p(I(()=>vm(e)),T(t=>wf(vf(t),sq()))),WK=e=>p(I(()=>vm(e)),T(t=>wf(vf(t),AO()))),JK=e=>p(I(()=>vm(e)),T(t=>wf(vf(t),iq()))),QK=()=>p(I(()=>nf()),T(e=>wf(vf(e),AO()))),GK=(e,t,n,r,s)=>new VK(e,t,n,r,s),wf=(e,t)=>p(ta(),W(n=>GK(e,nf(),n,js(!1),t)));class YK{mutable;[qK]=zK;constructor(t){this.mutable=t}poll(t){return lr(this.mutable,t)}pollUpTo(t){return rf(this.mutable,t)}offerAll(t){return Om(this.mutable,t)}offer(t){return Wi(this.mutable,t)}capacity(){return LA(this.mutable)}length(){return Em(this.mutable)}}const vf=e=>new YK(e),XK=e=>e.size,ZK=e=>e.isShutdown,eq=e=>e.shutdown,tq=g(2,(e,t)=>e.offer(t)),qd=e=>e.take,nq=g(2,(e,t)=>e.takeUpTo(t)),rq=g(3,(e,t,n)=>e.takeBetween(t,n)),sq=()=>new oq,AO=()=>new cq,iq=()=>new aq;class oq{[dg]=pg;putters=nf();surplusSize(){return Em(this.putters)}onCompleteTakersWithEmptyQueue(t){for(;!fs(this.putters)&&!fs(t);){const n=lr(t,void 0),r=lr(this.putters,void 0);r[2]&&ps(r[1],!0),ps(n,r[0])}}get shutdown(){return p(zl,T(t=>p(I(()=>vi(this.putters)),T(n=>fr(n,([r,s,i])=>i?p(gm(s,t),Zt):fe,!1,!1)))))}handleSurplus(t,n,r,s){return oe(i=>{const o=ea(i.id());return p(G(()=>(this.unsafeOffer(t,o),this.unsafeOnQueueEmptySpace(n,r),es(this,n,r),ae(s)?st:Qn(o))),Gc(()=>I(()=>this.unsafeRemove(o))))})}unsafeOnQueueEmptySpace(t,n){let r=!0;for(;r&&(t.capacity()===Number.POSITIVE_INFINITY||t.length()<t.capacity());){const s=p(this.putters,lr(Me));if(s===Me)r=!1;else{const i=t.offer(s[0]);i&&s[2]?ps(s[1],!0):i||rl(this.putters,p(vi(this.putters),mt(s))),es(this,t,n)}}}unsafeOffer(t,n){const r=ye(t);for(let s=0;s<r.length;s++){const i=r[s];s===r.length-1?p(this.putters,Wi([i,n,!0])):p(this.putters,Wi([i,n,!1]))}}unsafeRemove(t){rl(this.putters,p(vi(this.putters),Dp(([,n])=>n!==t)))}}let cq=class{[dg]=pg;surplusSize(){return 0}get shutdown(){return fe}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,n,r,s){return x(!1)}unsafeOnQueueEmptySpace(t,n){}};class aq{[dg]=pg;surplusSize(){return 0}get shutdown(){return fe}onCompleteTakersWithEmptyQueue(){}handleSurplus(t,n,r,s){return I(()=>(this.unsafeOffer(n,t),es(this,n,r),!0))}unsafeOnQueueEmptySpace(t,n){}unsafeOffer(t,n){const r=n[Symbol.iterator]();let s,i=!0;for(;!(s=r.next()).done&&i;){if(t.capacity()===0)return;t.poll(Me),i=t.offer(s.value)}}}const ps=(e,t)=>tf(e,x(t)),rl=(e,t)=>p(e,Om(t)),vi=e=>p(e,rf(Number.POSITIVE_INFINITY)),uq=(e,t)=>p(e,rf(t)),lq=(e,t)=>{rl(e,p(vi(e),Dp(n=>t!==n)))},es=(e,t,n)=>{let r=!0;for(;r&&t.length()!==0;){const s=p(n,lr(Me));if(s!==Me){const i=t.poll(Me);i!==Me?(ps(s,i),e.unsafeOnQueueEmptySpace(t,n)):rl(n,p(vi(n),mt(s))),r=!0}else r=!1}r&&t.length()===0&&!fs(n)&&e.onCompleteTakersWithEmptyQueue(n)},jn=Symbol.for("effect/PubSub/AbsentValue"),NO=(e,t)=>n=>{n.has(e)||n.set(e,new Set),n.get(e).add(t)},fq=(e,t)=>n=>{if(!n.has(e))return;const r=n.get(e);r.delete(t),r.size===0&&n.delete(e)},hq=e=>G(()=>{const t=gq(e);return Eq(t,new Tq)}),dq=e=>e.shutdown,pq=g(2,(e,t)=>e.publish(t)),mq=e=>e.subscribe,gq=e=>new _q(e?.replay?new Mq(e.replay):void 0),yq=(e,t,n)=>W(ta(),r=>bq(e,t,e.subscribe(),nf(),r,js(!1),n)),bq=(e,t,n,r,s,i,o)=>new wq(e,t,n,r,s,i,o,e.replayWindow());class _q{replayBuffer;publisherHead={value:jn,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(t){this.replayBuffer=t}replayWindow(){return this.replayBuffer?new xq(this.replayBuffer):Aq}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(t){const n=this.publisherTail.subscribers;return n!==0&&(this.publisherTail.next={value:t,subscribers:n,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.publisherTail.subscribers!==0)for(const n of t)this.publish(n);else this.replayBuffer&&this.replayBuffer.offerAll(t);return Oe()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=jn,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new Sq(this,this.publisherTail,this.publisherIndex,!1)}}class Sq{self;subscriberHead;subscriberIndex;unsubscribed;constructor(t,n,r,s){this.self=t,this.subscriberHead=n,this.subscriberIndex=r,this.unsubscribed=s}isEmpty(){if(this.unsubscribed)return!0;let t=!0,n=!0;for(;n;)this.subscriberHead===this.self.publisherTail?n=!1:this.subscriberHead.next.value!==jn?(t=!1,n=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return t}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;let n=!0,r=t;for(;n;)if(this.subscriberHead===this.self.publisherTail)n=!1;else{const s=this.subscriberHead.next.value;s!==jn&&(r=s,this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=jn,this.self.subscribersIndex+=1),n=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(t){const n=[],r=jn;let s=0;for(;s!==t;){const i=this.poll(r);i===r?s=t:(n.push(i),s+=1)}return Mi(n)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==jn&&(this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=jn,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}class wq extends Vs{pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[hg]=mg;constructor(t,n,r,s,i,o,c,a){super(),this.pubsub=t,this.subscribers=n,this.subscription=r,this.pollers=s,this.shutdownHook=i,this.shutdownFlag=o,this.strategy=c,this.replayWindow=a}commit(){return this.take}pipe(){return B(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!ae(this.shutdownFlag)}get size(){return G(()=>ae(this.shutdownFlag)?st:x(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return ae(this.shutdownFlag)?A():N(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return G(()=>ae(this.shutdownFlag)?st:x(this.subscription.size()===this.capacity()))}get isEmpty(){return W(this.size,t=>t===0)}get shutdown(){return qs(oe(t=>(Us(this.shutdownFlag,!0),p(Jm(gg(this.pollers),n=>gm(n,t.id()),!1),He(I(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),Wl(na(this.shutdownHook,void 0)),Zt))))}get isShutdown(){return I(()=>ae(this.shutdownFlag))}get awaitShutdown(){return Qn(this.shutdownHook)}get take(){return oe(t=>{if(ae(this.shutdownFlag))return st;if(this.replayWindow.remaining>0){const r=this.replayWindow.take();return x(r)}const n=fs(this.pollers)?this.subscription.poll(Me):Me;if(n===Me){const r=ea(t.id());return p(G(()=>(p(this.pollers,Wi(r)),p(this.subscribers,NO(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),ae(this.shutdownFlag)?st:Qn(r))),Gc(()=>I(()=>$q(this.pollers,r))))}else return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),x(n)})}get takeAll(){return G(()=>{if(ae(this.shutdownFlag))return st;const t=fs(this.pollers)?Cq(this.subscription):Oe();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0?x($e(this.replayWindow.takeAll(),t)):x(t)})}takeUpTo(t){return G(()=>{if(ae(this.shutdownFlag))return st;let n;if(this.replayWindow.remaining>=t){const s=this.replayWindow.takeN(t);return x(s)}else this.replayWindow.remaining>0&&(n=this.replayWindow.takeAll(),t=t-n.length);const r=fs(this.pollers)?Pq(this.subscription,t):Oe();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),x(n?$e(n,r):r)})}takeBetween(t,n){return G(()=>LO(this,t,n,Oe()))}}const LO=(e,t,n,r)=>n<t?x(r):p(e.takeUpTo(n),T(s=>{const i=t-s.length;return i===1?p(e.take,W(o=>p(r,$e(s),cc(o)))):i>1?p(e.take,T(o=>LO(e,i-1,n-s.length-1,p(r,$e(s),cc(o))))):x(p(r,$e(s)))}));class vq{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[FO]=MO;[hg]=mg;constructor(t,n,r,s,i,o){this.pubsub=t,this.subscribers=n,this.scope=r,this.shutdownHook=s,this.shutdownFlag=i,this.strategy=o}capacity(){return this.pubsub.capacity}get size(){return G(()=>ae(this.shutdownFlag)?st:I(()=>this.pubsub.size()))}unsafeSize(){return ae(this.shutdownFlag)?A():N(this.pubsub.size())}get isFull(){return W(this.size,t=>t===this.capacity())}get isEmpty(){return W(this.size,t=>t===0)}get awaitShutdown(){return Qn(this.shutdownHook)}get isShutdown(){return I(()=>ae(this.shutdownFlag))}get shutdown(){return qs(oe(t=>(p(this.shutdownFlag,Us(!0)),p(this.scope.close(e0(t.id())),He(this.strategy.shutdown),Wl(na(this.shutdownHook,void 0)),Zt))))}publish(t){return G(()=>ae(this.shutdownFlag)?st:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),x(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,de(t),this.shutdownFlag))}isActive(){return!ae(this.shutdownFlag)}unsafeOffer(t){return ae(this.shutdownFlag)?!1:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0):!1}publishAll(t){return G(()=>{if(ae(this.shutdownFlag))return st;const n=Rq(this.pubsub,t);return this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),qc(n)?x(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,n,this.shutdownFlag)})}get subscribe(){const t=Yc(Wm([this.scope.fork(ra),yq(this.pubsub,this.subscribers,this.strategy)]),n=>n[0].addFinalizer(()=>n[1].shutdown));return W(Hm(t,(n,r)=>n[0].close(r)),n=>n[1])}offer(t){return this.publish(t)}offerAll(t){return this.publishAll(t)}pipe(){return B(this,arguments)}}const Eq=(e,t)=>T(ua(),n=>W(ta(),r=>Oq(e,new Map,n,r,js(!1),t))),Oq=(e,t,n,r,s,i)=>new vq(e,t,n,r,s,i),kq=(e,t)=>{tf(e,x(t))},DO=(e,t)=>p(e,Om(t)),gg=e=>p(e,rf(Number.POSITIVE_INFINITY)),Cq=e=>e.pollUpTo(Number.POSITIVE_INFINITY),Pq=(e,t)=>e.pollUpTo(t),Rq=(e,t)=>e.publishAll(t),$q=(e,t)=>{DO(e,p(gg(e),Dp(n=>n!==t)))};class Tq{get shutdown(){return fe}handleSurplus(t,n,r,s){return x(!1)}unsafeOnPubSubEmptySpace(t,n){}unsafeCompletePollers(t,n,r,s){return Iq(this,t,n,r,s)}unsafeCompleteSubscribers(t,n){return Fq(this,t,n)}}const Iq=(e,t,n,r,s)=>{let i=!0;for(;i&&!r.isEmpty();){const o=p(s,lr(Me));if(o===Me)p(n,fq(r,s)),fs(s)?i=!1:p(n,NO(r,s));else{const c=r.poll(Me);c===Me?DO(s,p(gg(s),mt(o))):(kq(o,c),e.unsafeOnPubSubEmptySpace(t,n))}}},Fq=(e,t,n)=>{for(const[r,s]of n)for(const i of s)e.unsafeCompletePollers(t,n,r,i)};class Mq{capacity;constructor(t){this.capacity=t}head={value:jn,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(t){this.tail.value=t,this.tail.next={value:jn,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(t){for(const n of t)this.offer(n)}}class xq{buffer;head;index;remaining;constructor(t){this.buffer=t,this.index=t.index,this.remaining=t.size,this.head=t.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(this.remaining===0)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;const t=this.head.value;return this.head=this.head.next,t}takeN(t){if(this.remaining===0)return Oe();this.index<this.buffer.index&&this.fastForward();const n=Math.min(t,this.remaining),r=new Array(n);for(let s=0;s<n;s++){const i=this.head.value;this.head=this.head.next,r[s]=i}return this.remaining-=n,Fn(r)}takeAll(){return this.takeN(this.remaining)}}const Aq={remaining:0,take:()=>{},takeN:()=>Oe(),takeAll:()=>Oe()},Nq=hq,Wb=dq,Lq=pq,Jb=mq,Cc=HK,Dq=WK,jq=JK,yg=QK,Uq=XK,Bq=ZK,Ms=eq,wt=tq,sl=qd,Kq=rq,jO="Continue",qq="Close",zq="Yield",Vq="effect/ChannelChildExecutorDecision",Qb=Symbol.for(Vq),Hq={[Qb]:Qb},UO=e=>{const t=Object.create(Hq);return t._tag=jO,t},Za="ContinuationK",Wq="ContinuationFinalizer",BO=Symbol.for("effect/ChannelContinuation"),KO={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e};class bg{onSuccess;onHalt;_tag=Za;[BO]=KO;constructor(t,n){this.onSuccess=t,this.onHalt=n}onExit(t){return _m(t)?this.onHalt(t.cause):this.onSuccess(t.value)}}class Jq{finalizer;_tag=Wq;[BO]=KO;constructor(t){this.finalizer=t}}const qO="PullAfterNext",Qq="PullAfterAllEnqueued",Gq="effect/ChannelUpstreamPullStrategy",Yq=Symbol.for(Gq),Xq={_A:e=>e},Zq={[Yq]:Xq},zO=e=>{const t=Object.create(Zq);return t._tag=qO,t.emitSeparator=e,t},VO="BracketOut",HO="Bridge",_g="ConcatAll",WO="Emit",JO="Ensuring",QO="Fail",Sg="Fold",GO="FromEffect",YO="PipeTo",ez="Provide",XO="Read",ZO="Succeed",ek="SucceedNow",tk="Suspend",tz="effect/Channel",nk=Symbol.for(tz),nz={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},Nt={[nk]:nz,pipe(){return B(this,arguments)}},rk=e=>z(e,nk)||gr(e),rz=g(2,(e,t)=>{const n=Object.create(Nt);return n._tag=VO,n.acquire=()=>e,n.finalizer=t,n}),sz=g(2,(e,t)=>{const n=Object.create(Nt);return n._tag=Sg,n.channel=e,n.k=new bg(ms,t),n}),Gb=e=>ma(()=>{const t=[];return le(dt(e,sk(t)),n=>Of(()=>[Mi(t),n]))}),sk=e=>Ef({onInput:t=>le(Of(()=>{e.push(t)}),()=>sk(e)),onFailure:_o,onDone:Br}),ik=(e,t,n)=>{const r=Object.create(Nt);return r._tag=_g,r.combineInners=t,r.combineAll=n,r.onPull=()=>zO(A()),r.onEmit=()=>UO,r.value=()=>e,r.k=Z,r},iz=g(4,(e,t,n,r)=>{const s=Object.create(Nt);return s._tag=_g,s.combineInners=n,s.combineAll=r,s.onPull=()=>zO(A()),s.onEmit=()=>UO,s.value=()=>e,s.k=t,s}),wg=g(2,(e,t)=>{const n=Object.create(Nt);return n._tag=HO,n.input=t,n.channel=e,n}),oz=g(2,(e,t)=>{const n=Object.create(Nt);return n._tag=JO,n.channel=e,n.finalizer=t,n}),_o=e=>at(FE(e)),at=e=>cz(()=>e),cz=e=>{const t=Object.create(Nt);return t._tag=QO,t.error=e,t},le=g(2,(e,t)=>{const n=Object.create(Nt);return n._tag=Sg,n.channel=e,n.k=new bg(t,at),n}),ve=e=>{const t=Object.create(Nt);return t._tag=GO,t.effect=()=>e,t},dt=g(2,(e,t)=>{const n=Object.create(Nt);return n._tag=YO,n.left=()=>e,n.right=()=>t,n}),Ef=e=>Sr({onInput:e.onInput,onFailure:t=>ot(mf(t),{onLeft:e.onFailure,onRight:at}),onDone:e.onDone}),Sr=e=>{const t=Object.create(Nt);return t._tag=XO,t.more=e.onInput,t.done=new bg(e.onDone,e.onFailure),t},ms=e=>Of(()=>e),Br=e=>{const t=Object.create(Nt);return t._tag=ek,t.terminal=e,t},ma=e=>{const t=Object.create(Nt);return t._tag=tk,t.channel=e,t},Of=e=>{const t=Object.create(Nt);return t._tag=ZO,t.evaluate=e,t},Mt=Br(void 0),be=e=>{const t=Object.create(Nt);return t._tag=WO,t.out=e,t},ga="Done",ya="Emit",So="FromEffect",ba="Read",az=Symbol.for("effect/ChannelState"),uz={_E:e=>e,_R:e=>e},kf={[az]:uz},ei=()=>{const e=Object.create(kf);return e._tag=ga,e},oh=()=>{const e=Object.create(kf);return e._tag=ya,e},Mo=e=>{const t=Object.create(kf);return t._tag=So,t.effect=e,t},ch=(e,t,n,r)=>{const s=Object.create(kf);return s._tag=ba,s.upstream=e,s.onEffect=t,s.onEmit=n,s.onDone=r,s},il=e=>e._tag===So,lz=e=>il(e)?e.effect:ce,Yb=e=>il(e)?bK(e.effect):void 0,ok="PullFromChild",zd="PullFromUpstream",Vd="DrainChildExecutors",ck="Emit";class xa{childExecutor;parentSubexecutor;onEmit;_tag=ok;constructor(t,n,r){this.childExecutor=t,this.parentSubexecutor=n,this.onEmit=r}close(t){const n=this.childExecutor.close(t),r=this.parentSubexecutor.close(t);return n!==void 0&&r!==void 0?Sf(Ze(n),Ze(r),(s,i)=>p(s,gc(i))):n!==void 0?n:r!==void 0?r:void 0}enqueuePullFromChild(t){return this}}class Gr{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=zd;constructor(t,n,r,s,i,o,c,a){this.upstreamExecutor=t,this.createChild=n,this.lastDone=r,this.activeChildExecutors=s,this.combineChildResults=i,this.combineWithChildResult=o,this.onPull=c,this.onEmit=a}close(t){const n=this.upstreamExecutor.close(t),s=[...this.activeChildExecutors.map(i=>i!==void 0?i.childExecutor.close(t):void 0),n].reduce((i,o)=>i!==void 0&&o!==void 0?Sf(i,Ze(o),(c,a)=>gc(c,a)):i!==void 0?i:o!==void 0?Ze(o):void 0,void 0);return s}enqueuePullFromChild(t){return new Gr(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,t],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class ui{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=Vd;constructor(t,n,r,s,i,o,c){this.upstreamExecutor=t,this.lastDone=n,this.activeChildExecutors=r,this.upstreamDone=s,this.combineChildResults=i,this.combineWithChildResult=o,this.onPull=c}close(t){const n=this.upstreamExecutor.close(t),s=[...this.activeChildExecutors.map(i=>i!==void 0?i.childExecutor.close(t):void 0),n].reduce((i,o)=>i!==void 0&&o!==void 0?Sf(i,Ze(o),(c,a)=>gc(c,a)):i!==void 0?i:o!==void 0?Ze(o):void 0,void 0);return s}enqueuePullFromChild(t){return new ui(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,t],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class ah{value;next;_tag=ck;constructor(t,n){this.value=t,this.next=n}close(t){const n=this.next.close(t);return n}enqueuePullFromChild(t){return this}}const fz="Pulled",hz="NoUpstream",dz="effect/ChannelUpstreamPullRequest",pz=Symbol.for(dz),mz={_A:e=>e},ak={[pz]:mz},Xb=e=>{const t=Object.create(ak);return t._tag=fz,t.value=e,t},gz=e=>{const t=Object.create(ak);return t._tag=hz,t.activeDownstreamCount=e,t};class ts{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(t,n,r){this._currentChannel=t,this._executeCloseLastSubstream=r,this._providedEnv=n}run(){let t;for(;t===void 0;)if(this._cancelled!==void 0)t=this.processCancellation();else if(this._activeSubexecutor!==void 0)t=this.runSubexecutor();else try{if(this._currentChannel===void 0)t=ei();else switch(gr(this._currentChannel)&&(this._currentChannel=ve(this._currentChannel)),this._currentChannel._tag){case VO:{t=this.runBracketOut(this._currentChannel);break}case HO:{const n=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,this._input!==void 0){const r=this._input;this._input=void 0;const s=()=>q(n.awaitRead(),()=>Re(()=>{const i=r.run();switch(i._tag){case ga:return Kn(r.getDone(),{onFailure:o=>n.error(o),onSuccess:o=>n.done(o)});case ya:return q(n.emit(r.getEmit()),()=>s());case So:return Cn(i.effect,{onFailure:o=>n.error(o),onSuccess:()=>s()});case ba:return vg(i,()=>s(),o=>n.error(o))}}));t=Mo(q(ds(zt(s())),i=>De(()=>this.addFinalizer(o=>q(Hn(i),()=>Re(()=>{const c=this.restorePipe(o,r);return c!==void 0?c:ce}))))))}break}case _g:{const n=new ts(this._currentChannel.value(),this._providedEnv,s=>De(()=>{const i=this._closeLastSubstream===void 0?ce:this._closeLastSubstream;this._closeLastSubstream=p(i,se(s))}));n._input=this._input;const r=this._currentChannel;this._activeSubexecutor=new Gr(n,s=>r.k(s),void 0,[],(s,i)=>r.combineInners(s,i),(s,i)=>r.combineAll(s,i),s=>r.onPull(s),s=>r.onEmit(s)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case WO:{this._emitted=this._currentChannel.out,this._currentChannel=this._activeSubexecutor!==void 0?void 0:Mt,t=oh();break}case JO:{this.runEnsuring(this._currentChannel);break}case QO:{t=this.doneHalt(this._currentChannel.error());break}case Sg:{this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break}case GO:{const n=this._providedEnv===void 0?this._currentChannel.effect():p(this._currentChannel.effect(),Bd(this._providedEnv));t=Mo(Cn(n,{onFailure:r=>{const s=this.doneHalt(r);return s!==void 0&&il(s)?s.effect:ce},onSuccess:r=>{const s=this.doneSucceed(r);return s!==void 0&&il(s)?s.effect:ce}}));break}case YO:{const n=this._input,r=new ts(this._currentChannel.left(),this._providedEnv,s=>this._executeCloseLastSubstream(s));r._input=n,this._input=r,this.addFinalizer(s=>{const i=this.restorePipe(s,n);return i!==void 0?i:ce}),this._currentChannel=this._currentChannel.right();break}case ez:{const n=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>De(()=>{this._providedEnv=n}));break}case XO:{const n=this._currentChannel;t=ch(this._input,Z,r=>{try{this._currentChannel=n.more(r)}catch(s){this._currentChannel=n.done.onExit(SA(s))}},r=>{const s=i=>n.done.onExit(i);this._currentChannel=s(r)});break}case ZO:{t=this.doneSucceed(this._currentChannel.evaluate());break}case ek:{t=this.doneSucceed(this._currentChannel.terminal);break}case tk:{this._currentChannel=this._currentChannel.channel();break}}}catch(n){this._currentChannel=at(Rd(n))}return t}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(t){this._cancelled=t}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(t){this._inProgressFinalizer=t}popAllFinalizers(t){const n=[];let r=this._doneStack.pop();for(;r;)r._tag==="ContinuationFinalizer"&&n.push(r.finalizer),r=this._doneStack.pop();const s=n.length===0?ce:lh(n,t);return this.storeInProgressFinalizer(s),s}popNextFinalizers(){const t=[];for(;this._doneStack.length!==0;){const n=this._doneStack[this._doneStack.length-1];if(n._tag===Za)return t;t.push(n),this._doneStack.pop()}return t}restorePipe(t,n){const r=this._input;return this._input=n,r!==void 0?r.close(t):ce}close(t){let n;const r=this._inProgressFinalizer;r!==void 0&&(n=p(r,ai(De(()=>this.clearInProgressFinalizer()))));let s;const i=this.popAllFinalizers(t);i!==void 0&&(s=p(i,ai(De(()=>this.clearInProgressFinalizer()))));const o=this._activeSubexecutor===void 0?void 0:this._activeSubexecutor.close(t);if(!(o===void 0&&n===void 0&&s===void 0))return p(Ze(uh(o)),Kd(Ze(uh(n))),Kd(Ze(uh(s))),te(([[c,a],u])=>p(c,gc(a),gc(u))),Bo,q(c=>Re(()=>c)))}doneSucceed(t){if(this._doneStack.length===0)return this._done=fn(t),this._currentChannel=void 0,ei();const n=this._doneStack[this._doneStack.length-1];if(n._tag===Za){this._doneStack.pop(),this._currentChannel=n.onSuccess(t);return}const r=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=r.reverse(),this._done=fn(t),this._currentChannel=void 0,ei();const s=lh(r.map(o=>o.finalizer),fn(t));this.storeInProgressFinalizer(s);const i=p(s,ai(De(()=>this.clearInProgressFinalizer())),Bo,q(()=>De(()=>this.doneSucceed(t))));return Mo(i)}doneHalt(t){if(this._doneStack.length===0)return this._done=dn(t),this._currentChannel=void 0,ei();const n=this._doneStack[this._doneStack.length-1];if(n._tag===Za){this._doneStack.pop();try{this._currentChannel=n.onHalt(t)}catch(o){this._currentChannel=at(Rd(o))}return}const r=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=r.reverse(),this._done=dn(t),this._currentChannel=void 0,ei();const s=lh(r.map(o=>o.finalizer),dn(t));this.storeInProgressFinalizer(s);const i=p(s,ai(De(()=>this.clearInProgressFinalizer())),Bo,q(()=>De(()=>this.doneHalt(t))));return Mo(i)}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,ei()}runBracketOut(t){const n=Bo(Cn(this.provide(t.acquire()),{onFailure:r=>De(()=>{this._currentChannel=at(r)}),onSuccess:r=>De(()=>{this.addFinalizer(s=>this.provide(t.finalizer(r,s))),this._currentChannel=be(r)})}));return Mo(n)}provide(t){return this._providedEnv===void 0?t:p(t,Bd(this._providedEnv))}runEnsuring(t){this.addFinalizer(t.finalizer),this._currentChannel=t.channel}addFinalizer(t){this._doneStack.push(new Jq(t))}runSubexecutor(){const t=this._activeSubexecutor;switch(t._tag){case ok:return this.pullFromChild(t.childExecutor,t.parentSubexecutor,t.onEmit,t);case zd:return this.pullFromUpstream(t);case Vd:return this.drainChildExecutors(t);case ck:return this._emitted=t.value,this._activeSubexecutor=t.next,oh()}}replaceSubexecutor(t){this._currentChannel=void 0,this._activeSubexecutor=t}finishWithExit(t){const n=Kn(t,{onFailure:r=>this.doneHalt(r),onSuccess:r=>this.doneSucceed(r)});return this._activeSubexecutor=void 0,n===void 0?ce:lz(n)}finishSubexecutorWithCloseEffect(t,...n){this.addFinalizer(()=>p(n,Wn(s=>p(De(()=>s(t)),q(i=>i!==void 0?i:ce)),{discard:!0})));const r=p(t,Kn({onFailure:s=>this.doneHalt(s),onSuccess:s=>this.doneSucceed(s)}));return this._activeSubexecutor=void 0,r}applyUpstreamPullStrategy(t,n,r){switch(r._tag){case qO:{const s=!t||n.some(i=>i!==void 0);return[r.emitSeparator,s?[void 0,...n]:n]}case Qq:{const s=!t||n.some(i=>i!==void 0);return[r.emitSeparator,s?[...n,void 0]:n]}}}pullFromChild(t,n,r,s){return ch(t,Z,i=>{const o=r(i);switch(o._tag){case jO:break;case qq:{this.finishWithDoneValue(t,n,o.value);break}case zq:{const c=n.enqueuePullFromChild(s);this.replaceSubexecutor(c);break}}this._activeSubexecutor=new ah(i,this._activeSubexecutor)},Kn({onFailure:i=>{const o=this.handleSubexecutorFailure(t,n,i);return o===void 0?void 0:Yb(o)},onSuccess:i=>{this.finishWithDoneValue(t,n,i)}}))}finishWithDoneValue(t,n,r){const s=n;switch(s._tag){case zd:{const i=new Gr(s.upstreamExecutor,s.createChild,s.lastDone!==void 0?s.combineChildResults(s.lastDone,r):r,s.activeChildExecutors,s.combineChildResults,s.combineWithChildResult,s.onPull,s.onEmit);this._closeLastSubstream=t.close(fn(r)),this.replaceSubexecutor(i);break}case Vd:{const i=new ui(s.upstreamExecutor,s.lastDone!==void 0?s.combineChildResults(s.lastDone,r):r,s.activeChildExecutors,s.upstreamDone,s.combineChildResults,s.combineWithChildResult,s.onPull);this._closeLastSubstream=t.close(fn(r)),this.replaceSubexecutor(i);break}}}handleSubexecutorFailure(t,n,r){return this.finishSubexecutorWithCloseEffect(dn(r),s=>n.close(s),s=>t.close(s))}pullFromUpstream(t){if(t.activeChildExecutors.length===0)return this.performPullFromUpstream(t);const n=t.activeChildExecutors[0],r=new Gr(t.upstreamExecutor,t.createChild,t.lastDone,t.activeChildExecutors.slice(1),t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);if(n===void 0)return this.performPullFromUpstream(r);this.replaceSubexecutor(new xa(n.childExecutor,r,n.onEmit))}performPullFromUpstream(t){return ch(t.upstreamExecutor,n=>{const r=this._closeLastSubstream===void 0?ce:this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(r),se(n))},n=>{if(this._closeLastSubstream!==void 0){const o=this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(o),te(()=>{const c=new ts(t.createChild(n),this._providedEnv,this._executeCloseLastSubstream);c._input=this._input;const[a,u]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(Xb(n)));this._activeSubexecutor=new xa(c,new Gr(t.upstreamExecutor,t.createChild,t.lastDone,u,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),Be(a)&&(this._activeSubexecutor=new ah(a.value,this._activeSubexecutor))}))}const r=new ts(t.createChild(n),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;const[s,i]=this.applyUpstreamPullStrategy(!1,t.activeChildExecutors,t.onPull(Xb(n)));this._activeSubexecutor=new xa(r,new Gr(t.upstreamExecutor,t.createChild,t.lastDone,i,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit),t.onEmit),Be(s)&&(this._activeSubexecutor=new ah(s.value,this._activeSubexecutor))},n=>{if(t.activeChildExecutors.some(i=>i!==void 0)){const i=new ui(t.upstreamExecutor,t.lastDone,[void 0,...t.activeChildExecutors],t.upstreamExecutor.getDone(),t.combineChildResults,t.combineWithChildResult,t.onPull);if(this._closeLastSubstream!==void 0){const o=this._closeLastSubstream;return this._closeLastSubstream=void 0,p(this._executeCloseLastSubstream(o),te(()=>this.replaceSubexecutor(i)))}this.replaceSubexecutor(i);return}const r=this._closeLastSubstream,s=this.finishSubexecutorWithCloseEffect(p(n,vA(i=>t.combineWithChildResult(t.lastDone,i))),()=>r,i=>t.upstreamExecutor.close(i));return s===void 0?void 0:Yb(s)})}drainChildExecutors(t){if(t.activeChildExecutors.length===0){const i=this._closeLastSubstream;return i!==void 0&&this.addFinalizer(()=>We(i)),this.finishSubexecutorWithCloseEffect(t.upstreamDone,()=>i,o=>t.upstreamExecutor.close(o))}const n=t.activeChildExecutors[0],r=t.activeChildExecutors.slice(1);if(n===void 0){const[i,o]=this.applyUpstreamPullStrategy(!0,r,t.onPull(gz(r.reduce((c,a)=>a!==void 0?c+1:c,0))));return this.replaceSubexecutor(new ui(t.upstreamExecutor,t.lastDone,o,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull)),Be(i)?(this._emitted=i.value,oh()):void 0}const s=new ui(t.upstreamExecutor,t.lastDone,r,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this.replaceSubexecutor(new xa(n.childExecutor,s,n.onEmit))}}const uh=e=>e!==void 0?e:ce,lh=(e,t)=>p(Wn(e,n=>Ze(n(t))),te(n=>p(_A(n),Pe(()=>OA))),q(n=>Re(()=>n))),vg=(e,t,n)=>{const r=[e],s=()=>{const i=r.pop();if(i===void 0||i.upstream===void 0)return EO("Unexpected end of input for channel execution");const o=i.upstream.run();switch(o._tag){case ya:{const c=i.onEmit(i.upstream.getEmit());return r.length===0?c===void 0?Re(t):p(c,Cn({onFailure:n,onSuccess:t})):c===void 0?Re(()=>s()):p(c,Cn({onFailure:n,onSuccess:()=>s()}))}case ga:{const c=i.onDone(i.upstream.getDone());return r.length===0?c===void 0?Re(t):p(c,Cn({onFailure:n,onSuccess:t})):c===void 0?Re(()=>s()):p(c,Cn({onFailure:n,onSuccess:()=>s()}))}case So:return r.push(i),p(i.onEffect(o.effect),og(c=>Re(()=>{const a=i.onDone(dn(c));return a===void 0?ce:a})),Cn({onFailure:n,onSuccess:()=>s()}));case ba:return r.push(i),r.push(o),Re(()=>s())}};return s()},uk=g(2,(e,t)=>{const n=(r,s,i)=>EK(De(()=>new ts(e,void 0,Z)),o=>Re(()=>eu(o.run(),o).pipe(kO(r),se(Ue(r)),TO(Ue(s)))),(o,c)=>{const a=o.close(c);return a===void 0?ce:_f(a,u=>Oc(i,Tn(u)))});return cg(r=>tl([UE(t,qu),It(),It()]).pipe(q(([s,i,o])=>r(n(i,o,s)).pipe($t(t),q(c=>t.addFinalizer(a=>{const u=_m(a)?Xj(a.cause):void 0;return ud(i).pipe(q(l=>l?hn(o,void 0).pipe(se(VE(c)),se(xb(c))):hn(o,void 0).pipe(se(u&&Jp(u)>0?HE(c,mM(u)):Hn(c)),se(xb(c)))))}).pipe(se(r(Ue(i)))))))))}),eu=(e,t)=>{const n=e;switch(n._tag){case So:return p(n.effect,q(()=>eu(t.run(),t)));case ya:return eu(t.run(),t);case ga:return Re(()=>t.getDone());case ba:return vg(n,()=>eu(t.run(),t),Tn)}},yz="Done",bz="Await",_z="effect/ChannelMergeDecision",Sz=Symbol.for(_z),wz={[Sz]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},Zb=e=>{const t=Object.create(wz);return t._tag=bz,t.f=e,t},lk="BothRunning",fk="LeftDone",hk="RightDone",vz="effect/ChannelMergeState",e_=Symbol.for(vz),Eg={[e_]:e_},fh=(e,t)=>{const n=Object.create(Eg);return n._tag=lk,n.left=e,n.right=t,n},t_=e=>{const t=Object.create(Eg);return t._tag=fk,t.f=e,t},n_=e=>{const t=Object.create(Eg);return t._tag=hk,t.f=e,t},dk="BackPressure",pk="BufferSliding",Ez="effect/ChannelMergeStrategy",r_=Symbol.for(Ez),mk={[r_]:r_},Oz=e=>{const t=Object.create(mk);return t._tag=dk,t},kz=e=>{const t=Object.create(mk);return t._tag=pk,t},Cz=g(2,(e,{onBackPressure:t,onBufferSliding:n})=>{switch(e._tag){case dk:return t();case pk:return n()}}),si="Empty",Ko="Emit",qo="Error",zo="Done",gk=e=>({_tag:si,notifyProducer:e}),hh=e=>({_tag:Ko,notifyConsumers:e}),Pz=e=>({_tag:qo,cause:e}),Rz=e=>({_tag:zo,done:e});class $z{ref;constructor(t){this.ref=t}awaitRead(){return nr(Jr(this.ref,t=>t._tag===si?[Ue(t.notifyProducer),t]:[ce,t]))}get close(){return kK(t=>this.error(Qj(t)))}done(t){return nr(Jr(this.ref,n=>{switch(n._tag){case si:return[Ue(n.notifyProducer),n];case Ko:return[Wn(n.notifyConsumers,r=>hn(r,V(t)),{discard:!0}),Rz(t)];case qo:return[Xs,n];case zo:return[Xs,n]}}))}emit(t){return q(It(),n=>nr(Jr(this.ref,r=>{switch(r._tag){case si:return[Ue(r.notifyProducer),r];case Ko:{const s=r.notifyConsumers[0],i=r.notifyConsumers.slice(1);if(s!==void 0)return[hn(s,Y(t)),i.length===0?gk(n):hh(i)];throw new Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case qo:return[Xs,r];case zo:return[Xs,r]}})))}error(t){return nr(Jr(this.ref,n=>{switch(n._tag){case si:return[Ue(n.notifyProducer),n];case Ko:return[Wn(n.notifyConsumers,r=>r0(r,t),{discard:!0}),Pz(t)];case qo:return[Xs,n];case zo:return[Xs,n]}}))}get take(){return this.takeWith(t=>dn(Ym(t,V)),t=>fn(t),t=>s0(Y(t)))}takeWith(t,n,r){return q(It(),s=>nr(Jr(this.ref,i=>{switch(i._tag){case si:return[se(hn(i.notifyProducer,void 0),kc(Ue(s),{onFailure:t,onSuccess:ot({onLeft:r,onRight:n})})),hh([s])];case Ko:return[kc(Ue(s),{onFailure:t,onSuccess:ot({onLeft:r,onRight:n})}),hh([...i.notifyConsumers,s])];case qo:return[We(t(i.cause)),i];case zo:return[We(r(i.done)),i]}})))}}const Og=()=>p(It(),q(e=>Cr(gk(e))),te(e=>new $z(e))),ol=g(2,(e,t)=>iz(e,t,()=>{},()=>{})),kg=e=>{const t=Sr({onInput:()=>t,onFailure:at,onDone:ms});return dt(e,t)},yk=g(2,(e,t)=>oz(e,()=>t)),Tz=e=>le(e,Z),Cf=e=>it(e.takeWith(at,t=>le(be(t),()=>Cf(e)),ms)),bk=()=>Ef({onInput:e=>le(be(e),()=>bk()),onFailure:_o,onDone:Br}),_k=g(2,(e,t)=>le(e,n=>Of(()=>t(n)))),Pf=g(2,(e,t)=>{const n=Ef({onInput:r=>le(be(t(r)),()=>n),onFailure:_o,onDone:Br});return dt(e,n)}),Iz=g(3,(e,t,n)=>Cg(r=>Jt(function*(){const s=yield*Og(),i=Cf(s),o=yield*Cc(n);yield*Oc(r,Ms(o));const c=yield*It(),a=n===Number.POSITIVE_INFINITY?f=>Z:(yield*fg(n)).withPermits;yield*(yield*i.pipe(dt(e),Ei(r))).pipe(Cn({onFailure:f=>wt(o,Tn(f)),onSuccess:ot({onLeft:f=>se(zt(a(n)(ce)),ag(wt(o,We(V(f))))),onRight:f=>Jt(function*(){const h=yield*It(),d=yield*It();yield*wt(o,te(Ue(h),Y)),yield*hn(d,void 0).pipe(se(cg(m=>Ze(m(Ue(c))).pipe(CK(Ze(m(t(f)))),q(Z))).pipe(_f(m=>r0(c,m)),kO(h))),a(1),$t(r)),yield*Ue(d)})})}),lg,zt,$t(r));const l=it(kc(nr(sl(o)),{onFailure:at,onSuccess:ot({onLeft:Br,onRight:f=>le(be(f),()=>l)})}));return wg(l,s)}))),Fz=e=>t=>Mz(e)(t,Su),Mz=({bufferSize:e=16,concurrency:t,mergeStrategy:n=Oz()})=>(r,s)=>Cg(i=>Jt(function*(){const o=t==="unbounded"?Number.MAX_SAFE_INTEGER:t,c=yield*Og(),a=Cf(c),u=yield*Cc(e);yield*Oc(i,Ms(u));const l=yield*yg();yield*Oc(i,Ms(l));const f=yield*Cr(A()),h=yield*It(),d=(yield*fg(o)).withPermits,m=yield*Ei(dt(a,r),i);function y(_){return _.pipe(q(ot({onLeft:S=>We(N(S)),onRight:S=>hs(wt(u,We(Y(S))),A())})),Hb({until:S=>Be(S)}),q(S=>k0(f,we({onNone:()=>N(S.value),onSome:E=>N(s(E,S.value))}))),og(S=>Gm(S)?Tn(S):wt(u,Tn(S)).pipe(se(hn(h,void 0)),ag)))}yield*m.pipe(Cn({onFailure:_=>wt(u,Tn(_)).pipe(se(We(!1))),onSuccess:ot({onLeft:_=>ug(zt(Ue(h)),zt(d(o)(ce)),{onSelfDone:(S,E)=>hs(Hn(E),!1),onOtherDone:(S,E)=>se(Hn(E),Un(f).pipe(q(we({onNone:()=>wt(u,We(V(_))),onSome:O=>wt(u,We(V(s(O,_))))})),hs(!1)))}),onRight:_=>Cz(n,{onBackPressure:()=>Jt(function*(){const S=yield*It(),E=Ud(C=>Ei(dt(a,_),C).pipe(q(v=>ih(Ze(y(v)),Ze(zt(Ue(h))))),q(Z)));return yield*hn(S,void 0).pipe(se(E),d(1),$t(i)),yield*Ue(S),!(yield*ud(h))}),onBufferSliding:()=>Jt(function*(){const S=yield*It(),E=yield*It(),O=yield*Uq(l);yield*sl(l).pipe(q($=>hn($,void 0)),CO(()=>O>=o)),yield*wt(l,S);const C=Ud($=>Ei(dt(a,_),$).pipe(q(w=>Ze(y(w)).pipe(ih(Ze(zt(Ue(h)))),ih(Ze(zt(Ue(S)))))),q(Z)));return yield*hn(E,void 0).pipe(se(C),d(1),$t(i)),yield*Ue(E),!(yield*ud(h))})})})}),Hb({while:_=>_}),$t(i));const b=p(sl(u),nr,kc({onFailure:at,onSuccess:ot({onLeft:Br,onRight:_=>le(be(_),()=>b)})}),it);return wg(b,c)})),Sk=g(3,(e,t,n)=>Fz(n)(Pf(e,t))),xz=g(2,(e,t)=>{function n(r){return Jt(function*(){const s=yield*Og(),i=Cf(s),o=yield*Ei(dt(i,e),r),c=yield*Ei(dt(i,t.other),r);function a(l,f,h){return(d,m,y)=>{function b(_){const S=_;return S._tag===yz?We(ve(se(Hn(f),S.effect))):te(VE(f),Kn({onFailure:E=>ve(S.f(dn(E))),onSuccess:ot({onLeft:E=>ve(S.f(fn(E))),onRight:E=>Yi(be(E),u(y(S.f)))})}))}return Kn(l,{onFailure:_=>b(d(dn(_))),onSuccess:ot({onLeft:_=>b(d(fn(_))),onRight:_=>We(le(be(_),()=>le(ve($t(zt(h),r)),S=>u(m(S,f)))))})})}}function u(l){switch(l._tag){case lk:{const f=zt(Qr(l.left)),h=zt(Qr(l.right));return it(ug(f,h,{onSelfDone:(d,m)=>se(Hn(m),a(d,l.right,o)(t.onSelfDone,fh,y=>t_(y))),onOtherDone:(d,m)=>se(Hn(m),a(d,l.left,c)(t.onOtherDone,(y,b)=>fh(b,y),y=>n_(y)))}))}case fk:return it(te(Ze(c),Kn({onFailure:f=>ve(l.f(dn(f))),onSuccess:ot({onLeft:f=>ve(l.f(fn(f))),onRight:f=>le(be(f),()=>u(t_(l.f)))})})));case hk:return it(te(Ze(o),Kn({onFailure:f=>ve(l.f(dn(f))),onSuccess:ot({onLeft:f=>ve(l.f(fn(f))),onRight:f=>le(be(f),()=>u(n_(l.f)))})})))}}return ve(zb(l=>{const f=zb(m=>(m.transferChildren(l.scope()),ce)),h=zt(o).pipe(ai(f),$t(r)),d=zt(c).pipe(ai(f),$t(r));return Sf(h,d,(m,y)=>fh(m,y))})).pipe(le(u),wg(s))})}return Cg(n)}),Hd=g(2,(e,t)=>ma(()=>{let n;const r=Ef({onInput:i=>le(be(i),()=>r),onFailure:i=>(n=Dz(i),at(Rd(n))),onDone:Br}),s=Sr({onInput:i=>p(be(i),le(()=>s)),onFailure:i=>Yj(i)&&jz(i.defect)&&J(i.defect,n)?_o(i.defect.error):at(i),onDone:Br});return dt(dt(dt(e,r),t),s)})),tu=e=>Ud(t=>uk(e,t)),Az=e=>tu(kg(e)),wk=e=>it(cg(t=>te(IU(),n=>rz(_f(t(jE(e,n)),r=>Xu(n,dn(r))),(r,s)=>Xu(n,s))))),vk=e=>Nz(te(OK,t=>le(ve(e(t)),be))),Ei=g(2,(e,t)=>Kd(De(()=>new ts(e,void 0,Z)),$O()).pipe(PK(([n,r])=>TU(t,s=>{const i=n.close(s);return i!==void 0?Bd(i,r):ce})),Bo,te(([n])=>Re(()=>Wd(n.run(),n))))),Wd=(e,t)=>{const n=e;switch(n._tag){case ga:return Kn(t.getDone(),{onFailure:Tn,onSuccess:r=>We(V(r))});case ya:return We(Y(t.getEmit()));case So:return p(n.effect,q(()=>Wd(t.run(),t)));case ba:return vg(n,()=>Wd(t.run(),t),r=>Tn(r))}},it=e=>Tz(ve(e)),Nz=e=>ik(wk(e),(t,n)=>t,(t,n)=>t),Cg=e=>ik(vk(e),(t,n)=>t,(t,n)=>t),Rf=e=>Ek(0,e.length,e),Ek=(e,t,n)=>e===t?Mt:p(be(p(n,$r(e))),le(()=>Ek(e+1,t,n))),Lz=g(e=>rk(e[1]),(e,t,n)=>n?.concurrent?xz(e,{other:t,onSelfDone:r=>Zb(s=>Re(()=>Jy(r,s))),onOtherDone:r=>Zb(s=>Re(()=>Jy(s,r)))}):le(e,r=>_k(t,s=>[r,s]))),Yi=g(e=>rk(e[1]),(e,t,n)=>n?.concurrent?_k(Lz(e,t,{concurrent:!0}),r=>r[1]):le(e,()=>t)),Jd=Symbol.for("effect/Channel/ChannelException"),Dz=e=>({_tag:"ChannelException",[Jd]:Jd,error:e}),jz=e=>z(e,Jd),Uz=Symbol.for("effect/Sink"),Bz={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e};class $f{channel;[Uz]=Bz;constructor(t){this.channel=t}pipe(){return B(this,arguments)}}const Kz=e=>new $f(ma(()=>Pc(e()))),qz=e=>Kz(()=>Vz(Ok(e,Oe()))),Ok=(e,t)=>Sr({onInput:n=>{const[r,s]=Lw(n,e);return r.length<e?Ok(e-r.length,$e(t,r)):qc(s)?ms($e(t,r)):le(be(s),()=>ms($e(t,r)))},onFailure:at,onDone:()=>ms(t)}),zz=new $f(kg(bk())),Vz=e=>new $f(e),Hz=e=>new $f(ve(e)),Pc=e=>gr(e)?Pc(Hz(e)):e.channel,Wz=gf,Jz=ig,Qz=tK,Gz=oK,Yz=e=>Object.assign(e,{chunk(n){return this(We(n))},die(n){return this(yK(n))},dieMessage(n){return this(EO(n))},done(n){return this(Re(()=>EA(n,{onFailure:N,onSuccess:de})))},end(){return this(nl(A()))},fail(n){return this(nl(N(n)))},fromEffect(n){return this(wK(n,{onFailure:N,onSuccess:de}))},fromEffectChunk(n){return this(p(n,bf(N)))},halt(n){return this(Tn(p(n,Ym(N))))},single(n){return this(We(de(n)))}}),Xz=Symbol.for("effect/Stream/Handoff"),kk="Empty",Ck="Full",Pk=e=>({_tag:kk,notifyConsumer:e}),Zz=(e,t)=>({_tag:Ck,value:e,notifyProducer:t}),Rk=(e,t)=>n=>{switch(n._tag){case kk:return e(n.notifyConsumer);case Ck:return t(n.value,n.notifyProducer)}},eV={_A:e=>e},tV=()=>p(It(),q(e=>Cr(Pk(e))),te(e=>({[Xz]:eV,ref:e}))),Wr=g(2,(e,t)=>q(It(),n=>nr(Jr(e.ref,r=>p(r,Rk(s=>[se(hn(s,void 0),Ue(n)),Zz(t,n)],(s,i)=>[q(Ue(i),()=>p(e,Wr(t))),r])))))),$k=e=>q(It(),t=>nr(Jr(e.ref,n=>p(n,Rk(r=>[q(Ue(r),()=>$k(e)),n],(r,s)=>[hs(hn(s,void 0),r),Pk(t)]))))),Tk="Emit",Ik="Halt",Fk="End",nV=e=>({_tag:Tk,elements:e}),s_=e=>({_tag:Ik,cause:e}),dh=e=>({_tag:Fk,reason:e}),rV="effect/Take",sV=Symbol.for(rV),iV={_A:e=>e,_E:e=>e};class Tf{exit;[sV]=iV;constructor(t){this.exit=t}pipe(){return B(this,arguments)}}const Qd=e=>new Tf(fn(e)),oV=e=>Re(()=>e.exit),Gd=new Tf(s0(A())),Mk=e=>new Tf(dn(p(e,Ym(N)))),cV=e=>kc(e,{onFailure:t=>we(ME(t),{onNone:()=>Gd,onSome:Mk}),onSuccess:Qd}),aV=e=>new Tf(fn(de(e))),uV=()=>nl(A()),lV=e=>bf(Tn(e),N),Yd="ScheduleEnd",xk="UpstreamEnd",xo={_tag:Yd},fV={_tag:xk},hV="effect/Stream",Ak=Symbol.for(hV),dV={_R:e=>e,_E:e=>e,_A:e=>e};class ze{channel;[Ak]=dV;constructor(t){this.channel=t}pipe(){return B(this,arguments)}}const Nk=e=>z(e,Ak)||gr(e),Pg=4096,pV=g(3,(e,t,n)=>wV(mV(e,t,n),r=>ot(r,{onLeft:A,onRight:N}))),mV=g(3,(e,t,n)=>{const r=tl([tV(),Cr(xo),Cr(Oe()),Jz(n),Cr(!1),Cr(!1)]);return wo(r).pipe(_a(([s,i,o,c,a,u])=>{const l=Sr({onInput:m=>le(ve(p(s,Wr(nV(m)),CO(()=>Mn(m)))),()=>l),onFailure:m=>ve(Wr(s,s_(m))),onDone:()=>ve(Wr(s,dh(fV)))}),f=p(uL(o,Oe()),q(m=>Mn(m)?p(nn(a,!0),se(We(p(be(m),le(()=>f))))):p($k(s),te(y=>{switch(y._tag){case Tk:return p(ve(nn(a,!0)),Yi(be(y.elements)),Yi(ve(Un(u))),le(b=>b?Mt:f));case Ik:return at(y.cause);case Fk:return y.reason._tag===Yd?p(Un(a),te(b=>b?ve(p(nn(i,xo),se(nn(u,!0)))):p(ve(p(nn(i,xo),se(nn(u,!0)))),le(()=>f))),it):p(nn(i,y.reason),se(nn(u,!0)),ve)}}))),it),h=m=>c.next(m),d=(m,y,b)=>{const _=p(nn(a,!1),se(nn(u,!1)),se(p(f,Hd(Pc(t)),Gb,tu,$t(b)))),S=(E,O,C)=>p(nn(o,tF(E)),se(te(Un(i),v=>{switch(v._tag){case Yd:return p(tl([Un(a),_,p(h(N(O)),$t(b))]),te(([$,w,P])=>{const k=p(C,we({onNone:()=>de(Y(O)),onSome:R=>Ha(Y(O),V(R))}));return $?p(be(k),le(()=>d(w,P,b))):d(w,P,b)}),it);case xk:return p(Un(a),te($=>$?be(de(Y(O))):Mt),it)}})),it);return it(ug(Qr(m),Qr(y),{onSelfDone:(E,O)=>p(Hn(y),se(p(Re(()=>E),te(([C,v])=>S(C,v,A()))))),onOtherDone:(E,O)=>Cn(Re(()=>E),{onFailure:C=>ot(mf(C),{onLeft:()=>p(s,Wr(dh(xo)),ds,se(p(Qr(m),te(([v,$])=>S(v,$,A()))))),onRight:v=>p(s,Wr(s_(v)),ds,se(p(Qr(m),te(([$,w])=>S($,w,A())))))}),onSuccess:C=>p(s,Wr(dh(xo)),ds,se(p(Qr(m),te(([v,$])=>S(v,$,N(C))))))})}))};return qk(m=>dt(xe(e),l).pipe(tu,$t(m),se(Hd(f,Pc(t)).pipe(Gb,tu,$t(m),q(y=>h(A()).pipe($t(m),te(b=>new ze(d(y,b,m)))))))))}))}),gV=e=>{if(e==="unbounded")return yg();if(typeof e=="number"||e===void 0)return Cc(e??16);switch(e.strategy){case"dropping":return Dq(e.bufferSize??16);case"sliding":return jq(e.bufferSize??16);default:return Cc(e.bufferSize??16)}},yV=(e,t)=>vK(gV(t),n=>Ms(n)).pipe(q(n=>$O().pipe(q(r=>De(()=>{const s=Wz(r);return e(Yz(o=>cV(o).pipe(q(c=>wt(n,c)),ag,s).then(c=>{if(_m(c)&&!Gm(c.cause))throw Zj(c.cause)})))})),te(r=>{const s=sl(n).pipe(q(i=>oV(i)),PO({onFailure:i=>ve(Ms(n)).pipe(Yi(we(i,{onNone:()=>Mt,onSome:o=>_o(o)}))),onSuccess:i=>be(i).pipe(le(()=>s))}),it);return OV(s).pipe(cl(r??ce))}))),Kk),bV=g(2,(e,t)=>Lk(e,n=>ot(mf(n),{onLeft:t,onRight:SV}))),Lk=g(2,(e,t)=>new ze(p(xe(e),sz(n=>xe(t(n)))))),_V=g(2,(e,t)=>new ze(p(xe(e),Yi(xe(t))))),cl=g(2,(e,t)=>new ze(p(xe(e),yk(t)))),SV=e=>wo(Tn(e)),wV=g(2,(e,t)=>MV(e,xw(t))),_a=g(e=>Nk(e[0]),(e,t,n)=>{const r=n?.bufferSize??16;return n?.switch?Xd(n?.concurrency,()=>i_(e,1,r,t),s=>i_(e,s,r,t)):Xd(n?.concurrency,()=>new ze(ol(xe(e),s=>p(s,Nw(i=>xe(t(i))),sF(Mt,(i,o)=>p(i,Yi(o)))))),s=>new ze(p(xe(e),ol(Rf),Sk(i=>xe(t(i)),n))))}),Xd=(e,t,n)=>{switch(e){case void 0:return t();case"unbounded":return n(Number.MAX_SAFE_INTEGER);default:return e>1?n(e):t()}},i_=g(4,(e,t,n,r)=>new ze(p(xe(e),ol(Rf),Sk(s=>xe(r(s)),{concurrency:t,mergeStrategy:kz(),bufferSize:n})))),Rg=g(e=>Nk(e[0]),(e,t)=>_a(e,Z,t)),vV=e=>{const t=Sr({onInput:n=>le(Rf(n),()=>t),onFailure:at,onDone:()=>Mt});return new ze(p(xe(e),dt(t)))},EV=e=>{const t=(r,s)=>{const[i,o]=p(r,nF(a=>!Du(a))),c=p(Pl(o),we({onNone:()=>s,onSome:Kn({onFailure:a=>we(ME(a),{onNone:()=>Mt,onSome:at}),onSuccess:()=>Mt})}));return p(be(p(i,xw(a=>Du(a)?N(a.value):A()))),le(()=>c))},n=Sr({onInput:r=>t(r,n),onFailure:r=>at(r),onDone:()=>Mt});return new ze(p(xe(e),dt(n)))},Dk=e=>vV(EV(p(e,FV(t=>t.exit)))),OV=e=>new ze(e),xe=e=>{if("channel"in e)return e.channel;if(gr(e))return xe(wo(e));throw new TypeError("Expected a Stream.")},kV=e=>new ze(qc(e)?Mt:be(e)),wo=e=>p(e,bf(N),CV),CV=e=>new ze(it(PO(e,{onFailure:we({onNone:()=>Mt,onSome:_o}),onSuccess:t=>be(de(t))}))),PV=(e,t)=>{const n=t?.maxChunkSize??Pg;if(t?.scoped){const s=te(Jb(e),i=>Rc(i,{maxChunkSize:n,shutdown:!0}));return t.shutdown?te(s,cl(Wb(e))):s}const r=_a(jk(Jb(e)),s=>Rc(s,{maxChunkSize:n}));return t?.shutdown?cl(r,Wb(e)):r},RV=e=>Uk(()=>Lp(e)?kV(e):$V(e[Symbol.iterator]())),$V=(e,t=Pg)=>p(De(()=>{let n=[];const r=s=>p(De(()=>{let i=s.next();if(t===1)return i.done?Mt:p(be(de(i.value)),le(()=>r(s)));n=[];let o=0;for(;i.done===!1&&(n.push(i.value),o=o+1,!(o>=t));)i=s.next();return o>0?p(be(Fn(n)),le(()=>r(s))):Mt}),it);return new ze(r(e))}),Bk),Rc=(e,t)=>p(Kq(e,1,t?.maxChunkSize??Pg),og(n=>p(Bq(e),q(r=>r&&Gm(n)?uV():lV(n)))),AV,t?.shutdown?cl(Ms(e)):Z),TV=g(3,(e,t,n)=>pV(e,qz(t),Gz(n))),IV=(...e)=>RV(e),FV=g(2,(e,t)=>new ze(p(xe(e),Pf(Nw(t))))),MV=g(2,(e,t)=>new ze(p(xe(e),Pf(t)))),Zd=g(2,(e,t)=>{const n=r=>{const s=r.next();if(s.done)return Sr({onInput:i=>n(i[Symbol.iterator]()),onFailure:at,onDone:ms});{const i=s.value;return it(te(t(i),o=>le(be(de(o)),()=>n(r))))}};return new ze(p(xe(e),dt(ma(()=>n(Oe()[Symbol.iterator]())))))}),xV=g(3,(e,t,n)=>new ze(p(xe(e),ol(Rf),Iz(n,t),Pf(de)))),AV=e=>UV(e,t=>p(te(t,n=>N([n,t])),OO(we({onNone:()=>We(A()),onSome:nl})))),NV=g(2,(e,t)=>xe(e).pipe(Hd(Pc(t)),Az)),LV=e=>NV(e,zz),jk=e=>new ze(yk(wk(p(e,te(de))),ce)),DV=e=>new ze(vk(t=>e(t).pipe(te(de)))),Uk=e=>new ze(ma(()=>xe(e()))),jV=g(2,(e,t)=>Zd(e,n=>hs(t(n),n))),UV=(e,t)=>Uk(()=>{const n=r=>it(te(t(r),we({onNone:()=>Mt,onSome:([s,i])=>le(be(s),()=>n(i))})));return new ze(n(e))}),Bk=e=>Rg(wo(e)),Kk=e=>Rg(jk(e)),qk=e=>Rg(DV(t=>e(t))),BV=da,KV=PB,qV=RB,zV=Uo,zk=$B,_3=IB,VV=BB,S3=KB,HV=qB,WV="effect/GroupBy",Vk=Symbol.for(WV),JV={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},QV=e=>z(e,Vk),GV=g(e=>QV(e[0]),(e,t,n)=>_a(e.grouped,([r,s])=>t(r,Dk(Rc(s,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:n?.bufferSize??16})),YV=e=>({[Vk]:JV,pipe(){return B(this,arguments)},grouped:e}),XV=g(e=>typeof e[0]!="function",(e,t,n)=>n?.key?GV(ZV(e,n.key,{bufferSize:n.bufferSize}),(r,s)=>Zd(s,t)):Xd(n?.concurrency,()=>Zd(e,t),r=>n?.unordered?_a(e,s=>wo(t(s)),{concurrency:r}):xV(e,r,t))),ZV=g(e=>typeof e[0]!="function",(e,t,n)=>{const r=(s,i)=>Sr({onInput:o=>le(ve(Wn(eH(o,t),([c,a])=>{const u=s.get(c);return u===void 0?p(Cc(n?.bufferSize??16),q(l=>p(De(()=>{s.set(c,l)}),se(wt(i,aV([c,l]))),se(p(wt(l,Qd(a)),sh(f=>eh(f)?N(ce):A())))))):sh(wt(u,Qd(a)),l=>eh(l)?N(ce):A())},{discard:!0})),()=>r(s,i)),onFailure:o=>ve(wt(i,Mk(o))),onDone:()=>p(ve(p(Wn(s.entries(),([o,c])=>p(wt(c,Gd),sh(a=>eh(a)?N(ce):A())),{discard:!0}),se(wt(i,Gd)))))});return YV(qk(s=>Jt(function*(){const i=new Map,o=yield*yg();return yield*Oc(s,Ms(o)),yield*xe(e).pipe(dt(r(i,o)),kg,uk(s),$t(s),hs(Dk(Rc(o,{shutdown:!0}))))})))}),eH=g(2,(e,t)=>{const n=[],r=e[Symbol.iterator](),s=new Map;let i;for(;(i=r.next())&&!i.done;){const o=i.value,c=t(o);if(s.has(c))s.get(c).push(o);else{const a=[o];n.push([c,a]),s.set(c,a)}}return Fn(n.map(o=>[o[0],Fn(o[1])]))});class _t{path;actual;issue;_tag="Pointer";constructor(t,n,r){this.path=t,this.actual=n,this.issue=r}}class o_{actual;message;_tag="Unexpected";constructor(t,n){this.actual=t,this.message=n}}class Ao{ast;message;_tag="Missing";actual=void 0;constructor(t,n){this.ast=t,this.message=n}}class Ve{ast;actual;issues;output;_tag="Composite";constructor(t,n,r,s){this.ast=t,this.actual=n,this.issues=r,this.output=s}}class ph{ast;actual;kind;issue;_tag="Refinement";constructor(t,n,r,s){this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class mh{ast;actual;kind;issue;_tag="Transformation";constructor(t,n,r,s){this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class kr{ast;actual;message;_tag="Type";constructor(t,n,r){this.ast=t,this.actual=n,this.message=r}}class c_{ast;actual;message;_tag="Forbidden";constructor(t,n,r){this.ast=t,this.actual=n,this.message=r}}const a_=Symbol.for("effect/Schema/ParseErrorTypeId");class tH extends EB("ParseError"){[a_]=a_;get message(){return this.toString()}toString(){return ru.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[_e](){return this.toJSON()}}const nH=e=>new tH({issue:e}),Hk=Y,rH=V,sH=eT,jt=tT,gs=g(2,(e,t)=>jt(e)?ot(e,{onLeft:V,onRight:t}):q(e,t)),Ln=g(2,(e,t)=>jt(e)?rT(e,t):te(e,t)),gh=g(2,(e,t)=>jt(e)?nT(e,t):bf(e,t)),Wk=g(2,(e,t)=>jt(e)?ot(e,{onLeft:t,onRight:Y}):OO(e,t)),Jk=(e,t)=>t===void 0||bs(t)?e:e===void 0?t:{...e,...t},iH=(e,t,n)=>{const r=rn(e);return(s,i)=>r(s,Jk(n,i))},oH=(e,t,n)=>{const r=iH(e,t,n);return(s,i)=>RS(r(s,i),nH)},Qk=(e,t)=>oH(Lt(e.ast),!0,t),cH=ne(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),rn=(e,t)=>{const n=cH,r=n.get(e);if(r)return r;const s=aH(e),i=YT(e),o=Be(i)?(u,l)=>s(u,Jk(l,i.value)):s,c=XT(e),a=Be(c)?(u,l)=>nu(Wk(o(u,l),c.value),e,u,l):o;return n.set(e,a),a},yh=e=>Dn(JT(e)),bh=e=>Dn(QT(e)),aH=(e,t)=>{switch(e._tag){case"Refinement":{const n=rn(e.from);return(r,s)=>{s=s??Vf;const i=s?.errors==="all",o=gs(Wk(n(r,s),c=>{const a=new ph(e,r,"From",c);return i&&eI(e)&&Xk(c)?we(e.filter(r,s,e),{onNone:()=>V(a),onSome:u=>V(new Ve(e,r,[a,new ph(e,r,"Predicate",u)]))}):V(a)}),c=>we(e.filter(c,s,e),{onNone:()=>Y(c),onSome:a=>V(new ph(e,r,"Predicate",a))}));return nu(o,e,r,s)}}case"Transformation":{const n=fH(e.transformation),r=rn(e.from),s=rn(e.to);return(i,o)=>nu(gs(gh(r(i,o),c=>new mh(e,i,"Encoded",c)),c=>gs(gh(n(c,o??Vf,e,i),a=>new mh(e,i,"Transformation",a)),a=>gh(s(a,o),u=>new mh(e,i,"Type",u)))),e,i,o)}case"Declaration":{const n=e.decodeUnknown(...e.typeParameters);return(r,s)=>nu(n(r,s??Vf,e),e,r,s)}case"Literal":return qt(e,n=>n===e.literal);case"UniqueSymbol":return qt(e,n=>n===e.symbol);case"UndefinedKeyword":return qt(e,_$);case"NeverKeyword":return qt(e,S$);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return Y;case"StringKeyword":return qt(e,dr);case"NumberKeyword":return qt(e,bs);case"BooleanKeyword":return qt(e,_p);case"BigIntKeyword":return qt(e,yl);case"SymbolKeyword":return qt(e,Lh);case"ObjectKeyword":return qt(e,qr);case"Enums":return qt(e,n=>e.enums.some(([r,s])=>s===n));case"TemplateLiteral":{const n=CI(e);return qt(e,r=>dr(r)&&n.test(r))}case"TupleType":{const n=e.elements.map(u=>rn(u.type)),r=e.rest.map(u=>rn(u.type));let s=e.elements.filter(u=>!u.isOptional);e.rest.length>0&&(s=s.concat(e.rest.slice(1)));const i=s.length,o=e.elements.length>0?e.elements.map((u,l)=>l).join(" | "):"never",c=yh(e),a=bh(e);return(u,l)=>{if(!bT(u))return V(new kr(e,u));const f=l?.errors==="all",h=[];let d=0;const m=[],y=u.length;for(let E=y;E<=i-1;E++){const O=new _t(E,u,new Ao(s[E-y]));if(f){h.push([d++,O]);continue}else return V(new Ve(e,u,O,m))}if(e.rest.length===0)for(let E=e.elements.length;E<=y-1;E++){const O=new _t(E,u,new o_(u[E],`is unexpected, expected: ${o}`));if(f){h.push([d++,O]);continue}else return V(new Ve(e,u,O,m))}let b=0,_;for(;b<n.length;b++)if(y<b+1){if(e.elements[b].isOptional)continue}else{const E=n[b],O=E(u[b],l);if(jt(O)){if(ft(O)){const C=new _t(b,u,O.left);if(f){h.push([d++,C]);continue}else return V(new Ve(e,u,C,_n(m)))}m.push([d++,O.right])}else{const C=d++,v=b;_||(_=[]),_.push(({es:$,output:w})=>q(Zs(O),P=>{if(ft(P)){const k=new _t(v,u,P.left);return f?($.push([C,k]),ce):V(new Ve(e,u,k,_n(w)))}return w.push([C,P.right]),ce}))}}if(pt(r)){const[E,...O]=r;for(;b<y-O.length;b++){const C=E(u[b],l);if(jt(C))if(ft(C)){const v=new _t(b,u,C.left);if(f){h.push([d++,v]);continue}else return V(new Ve(e,u,v,_n(m)))}else m.push([d++,C.right]);else{const v=d++,$=b;_||(_=[]),_.push(({es:w,output:P})=>q(Zs(C),k=>{if(ft(k)){const R=new _t($,u,k.left);return f?(w.push([v,R]),ce):V(new Ve(e,u,R,_n(P)))}else return P.push([v,k.right]),ce}))}}for(let C=0;C<O.length;C++)if(b+=C,!(y<b+1)){const v=O[C](u[b],l);if(jt(v)){if(ft(v)){const $=new _t(b,u,v.left);if(f){h.push([d++,$]);continue}else return V(new Ve(e,u,$,_n(m)))}m.push([d++,v.right])}else{const $=d++,w=b;_||(_=[]),_.push(({es:P,output:k})=>q(Zs(v),R=>{if(ft(R)){const F=new _t(w,u,R.left);return f?(P.push([$,F]),ce):V(new Ve(e,u,F,_n(k)))}return k.push([$,R.right]),ce}))}}}const S=({es:E,output:O})=>za(E)?V(new Ve(e,u,_n(E),_n(O))):Y(_n(O));if(_&&_.length>0){const E=_;return Re(()=>{const O={es:Do(h),output:Do(m)};return q(Wn(E,C=>C(O),{concurrency:c,batching:a,discard:!0}),()=>S(O))})}return S({output:m,es:h})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return qt(e,w$);const n=[],r={},s=[];for(const l of e.propertySignatures)n.push([rn(l.type),l]),r[l.name]=null,s.push(l.name);const i=e.indexSignatures.map(l=>[rn(l.parameter),rn(l.type),l.parameter]),o=tr.make(e.indexSignatures.map(l=>l.parameter).concat(s.map(l=>Lh(l)?new sI(l):new lw(l)))),c=rn(o),a=yh(e),u=bh(e);return(l,f)=>{if(!E$(l))return V(new kr(e,l));const h=f?.errors==="all",d=[];let m=0;const y=f?.onExcessProperty==="error",b=f?.onExcessProperty==="preserve",_={};let S;if(y||b){S=mi(l);for(const v of S){const $=c(v,f);if(jt($)&&ft($))if(y){const w=new _t(v,l,new o_(l[v],`is unexpected, expected: ${String(o)}`));if(h){d.push([m++,w]);continue}else return V(new Ve(e,l,w,_))}else _[v]=l[v]}}let E;const O=f?.exact===!0;for(let v=0;v<n.length;v++){const $=n[v][1],w=$.name,P=Object.prototype.hasOwnProperty.call(l,w);if(!P){if($.isOptional)continue;if(O){const F=new _t(w,l,new Ao($));if(h){d.push([m++,F]);continue}else return V(new Ve(e,l,F,_))}}const k=n[v][0],R=k(l[w],f);if(jt(R)){if(ft(R)){const F=new _t(w,l,P?R.left:new Ao($));if(h){d.push([m++,F]);continue}else return V(new Ve(e,l,F,_))}_[w]=R.right}else{const F=m++,L=w;E||(E=[]),E.push(({es:U,output:re})=>q(Zs(R),H=>{if(ft(H)){const j=new _t(L,l,P?H.left:new Ao($));return h?(U.push([F,j]),ce):V(new Ve(e,l,j,re))}return re[L]=H.right,ce}))}}for(let v=0;v<i.length;v++){const $=i[v],w=$[0],P=$[1],k=US(l,$[2]);for(const R of k){const F=w(R,f);if(jt(F)&&sr(F)){const L=P(l[R],f);if(jt(L))if(ft(L)){const U=new _t(R,l,L.left);if(h){d.push([m++,U]);continue}else return V(new Ve(e,l,U,_))}else Object.prototype.hasOwnProperty.call(r,R)||(_[R]=L.right);else{const U=m++,re=R;E||(E=[]),E.push(({es:H,output:j})=>q(Zs(L),Q=>{if(ft(Q)){const Ye=new _t(re,l,Q.left);return h?(H.push([U,Ye]),ce):V(new Ve(e,l,Ye,j))}else return Object.prototype.hasOwnProperty.call(r,R)||(j[R]=Q.right),ce}))}}}}const C=({es:v,output:$})=>{if(za(v))return V(new Ve(e,l,_n(v),$));if(f?.propertyOrder==="original"){const w=S||mi(l);for(const k of s)w.indexOf(k)===-1&&w.push(k);const P={};for(const k of w)Object.prototype.hasOwnProperty.call($,k)&&(P[k]=$[k]);return Y(P)}return Y($)};if(E&&E.length>0){const v=E;return Re(()=>{const $={es:Do(d),output:Object.assign({},_)};return q(Wn(v,w=>w($),{concurrency:a,batching:u,discard:!0}),()=>C($))})}return C({es:d,output:_})}}case"Union":{const n=uH(e.types),r=mi(n.keys),s=r.length,i=e.types.length,o=new Map;for(let u=0;u<i;u++)o.set(e.types[u],rn(e.types[u]));const c=yh(e)??1,a=bh(e);return(u,l)=>{const f=[];let h=0,d=[];if(s>0)if(Sp(u))for(let b=0;b<s;b++){const _=r[b],S=n.keys[_].buckets;if(Object.prototype.hasOwnProperty.call(u,_)){const E=String(u[_]);if(Object.prototype.hasOwnProperty.call(S,E))d=d.concat(S[E]);else{const{candidates:O,literals:C}=n.keys[_],v=tr.make(C),$=O.length===i?new as([new St(_,v,!1,!0)],[]):tr.make(O);f.push([h++,new Ve($,u,new _t(_,u,new kr(v,u[_])))])}}else{const{candidates:E,literals:O}=n.keys[_],C=new St(_,tr.make(O),!1,!0),v=E.length===i?new as([C],[]):tr.make(E);f.push([h++,new Ve(v,u,new _t(_,u,new Ao(C)))])}}else{const b=n.candidates.length===i?e:tr.make(n.candidates);f.push([h++,new kr(b,u)])}n.otherwise.length>0&&(d=d.concat(n.otherwise));let m;for(let b=0;b<d.length;b++){const _=d[b],S=o.get(_)(u,l);if(jt(S)&&(!m||m.length===0)){if(sr(S))return S;f.push([h++,S.left])}else{const E=h++;m||(m=[]),m.push(O=>Re(()=>"finalResult"in O?ce:q(Zs(S),C=>(sr(C)?O.finalResult=C:O.es.push([E,C.left]),ce))))}}const y=b=>za(b)?b.length===1&&b[0][1]._tag==="Type"?V(b[0][1]):V(new Ve(e,u,_n(b))):V(new kr(e,u));if(m&&m.length>0){const b=m;return Re(()=>{const _={es:Do(f)};return q(Wn(b,S=>S(_),{concurrency:c,batching:a,discard:!0}),()=>"finalResult"in _?_.finalResult:y(_.es))})}return y(f)}}case"Suspend":{const n=BS(()=>rn(Ss(e.f(),e.annotations)));return(r,s)=>n()(r,s)}}},qt=(e,t)=>n=>t(n)?Y(n):V(new kr(e,n)),Vo=(e,t)=>{switch(e._tag){case"Declaration":{const n=aw(e);if(Be(n))return Vo(n.value);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const s=e.propertySignatures[r],i=Oy(s.type);wy(i)&&!s.isOptional&&n.push([s.name,i])}return n}case"TupleType":{const n=[];for(let r=0;r<e.elements.length;r++){const s=e.elements[r],i=Oy(s.type);wy(i)&&!s.isOptional&&n.push([r,i])}return n}case"Refinement":return Vo(e.from);case"Suspend":return Vo(e.f());case"Transformation":return Vo(e.from)}return[]},uH=(e,t)=>{const n={},r=[],s=[];for(let i=0;i<e.length;i++){const o=e[i],c=Vo(o);if(c.length>0){s.push(o);for(let a=0;a<c.length;a++){const[u,l]=c[a],f=String(l.literal);n[u]=n[u]||{buckets:{},literals:[],candidates:[]};const h=n[u].buckets;if(Object.prototype.hasOwnProperty.call(h,f)){if(a<c.length-1)continue;h[f].push(o),n[u].literals.push(l),n[u].candidates.push(o)}else{h[f]=[o],n[u].literals.push(l),n[u].candidates.push(o);break}}}else r.push(o)}return{keys:n,otherwise:r,candidates:s}},nu=(e,t,n,r)=>{if(r?.isEffectAllowed===!0||jt(e))return e;const s=new X0,i=TK(e,{scheduler:s});s.flush();const o=i.unsafePoll();if(o){if(Du(o))return Y(o.value);const c=o.cause;return Gj(c)?V(c.error):V(new c_(t,n,tU(c)))}return V(new c_(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},lH=([e],[t])=>e>t?1:e<t?-1:0;function _n(e){return e.sort(lH).map(t=>t[1])}const fH=(e,t)=>{switch(e._tag){case"FinalTransformation":return e.decode;case"ComposeTransformation":return Y;case"TypeLiteralTransformation":return n=>{let r=Y(n);for(const s of e.propertySignatureTransformations){const[i,o]=[s.from,s.to],c=s.decode;r=Ln(r,u=>{const l=c(Object.prototype.hasOwnProperty.call(u,i)?N(u[i]):A());return delete u[i],Be(l)&&(u[o]=l.value),u})}return r}}},Ct=(e,t=[])=>({value:e,forest:t}),ru={formatIssue:e=>Ln(ii(e),hH),formatIssueSync:e=>{const t=ru.formatIssue(e);return jt(t)?iT(t):IK(t)},formatError:e=>ru.formatIssue(e.issue),formatErrorSync:e=>ru.formatIssueSync(e.issue)},hH=e=>e.value+Gk(`
`,e.forest),Gk=(e,t)=>{let n="";const r=t.length;let s;for(let i=0;i<r;i++){s=t[i];const o=i===r-1;n+=e+(o?"└":"├")+"─ "+s.value,n+=Gk(e+(r>1&&!o?"│  ":"   "),s.forest)}return n},dH=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},pH=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},Yk=e=>"ast"in e?N(e.ast):A(),ep=Y(void 0),mH=e=>Yk(e).pipe(jc(HT),we({onNone:()=>ep,onSome:t=>{const n=t(e);return dr(n)?Y({message:n,override:!1}):gr(n)?te(n,r=>({message:r,override:!1})):dr(n.message)?Y({message:n.message,override:n.override}):te(n.message,r=>({message:r,override:n.override}))}})),$g=e=>t=>t._tag===e,Xk=$g("Composite"),u_=$g("Refinement"),l_=$g("Transformation"),Zo=e=>gs(mH(e),t=>t!==void 0?!t.override&&(Xk(e)||u_(e)&&e.kind==="From"||l_(e)&&e.kind!=="Transformation")?l_(e)||u_(e)?Zo(e.issue):ep:Y(t.message):ep),Zk=e=>Yk(e).pipe(jc(GT),lT(t=>t(e)),Dn);function gH(e){return cw(e).pipe(Rr(()=>iw(e)),Rr(()=>ow(e)),Rr(()=>vl(e)),Pe(()=>`{ ${e.from} | filter }`))}function yH(e){return e.message!==void 0?e.message:`Expected ${_w(e.ast)?gH(e.ast):String(e.ast)}, actual ${Rn(e.actual)}`}const bH=e=>Ln(Zo(e),t=>t??Zk(e)??yH(e)),Aa=e=>Zk(e)??String(e.ast),_H=e=>e.message??"is forbidden",SH=e=>e.message??"is unexpected",wH=e=>{const t=WT(e.ast);if(Be(t)){const n=t.value();return dr(n)?Y(n):n}return Y(e.message??"is missing")},ii=e=>{switch(e._tag){case"Type":return Ln(bH(e),Ct);case"Forbidden":return Y(Ct(Aa(e),[Ct(_H(e))]));case"Unexpected":return Y(Ct(SH(e)));case"Missing":return Ln(wH(e),Ct);case"Transformation":return gs(Zo(e),t=>t!==void 0?Y(Ct(t)):Ln(ii(e.issue),n=>Ct(Aa(e),[Ct(dH(e.kind),[n])])));case"Refinement":return gs(Zo(e),t=>t!==void 0?Y(Ct(t)):Ln(ii(e.issue),n=>Ct(Aa(e),[Ct(pH(e.kind),[n])])));case"Pointer":return Ln(ii(e.issue),t=>Ct(LT(e.path),[t]));case"Composite":return gs(Zo(e),t=>{if(t!==void 0)return Y(Ct(t));const n=Aa(e);return KS(e.issues)?Ln(Wn(e.issues,ii),r=>Ct(n,r)):Ln(ii(e.issues),r=>Ct(n,[r]))})}},vH=NK,EH=vH(EE,Ij);function ti(e,t){return T(e.runtimeEffect,n=>oe(r=>(r.setFiberRefs(n.fiberRefs),r.currentRuntimeFlags=n.runtimeFlags,po(t,n.context))))}const OH={...sL,[Fd]:Fd,pipe(){return B(this,arguments)},commit(){return this.runtimeEffect}},kH=(e,t)=>{t=t??tO();const n=Ad(ua());let r;const s=oe(o=>(r||(r=xd(Yc(jE(_B(e,t),n),c=>{i.cachedRuntime=c}),{scope:n,scheduler:o.currentScheduler})),lo(r.await))),i=Object.assign(Object.create(OH),{memoMap:t,scope:n,runtimeEffect:s,cachedRuntime:void 0,runtime(){return i.cachedRuntime===void 0?nh(i.runtimeEffect):Promise.resolve(i.cachedRuntime)},dispose(){return nh(i.disposeEffect)},disposeEffect:G(()=>(i.runtimeEffect=Vi("ManagedRuntime disposed"),i.cachedRuntime=void 0,Xu(i.scope,Bt))),runFork(o,c){return i.cachedRuntime===void 0?xd(ti(i,o),c):fa(i.cachedRuntime)(o,c)},runSyncExit(o){return i.cachedRuntime===void 0?nB(ti(i,o)):eg(i.cachedRuntime)(o)},runSync(o){return i.cachedRuntime===void 0?Ad(ti(i,o)):WE(i.cachedRuntime)(o)},runPromiseExit(o,c){return i.cachedRuntime===void 0?tB(ti(i,o),c):gf(i.cachedRuntime)(o,c)},runCallback(o,c){return i.cachedRuntime===void 0?Md(Ur)(ti(i,o),c):Md(i.cachedRuntime)(o,c)},runPromise(o,c){return i.cachedRuntime===void 0?nh(ti(i,o),c):GE(i.cachedRuntime)(o,c)}});return i},CH=kH,PH=g(e=>qr(e[0]),(e,...t)=>{const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}),RH=g(e=>qr(e[0]),(e,...t)=>{const n={...e};for(const r of t)delete n[r];return n}),al=Symbol.for("effect/Schema");function An(e){return class{[al]=f_;static ast=e;static annotations(n){return An(vo(this.ast,n))}static pipe(){return B(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static[al]=f_}}const f_={_A:e=>e,_I:e=>e,_R:e=>e},h_={schemaId:qT,message:zS,missingMessage:Ip,identifier:VS,title:ro,description:Fp,examples:HS,default:WS,documentation:zT,jsonSchema:JS,arbitrary:QS,pretty:GS,equivalence:YS,concurrency:XS,batching:ZS,parseIssueTitle:ew,parseOptions:tw,decodingFallback:nw},If=e=>{if(!e)return{};const t={...e};for(const n in h_)if(n in e){const r=h_[n];t[r]=e[n],delete t[n]}return t},vo=(e,t)=>Ss(e,If(t)),d_=e=>z(e,al)&&qr(e[al]),$H=(e,t,n)=>Tg(e,new El(e.map(r=>r.ast),(...r)=>t.decode(...r.map(An)),(...r)=>t.encode(...r.map(An)),If(n))),TH=(e,t)=>{const n=()=>(s,i,o)=>e(s)?Hk(s):rH(new kr(o,s)),r=n;return Tg([],new El([],n,r,If(t)))};function Tg(e,t){return class extends An(t){static annotations(r){return Tg(this.typeParameters,vo(this.ast,r))}static typeParameters=[...e]}}const IH=function(){if(Array.isArray(arguments[0])){const n=arguments[0],r=arguments[1],s=arguments[2];return $H(n,r,s)}const e=arguments[0],t=arguments[1];return TH(e,t)};class FH extends An(rI){}class MH extends An(fw){}class Ig extends An(fI){}const xH=e=>tr.make(e.map(t=>t.ast));function eC(e,t=xH(e)){return class extends An(t){static annotations(r){return eC(this.members,vo(this.ast,r))}static members=[...e]}}function AH(...e){return gw(e)?eC(e):pt(e)?e[0]:MH}const NH=e=>AH(e,FH),LH=Symbol.for("effect/PropertySignature"),tC=e=>z(e,LH),DH=Ew([Ip]),jH=(e,t)=>{const n=mi(e),r=[];if(n.length>0){const i=[],o=[],c=[];for(let a=0;a<n.length;a++){const u=n[a],l=e[u];if(tC(l)){const f=l.ast;switch(f._tag){case"PropertySignatureDeclaration":{const h=f.type,d=f.isOptional,m=f.annotations;i.push(new St(u,h,d,!0,DH(f))),o.push(new St(u,Lt(h),d,!0,m)),r.push(new St(u,h,d,!0,m));break}case"PropertySignatureTransformation":{const h=f.from.fromKey??u;i.push(new St(h,f.from.type,f.from.isOptional,!0,f.from.annotations)),o.push(new St(u,f.to.type,f.to.isOptional,!0,f.to.annotations)),c.push(new wI(h,u,f.decode,f.encode));break}}}else i.push(new St(u,l.ast,!1,!0)),o.push(new St(u,Lt(l.ast),!1,!0)),r.push(new St(u,l.ast,!1,!0))}if(pt(c)){const a=[],u=[];for(const l of t){const{indexSignatures:f,propertySignatures:h}=Ey(l.key.ast,l.value.ast);h.forEach(d=>{i.push(d),o.push(new St(d.name,Lt(d.type),d.isOptional,d.isReadonly,d.annotations))}),f.forEach(d=>{a.push(d),u.push(new Ol(d.parameter,Lt(d.type),d.isReadonly))})}return new Sw(new as(i,a,{[Uh]:"Struct (Encoded side)"}),new as(o,u,{[Uh]:"Struct (Type side)"}),new vI(c))}}const s=[];for(const i of t){const{indexSignatures:o,propertySignatures:c}=Ey(i.key.ast,i.value.ast);c.forEach(a=>r.push(a)),o.forEach(a=>s.push(a))}return new as(r,s)},UH=(e,t)=>{const n=mi(e);for(const r of n){const s=e[r];if(t[r]===void 0&&tC(s)){const i=s.ast,o=i._tag==="PropertySignatureDeclaration"?i.defaultValue:i.to.defaultValue;o!==void 0&&(t[r]=o())}}return t};function nC(e,t,n=jH(e,t)){return class extends An(n){static annotations(s){return nC(this.fields,this.records,vo(this.ast,s))}static fields={...e};static records=[...t];static make=(s,i)=>{const o=UH(e,{...s});return iC(i)?o:Qk(this)(o)};static pick(...s){return tp(PH(e,...s))}static omit(...s){return tp(RH(e,...s))}}}function tp(e,...t){return nC(e,t)}function rC(e,t){return class extends An(t){static annotations(r){return rC(this.from,vo(this.ast,r))}static make=(r,s)=>iC(s)?r:Qk(this)(r);static from=e}}const BH=(e,t)=>n=>{const r=we(sw(n.ast),{onNone:()=>[e],onSome:i=>[...i,e]}),s=Ss(n.ast,If({[qS]:r,...t}));return rC(n,s)};function sC(e,t,n){return class extends An(n){static annotations(s){return sC(this.from,this.to,vo(this.ast,s))}static from=e;static to=t}}const KH=g(e=>d_(e[0])&&d_(e[1]),(e,t,n)=>sC(e,t,new Sw(e.ast,t.ast,new SI(n.decode,n.encode))));class qH extends IH(t=>BV(t)&&KV(t),{identifier:"DateTimeUtcFromSelf",description:"a DateTime.Utc instance",pretty:()=>t=>t.toString(),arbitrary:()=>t=>t.date({noInvalidDate:!0}).map(n=>zV(n)),equivalence:()=>qV}){}const zH=(e,t)=>sH({try:()=>zk(e),catch:()=>new kr(t,e,`Unable to decode ${Rn(e)} into a DateTime.Utc`)});class p_ extends KH(Ig.annotations({description:"a string to be decoded into a DateTime.Utc"}),qH,{strict:!0,decode:(t,n,r)=>zH(t,r),encode:t=>Hk(HV(t))}).annotations({identifier:"DateTimeUtc"}){}function iC(e){return _p(e)?e:e?.disableValidation??!1}const VH=yV,HH=bV,P3=Lk,WH=wo,R3=Rc,$3=TV,T3=XV,Fg=LV,Mg=jV,JH=Bk,m_=Symbol.for("effect/Subscribable"),QH=KE,GH="effect/SubscriptionRef",oC=Symbol.for(GH),YH={_A:e=>e};class XH extends Vs{ref;pubsub;semaphore;[Ji]=Ji;[m_]=m_;[aL]=$m;[QH]=qE;[oC]=YH;constructor(t,n,r){super(),this.ref=t,this.pubsub=n,this.semaphore=r,this.get=Un(this.ref)}commit(){return this.get}get;get changes(){return p(Un(this.ref),q(t=>te(PV(this.pubsub,{scoped:!0}),n=>_V(IV(t),n))),this.semaphore.withPermits(1),Kk)}modify(t){return this.modifyEffect(n=>We(t(n)))}modifyEffect(t){return p(Un(this.ref),q(t),q(([n,r])=>p(nn(this.ref,r),hs(n),TO(Lq(this.pubsub,r)))),this.semaphore.withPermits(1))}}const ZH=e=>Un(e.ref),eW=e=>p(tl([Nq(),Cr(e),fg(1)]),te(([t,n,r])=>new XH(n,t,r))),g_=oC,y_=ZH,tW=eW,nW=k0,cC=Ig.pipe(BH("MessageId"));tp({id:cC,body:Ig,createdAt:p_,readAt:NH(p_)});class np extends IO()("NetworkMonitor",{effect:Jt(function*(){const t=yield*$K(!0);yield*RO("Created NetworkMonitor");const n=yield*tW(window.navigator.onLine);return yield*VH(r=>{window.addEventListener("online",()=>r(We(de(!0)))),window.addEventListener("offline",()=>r(We(de(!1))))}).pipe(Mg(r=>(r?t.open:t.close).pipe(se(nW(n,()=>r)))),Fg,ds),{latch:t,ref:n}}),accessors:!0}){}const rW=["Hey there! How are you doing today?","I'm doing great, thanks for asking! How about you?","Pretty good! Just finished my morning coffee.","Nice! I'm still working on mine. Did you see the weather forecast?","Yeah, looks like rain later today.","Perfect weather for staying in and coding!","Absolutely! What are you working on these days?","Building a chat application with React and TypeScript","That sounds interesting! How's it going so far?","Pretty well! Just working on the UI components now.","Are you using any UI libraries?","Yeah, I'm using Tailwind CSS for styling","Nice choice! I love Tailwind's utility-first approach","Me too! It makes styling so much faster","Have you tried any component libraries with it?","I've been looking at shadcn/ui actually","That's a great choice! Very customizable","Yeah, I like how it's not a dependency","Are you planning to add any real-time features?","Definitely! Thinking about using WebSocket","Have you worked with WebSocket before?","A little bit, but I'm excited to learn more","That's the best way to learn - by doing!","Exactly! It's been fun so far","Oh, looks like it started raining","Perfect timing for coding, just like we said!","Absolutely! Time to grab another coffee","Good idea! I should do the same","Talk to you later then?","Definitely! Enjoy your coffee!"],sW=FS(30,e=>({id:cC.make(`${e+1}`),body:rW[e],createdAt:zk("2024-03-20T10:00:00Z").pipe(VV({minutes:e*2})),readAt:null}));class iW extends IO()("MessagesService",{accessors:!0,dependencies:[np.Default],effect:Jt(function*(){const t=yield*np;return{getMessages:()=>Jt(function*(){const n=yield*Ub(1e3,2500);return yield*Vb(`${n} millis`),sW}),sendMarkAsReadBatch:n=>Jt(function*(){const r=yield*Ub(1e3,2500);yield*se(Vb(`${r} millis`),SK(()=>Promise.resolve(n))),yield*RO(`Batched: ${rF(n,", ")}`)}).pipe(t.latch.whenOpen,_K({times:3,schedule:Qz("500 millis",2)}))}})}){}const oW=LK(np.Default,iW.Default).pipe(DK(EH));var Eo=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Xi=typeof window>"u"||"Deno"in globalThis;function Pt(){}function cW(e,t){return typeof e=="function"?e(t):e}function rp(e){return typeof e=="number"&&e>=0&&e!==1/0}function aC(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Tr(e,t){return typeof e=="function"?e(t):e}function On(e,t){return typeof e=="function"?e(t):e}function b_(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:c}=e;if(o){if(r){if(t.queryHash!==xg(o,t.options))return!1}else if(!$c(t.queryKey,o))return!1}if(n!=="all"){const a=t.isActive();if(n==="active"&&!a||n==="inactive"&&a)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||s&&s!==t.state.fetchStatus||i&&!i(t))}function __(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(xs(t.options.mutationKey)!==xs(i))return!1}else if(!$c(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function xg(e,t){return(t?.queryKeyHashFn||xs)(e)}function xs(e){return JSON.stringify(e,(t,n)=>sp(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function $c(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>$c(e[n],t[n])):!1}function uC(e,t){if(e===t)return e;const n=S_(e)&&S_(t);if(n||sp(e)&&sp(t)){const r=n?e:Object.keys(e),s=r.length,i=n?t:Object.keys(t),o=i.length,c=n?[]:{},a=new Set(r);let u=0;for(let l=0;l<o;l++){const f=n?l:i[l];(!n&&a.has(f)||n)&&e[f]===void 0&&t[f]===void 0?(c[f]=void 0,u++):(c[f]=uC(e[f],t[f]),c[f]===e[f]&&e[f]!==void 0&&u++)}return s===o&&u===s?e:c}return t}function ul(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function S_(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function sp(e){if(!w_(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!w_(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function w_(e){return Object.prototype.toString.call(e)==="[object Object]"}function aW(e){return new Promise(t=>{setTimeout(t,e)})}function ip(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?uC(e,t):t}function uW(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function lW(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var Tc=Symbol();function lC(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:!e.queryFn||e.queryFn===Tc?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function fC(e,t){return typeof e=="function"?e(...t):!!e}var fW=class extends Eo{#t;#e;#n;constructor(){super(),this.#n=e=>{if(!Xi&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(e){this.#n=e,this.#e?.(),this.#e=e(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(e){this.#t!==e&&(this.#t=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},Ag=new fW,hW=class extends Eo{#t=!0;#e;#n;constructor(){super(),this.#n=e=>{if(!Xi&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(e){this.#n=e,this.#e?.(),this.#e=e(this.setOnline.bind(this))}setOnline(e){this.#t!==e&&(this.#t=e,this.listeners.forEach(n=>{n(e)}))}isOnline(){return this.#t}},ll=new hW;function op(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}function dW(e){let t;if(e.then(n=>(t=n,n),Pt)?.catch(Pt),t!==void 0)return{data:t}}function pW(e){return Math.min(1e3*2**e,3e4)}function hC(e){return(e??"online")==="online"?ll.isOnline():!0}var dC=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function _h(e){return e instanceof dC}function pC(e){let t=!1,n=0,r=!1,s;const i=op(),o=y=>{r||(h(new dC(y)),e.abort?.())},c=()=>{t=!0},a=()=>{t=!1},u=()=>Ag.isFocused()&&(e.networkMode==="always"||ll.isOnline())&&e.canRun(),l=()=>hC(e.networkMode)&&e.canRun(),f=y=>{r||(r=!0,e.onSuccess?.(y),s?.(),i.resolve(y))},h=y=>{r||(r=!0,e.onError?.(y),s?.(),i.reject(y))},d=()=>new Promise(y=>{s=b=>{(r||u())&&y(b)},e.onPause?.()}).then(()=>{s=void 0,r||e.onContinue?.()}),m=()=>{if(r)return;let y;const b=n===0?e.initialPromise:void 0;try{y=b??e.fn()}catch(_){y=Promise.reject(_)}Promise.resolve(y).then(f).catch(_=>{if(r)return;const S=e.retry??(Xi?0:3),E=e.retryDelay??pW,O=typeof E=="function"?E(n,_):E,C=S===!0||typeof S=="number"&&n<S||typeof S=="function"&&S(n,_);if(t||!C){h(_);return}n++,e.onFail?.(n,_),aW(O).then(()=>u()?void 0:d()).then(()=>{t?h(_):m()})})};return{promise:i,cancel:o,continue:()=>(s?.(),i),cancelRetry:c,continueRetry:a,canStart:l,start:()=>(l()?m():d().then(m),i)}}var mW=e=>setTimeout(e,0);function gW(){let e=[],t=0,n=c=>{c()},r=c=>{c()},s=mW;const i=c=>{t?e.push(c):s(()=>{n(c)})},o=()=>{const c=e;e=[],c.length&&s(()=>{r(()=>{c.forEach(a=>{n(a)})})})};return{batch:c=>{let a;t++;try{a=c()}finally{t--,t||o()}return a},batchCalls:c=>(...a)=>{i(()=>{c(...a)})},schedule:i,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{s=c}}}var ht=gW(),mC=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),rp(this.gcTime)&&(this.#t=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Xi?1/0:5*60*1e3))}clearGcTimeout(){this.#t&&(clearTimeout(this.#t),this.#t=void 0)}},yW=class extends mC{#t;#e;#n;#r;#s;#o;#c;constructor(e){super(),this.#c=!1,this.#o=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#r=e.client,this.#n=this.#r.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#t=bW(this.options),this.state=e.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(e){this.options={...this.#o,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,t){const n=ip(this.state.data,e,this.options);return this.#i({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#i({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#s?.promise;return this.#s?.cancel(e),t?t.then(Pt).catch(Pt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(e=>On(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Tc||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Tr(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!aC(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#s&&(this.#c?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}fetch(e,t){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(e&&this.setOptions(e),!this.options.queryFn){const a=this.observers.find(u=>u.options.queryFn);a&&this.setOptions(a.options)}const n=new AbortController,r=a=>{Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(this.#c=!0,n.signal)})},s=()=>{const a=lC(this.options,t),l=(()=>{const f={client:this.#r,queryKey:this.queryKey,meta:this.meta};return r(f),f})();return this.#c=!1,this.options.persister?this.options.persister(a,l,this):a(l)},o=(()=>{const a={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:s};return r(a),a})();this.options.behavior?.onFetch(o,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#i({type:"fetch",meta:o.fetchOptions?.meta});const c=a=>{_h(a)&&a.silent||this.#i({type:"error",error:a}),_h(a)||(this.#n.config.onError?.(a,this),this.#n.config.onSettled?.(this.state.data,a,this)),this.scheduleGc()};return this.#s=pC({initialPromise:t?.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onSuccess:a=>{if(a===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(a)}catch(u){c(u);return}this.#n.config.onSuccess?.(a,this),this.#n.config.onSettled?.(a,this.state.error,this),this.scheduleGc()},onError:c,onFail:(a,u)=>{this.#i({type:"failed",failureCount:a,error:u})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}),this.#s.start()}#i(e){const t=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...gC(n.data,this.options),fetchMeta:e.meta??null};case"success":return this.#e=void 0,{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=e.error;return _h(r)&&r.revert&&this.#e?{...this.#e,fetchStatus:"idle"}:{...n,error:r,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=t(this.state),ht.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function gC(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:hC(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function bW(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var _W=class extends Eo{constructor(e={}){super(),this.config=e,this.#t=new Map}#t;build(e,t,n){const r=t.queryKey,s=t.queryHash??xg(r,t);let i=this.get(s);return i||(i=new yW({client:e,queryKey:r,queryHash:s,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(r)}),this.add(i)),i}add(e){this.#t.has(e.queryHash)||(this.#t.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#t.get(e.queryHash);t&&(e.destroy(),t===e&&this.#t.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){ht.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#t.get(e)}getAll(){return[...this.#t.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(n=>b_(t,n))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(n=>b_(e,n)):t}notify(e){ht.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){ht.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){ht.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},SW=class extends mC{#t;#e;#n;constructor(e){super(),this.mutationId=e.mutationId,this.#e=e.mutationCache,this.#t=[],this.state=e.state||yC(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(t=>t!==e),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#e.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#r({type:"continue"})};this.#n=pC({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(s,i)=>{this.#r({type:"failed",failureCount:s,error:i})},onPause:()=>{this.#r({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});const n=this.state.status==="pending",r=!this.#n.canStart();try{if(n)t();else{this.#r({type:"pending",variables:e,isPaused:r}),await this.#e.config.onMutate?.(e,this);const i=await this.options.onMutate?.(e);i!==this.state.context&&this.#r({type:"pending",context:i,variables:e,isPaused:r})}const s=await this.#n.start();return await this.#e.config.onSuccess?.(s,e,this.state.context,this),await this.options.onSuccess?.(s,e,this.state.context),await this.#e.config.onSettled?.(s,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(s,null,e,this.state.context),this.#r({type:"success",data:s}),s}catch(s){try{throw await this.#e.config.onError?.(s,e,this.state.context,this),await this.options.onError?.(s,e,this.state.context),await this.#e.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,s,e,this.state.context),s}finally{this.#r({type:"error",error:s})}}finally{this.#e.runNext(this)}}#r(e){const t=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),ht.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(e)}),this.#e.notify({mutation:this,type:"updated",action:e})})}};function yC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var wW=class extends Eo{constructor(e={}){super(),this.config=e,this.#t=new Set,this.#e=new Map,this.#n=0}#t;#e;#n;build(e,t,n){const r=new SW({mutationCache:this,mutationId:++this.#n,options:e.defaultMutationOptions(t),state:n});return this.add(r),r}add(e){this.#t.add(e);const t=Na(e);if(typeof t=="string"){const n=this.#e.get(t);n?n.push(e):this.#e.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#t.delete(e)){const t=Na(e);if(typeof t=="string"){const n=this.#e.get(t);if(n)if(n.length>1){const r=n.indexOf(e);r!==-1&&n.splice(r,1)}else n[0]===e&&this.#e.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Na(e);if(typeof t=="string"){const r=this.#e.get(t)?.find(s=>s.state.status==="pending");return!r||r===e}else return!0}runNext(e){const t=Na(e);return typeof t=="string"?this.#e.get(t)?.find(r=>r!==e&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){ht.batch(()=>{this.#t.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(e){const t={exact:!0,...e};return this.getAll().find(n=>__(t,n))}findAll(e={}){return this.getAll().filter(t=>__(e,t))}notify(e){ht.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return ht.batch(()=>Promise.all(e.map(t=>t.continue().catch(Pt))))}};function Na(e){return e.options.scope?.id}function v_(e){return{onFetch:(t,n)=>{const r=t.options,s=t.fetchOptions?.meta?.fetchMore?.direction,i=t.state.data?.pages||[],o=t.state.data?.pageParams||[];let c={pages:[],pageParams:[]},a=0;const u=async()=>{let l=!1;const f=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(t.signal.aborted?l=!0:t.signal.addEventListener("abort",()=>{l=!0}),t.signal)})},h=lC(t.options,t.fetchOptions),d=async(m,y,b)=>{if(l)return Promise.reject();if(y==null&&m.pages.length)return Promise.resolve(m);const S=(()=>{const v={client:t.client,queryKey:t.queryKey,pageParam:y,direction:b?"backward":"forward",meta:t.options.meta};return f(v),v})(),E=await h(S),{maxPages:O}=t.options,C=b?lW:uW;return{pages:C(m.pages,E,O),pageParams:C(m.pageParams,y,O)}};if(s&&i.length){const m=s==="backward",y=m?vW:E_,b={pages:i,pageParams:o},_=y(r,b);c=await d(b,_,m)}else{const m=e??i.length;do{const y=a===0?o[0]??r.initialPageParam:E_(r,c);if(a>0&&y==null)break;c=await d(c,y),a++}while(a<m)}return c};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):t.fetchFn=u}}}function E_(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function vW(e,{pages:t,pageParams:n}){return t.length>0?e.getPreviousPageParam?.(t[0],t,n[0],n):void 0}var EW=class{#t;#e;#n;#r;#s;#o;#c;#i;constructor(t={}){this.#t=t.queryCache||new _W,this.#e=t.mutationCache||new wW,this.#n=t.defaultOptions||{},this.#r=new Map,this.#s=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#c=Ag.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#i=ll.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#c?.(),this.#c=void 0,this.#i?.(),this.#i=void 0)}isFetching(t){return this.#t.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#e.findAll({...t,status:"pending"}).length}getQueryData(t){const n=this.defaultQueryOptions({queryKey:t});return this.#t.get(n.queryHash)?.state.data}ensureQueryData(t){const n=this.defaultQueryOptions(t),r=this.#t.build(this,n),s=r.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Tr(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(s))}getQueriesData(t){return this.#t.findAll(t).map(({queryKey:n,state:r})=>{const s=r.data;return[n,s]})}setQueryData(t,n,r){const s=this.defaultQueryOptions({queryKey:t}),o=this.#t.get(s.queryHash)?.state.data,c=cW(n,o);if(c!==void 0)return this.#t.build(this,s).setData(c,{...r,manual:!0})}setQueriesData(t,n,r){return ht.batch(()=>this.#t.findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,n,r)]))}getQueryState(t){const n=this.defaultQueryOptions({queryKey:t});return this.#t.get(n.queryHash)?.state}removeQueries(t){const n=this.#t;ht.batch(()=>{n.findAll(t).forEach(r=>{n.remove(r)})})}resetQueries(t,n){const r=this.#t;return ht.batch(()=>(r.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},n)))}cancelQueries(t,n={}){const r={revert:!0,...n},s=ht.batch(()=>this.#t.findAll(t).map(i=>i.cancel(r)));return Promise.all(s).then(Pt).catch(Pt)}invalidateQueries(t,n={}){return ht.batch(()=>(this.#t.findAll(t).forEach(r=>{r.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},n)))}refetchQueries(t,n={}){const r={...n,cancelRefetch:n.cancelRefetch??!0},s=ht.batch(()=>this.#t.findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,r);return r.throwOnError||(o=o.catch(Pt)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(s).then(Pt)}fetchQuery(t){const n=this.defaultQueryOptions(t);n.retry===void 0&&(n.retry=!1);const r=this.#t.build(this,n);return r.isStaleByTime(Tr(n.staleTime,r))?r.fetch(n):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Pt).catch(Pt)}fetchInfiniteQuery(t){return t.behavior=v_(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Pt).catch(Pt)}ensureInfiniteQueryData(t){return t.behavior=v_(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return ll.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,n){this.#r.set(xs(t),{queryKey:t,defaultOptions:n})}getQueryDefaults(t){const n=[...this.#r.values()],r={};return n.forEach(s=>{$c(t,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(t,n){this.#s.set(xs(t),{mutationKey:t,defaultOptions:n})}getMutationDefaults(t){const n=[...this.#s.values()],r={};return n.forEach(s=>{$c(t,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const n={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return n.queryHash||(n.queryHash=xg(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.queryFn===Tc&&(n.enabled=!1),n}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},OW=class extends Eo{constructor(e,t){super(),this.options=t,this.#t=e,this.#i=null,this.#c=op(),this.options.experimental_prefetchInRender||this.#c.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#n=void 0;#r=void 0;#s;#o;#c;#i;#m;#h;#d;#u;#l;#a;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),O_(this.#e,this.options)?this.#f():this.updateResult(),this.#_())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return cp(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return cp(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#S(),this.#w(),this.#e.removeObserver(this)}setOptions(e){const t=this.options,n=this.#e;if(this.options=this.#t.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof On(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#v(),this.#e.setOptions(this.options),t._defaulted&&!ul(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&k_(this.#e,n,this.options,t)&&this.#f(),this.updateResult(),r&&(this.#e!==n||On(this.options.enabled,this.#e)!==On(t.enabled,this.#e)||Tr(this.options.staleTime,this.#e)!==Tr(t.staleTime,this.#e))&&this.#g();const s=this.#y();r&&(this.#e!==n||On(this.options.enabled,this.#e)!==On(t.enabled,this.#e)||s!==this.#a)&&this.#b(s)}getOptimisticResult(e){const t=this.#t.getQueryCache().build(this.#t,e),n=this.createResult(t,e);return CW(this,n)&&(this.#r=n,this.#o=this.options,this.#s=this.#e.state),n}getCurrentResult(){return this.#r}trackResult(e,t){return new Proxy(e,{get:(n,r)=>(this.trackProp(r),t?.(r),Reflect.get(n,r))})}trackProp(e){this.#p.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#t.defaultQueryOptions(e),n=this.#t.getQueryCache().build(this.#t,t);return n.fetch().then(()=>this.createResult(n,t))}fetch(e){return this.#f({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#f(e){this.#v();let t=this.#e.fetch(this.options,e);return e?.throwOnError||(t=t.catch(Pt)),t}#g(){this.#S();const e=Tr(this.options.staleTime,this.#e);if(Xi||this.#r.isStale||!rp(e))return;const n=aC(this.#r.dataUpdatedAt,e)+1;this.#u=setTimeout(()=>{this.#r.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#b(e){this.#w(),this.#a=e,!(Xi||On(this.options.enabled,this.#e)===!1||!rp(this.#a)||this.#a===0)&&(this.#l=setInterval(()=>{(this.options.refetchIntervalInBackground||Ag.isFocused())&&this.#f()},this.#a))}#_(){this.#g(),this.#b(this.#y())}#S(){this.#u&&(clearTimeout(this.#u),this.#u=void 0)}#w(){this.#l&&(clearInterval(this.#l),this.#l=void 0)}createResult(e,t){const n=this.#e,r=this.options,s=this.#r,i=this.#s,o=this.#o,a=e!==n?e.state:this.#n,{state:u}=e;let l={...u},f=!1,h;if(t._optimisticResults){const w=this.hasListeners(),P=!w&&O_(e,t),k=w&&k_(e,n,t,r);(P||k)&&(l={...l,...gC(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:d,errorUpdatedAt:m,status:y}=l;h=l.data;let b=!1;if(t.placeholderData!==void 0&&h===void 0&&y==="pending"){let w;s?.isPlaceholderData&&t.placeholderData===o?.placeholderData?(w=s.data,b=!0):w=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,w!==void 0&&(y="success",h=ip(s?.data,w,t),f=!0)}if(t.select&&h!==void 0&&!b)if(s&&h===i?.data&&t.select===this.#m)h=this.#h;else try{this.#m=t.select,h=t.select(h),h=ip(s?.data,h,t),this.#h=h,this.#i=null}catch(w){this.#i=w}this.#i&&(d=this.#i,h=this.#h,m=Date.now(),y="error");const _=l.fetchStatus==="fetching",S=y==="pending",E=y==="error",O=S&&_,C=h!==void 0,$={status:y,fetchStatus:l.fetchStatus,isPending:S,isSuccess:y==="success",isError:E,isInitialLoading:O,isLoading:O,data:h,dataUpdatedAt:l.dataUpdatedAt,error:d,errorUpdatedAt:m,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>a.dataUpdateCount||l.errorUpdateCount>a.errorUpdateCount,isFetching:_,isRefetching:_&&!S,isLoadingError:E&&!C,isPaused:l.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:E&&C,isStale:Ng(e,t),refetch:this.refetch,promise:this.#c};if(this.options.experimental_prefetchInRender){const w=R=>{$.status==="error"?R.reject($.error):$.data!==void 0&&R.resolve($.data)},P=()=>{const R=this.#c=$.promise=op();w(R)},k=this.#c;switch(k.status){case"pending":e.queryHash===n.queryHash&&w(k);break;case"fulfilled":($.status==="error"||$.data!==k.value)&&P();break;case"rejected":($.status!=="error"||$.error!==k.reason)&&P();break}}return $}updateResult(){const e=this.#r,t=this.createResult(this.#e,this.options);if(this.#s=this.#e.state,this.#o=this.options,this.#s.data!==void 0&&(this.#d=this.#e),ul(t,e))return;this.#r=t;const n=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,s=typeof r=="function"?r():r;if(s==="all"||!s&&!this.#p.size)return!0;const i=new Set(s??this.#p);return this.options.throwOnError&&i.add("error"),Object.keys(this.#r).some(o=>{const c=o;return this.#r[c]!==e[c]&&i.has(c)})};this.#E({listeners:n()})}#v(){const e=this.#t.getQueryCache().build(this.#t,this.options);if(e===this.#e)return;const t=this.#e;this.#e=e,this.#n=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#_()}#E(e){ht.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#r)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function kW(e,t){return On(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function O_(e,t){return kW(e,t)||e.state.data!==void 0&&cp(e,t,t.refetchOnMount)}function cp(e,t,n){if(On(t.enabled,e)!==!1&&Tr(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&Ng(e,t)}return!1}function k_(e,t,n,r){return(e!==t||On(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Ng(e,n)}function Ng(e,t){return On(t.enabled,e)!==!1&&e.isStaleByTime(Tr(t.staleTime,e))}function CW(e,t){return!ul(e.getCurrentResult(),t)}var PW=class extends Eo{#t;#e=void 0;#n;#r;constructor(e,t){super(),this.#t=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#t.defaultMutationOptions(e),ul(this.options,t)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),t?.mutationKey&&this.options.mutationKey&&xs(t.mutationKey)!==xs(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#o(e)}getCurrentResult(){return this.#e}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#s(),this.#o()}mutate(e,t){return this.#r=t,this.#n?.removeObserver(this),this.#n=this.#t.getMutationCache().build(this.#t,this.options),this.#n.addObserver(this),this.#n.execute(e)}#s(){const e=this.#n?.state??yC();this.#e={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#o(e){ht.batch(()=>{if(this.#r&&this.hasListeners()){const t=this.#e.variables,n=this.#e.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,n),this.#r.onSettled?.(e.data,null,t,n)):e?.type==="error"&&(this.#r.onError?.(e.error,t,n),this.#r.onSettled?.(void 0,e.error,t,n))}this.listeners.forEach(t=>{t(this.#e)})})}};function RW(e){return e}function $W(e,t,n){if(typeof t!="object"||t===null)return;const r=e.getMutationCache(),s=e.getQueryCache(),i=e.getDefaultOptions().hydrate?.deserializeData??RW,o=t.mutations||[],c=t.queries||[];o.forEach(({state:a,...u})=>{r.build(e,{...e.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...u},a)}),c.forEach(({queryKey:a,state:u,queryHash:l,meta:f,promise:h,dehydratedAt:d})=>{const m=h?dW(h):void 0,y=u.data===void 0?m?.data:u.data,b=y===void 0?y:i(y);let _=s.get(l);const S=_?.state.status==="pending",E=_?.state.fetchStatus==="fetching";if(_){const O=m&&d!==void 0&&d>_.state.dataUpdatedAt;if(u.dataUpdatedAt>_.state.dataUpdatedAt||O){const{fetchStatus:C,...v}=u;_.setState({...v,data:b})}}else _=s.build(e,{...e.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:a,queryHash:l,meta:f},{...u,data:b,fetchStatus:"idle",status:b!==void 0?"success":u.status});h&&!S&&!E&&(d===void 0||d>_.state.dataUpdatedAt)&&_.fetch(void 0,{initialPromise:Promise.resolve(h).then(i)})})}var bC=yr(void 0),_C=e=>{if(e)return e;const t=Qt(bC);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t()},TW=e=>(Ut(t=>(t?.(),e.client.mount(),e.client.unmount.bind(e.client))),xt(()=>e.client.unmount()),M(bC.Provider,{value:()=>e.client,get children(){return e.children}})),SC=yr(()=>!1),IW=()=>Qt(SC);SC.Provider;function FW(e,t,n,r){if(n===!1)return t;if(typeof n=="function"){const o=n(e.data,t.data);return{...t,data:o}}let s=t.data;if(e.data===void 0)try{s=structuredClone(s)}catch{}const i=nS(s,{key:n})(e.data);return{...t,data:i}}var MW=(e,t)=>t;function xW(e,t,n){const r=he(()=>_C(n?.())),s=IW(),i=he(()=>{const O=r().defaultQueryOptions(e());return O._optimisticResults=s()?"isRestoring":"optimistic",O.structuralSharing=!1,O}),o=i(),[c,a]=et(new t(r(),i()));let u=c().getOptimisticResult(i());const[l,f]=fp(u),h=()=>c().subscribe(C=>{u=C,queueMicrotask(()=>{y&&S()})});function d(O){const C=c().options,v=C.reconcile;f($=>FW($,O,v===void 0?!1:v,C.queryHash))}function m(){return[()=>l,O=>{const C=ys(l);if(typeof O=="function"&&(O=O(C)),O?.hydrationData){const{hydrationData:v,...$}=O;O=$}d(O)}]}let y=null,b=null;const[_,{refetch:S}]=ec(()=>{const O=c();return new Promise((C,v)=>{if(b=C,!y&&!s()&&(y=h()),O.updateResult(),u.isError&&!u.isFetching&&!s()&&fC(O.options.throwOnError,[u.error,O.getCurrentQuery()]))return d(u),v(u.error);if(!u.isLoading)return b=null,C(MW(O.getCurrentQuery(),u));d(u)})},{storage:m,get deferStream(){return e().deferStream},onHydrated(O,C){if(C.value&&"hydrationData"in C.value&&$W(r(),{queries:[{...C.value.hydrationData}]}),y)return;const v={...o};(o.staleTime||!o.initialData)&&C.value&&(v.refetchOnMount=!1),c().setOptions(v),d(c().getOptimisticResult(v)),y=h()}});ns(cr(r,O=>{y&&y();const C=new t(O,i());y=h(),a(C)},{defer:!0})),ns(cr(s,O=>{O||S()},{defer:!0})),xt(()=>{y&&(y(),y=null),b&&(b(u),b=null)}),ns(cr([c,i],([O,C])=>{O.setOptions(C),d(O.getOptimisticResult(C)),S()},{defer:!0}));const E={get(O,C){return C==="data"?l.data!==void 0?_.latest?.data:_()?.data:Reflect.get(O,C)}};return new Proxy(l,E)}function AW(e,t){return xW(he(()=>e()),OW,t)}function NW(e,t){const n=he(()=>_C(t?.())),r=new PW(n(),e()),s=(a,u)=>{r.mutate(a,u).catch(Pt)},[i,o]=fp({...r.getCurrentResult(),mutate:s,mutateAsync:r.getCurrentResult().mutate});ns(()=>{r.setOptions(e())}),ns(cr(()=>i.status,()=>{if(i.isError&&fC(r.options.throwOnError,[i.error]))throw i.error}));const c=r.subscribe(a=>{o({...a,mutate:s,mutateAsync:a.mutate})});return xt(c),i}var LW=class extends EW{constructor(e={}){super(e)}};const DW=e=>t=>{const n=e(),[r]=t.mutationKey,s=()=>i=>{const o=t.mutationFn(i);return n()(r)(o)};return NW(()=>({...t,mutationFn:s()}))},jW=e=>({gcTime:t,staleTime:n,...r})=>{const s=e(),[i]=r.queryKey,o=he(()=>c=>r.queryFn(c).pipe(s()(i)))();return AW(()=>({...r,queryKey:r.queryKey,queryFn:r.queryFn===Tc?Tc:o,...n!==void 0&&{staleTime:vs(n)},...t!==void 0&&{gcTime:vs(t)}}))},UW=e=>(t,n,r)=>{const s={skipInitial:r?.skipInitial??!0},i=Qt(e);if(!i)throw new Error("Runtime context not found. Make sure to wrap your app with RuntimeProvider");const o=()=>{const u=Jt(function*(){const f=gr(t)?yield*t:t,h=g_ in f?yield*y_(f):f.get();return s?.skipInitial||n(h),h});return i.runSync(u)},[c,a]=et(o());return As(()=>{const u=Jt(function*(){const l=gr(t)?yield*t:t,f=g_ in l?{changes:l.changes,get:()=>i.runSync(y_(l))}:l,h=f.get();a(()=>h);let d=!1;return yield*f.changes.pipe(Mg(m=>De(()=>{if(a(()=>m),s?.skipInitial&&!d){d=!0;return}n(m)})),Fg,lg,ds)}).pipe(i.runSync);xt(()=>{i.runCallback(Hn(u))})}),c()},BW=e=>(t,n,r,s)=>{const i=Qt(e);if(!i)throw new Error("Runtime context not found. Make sure to wrap your app with RuntimeProvider");const[o,c]=et(n),[a,u]=et(null),f=(gr(t)?JH(t):t).pipe(Mg(h=>De(()=>{c(()=>h),r(h)})),HH(h=>WH(De(()=>{s?.(h)}))),Fg,lg,ds);return i.runCallback(f,{onExit:h=>{Du(h)&&u(h.value)}}),xt(()=>{a()!==null&&i.runCallback(Hn(a()))}),o},KW=new LW({defaultOptions:{queries:{staleTime:vs("1 minute"),retry:!1,refetchOnWindowFocus:!1}}}),qW=e=>{const t=()=>{const i=Qt(n);if(!i)throw new Error("Runtime context not found. Make sure to wrap your app with RuntimeProvider");return he(()=>o=>c=>c.pipe(FK(o),_f(RK),i.runPromise))},n=yr(null);return{createRunner:t,RuntimeProvider:i=>{const o=CH(e);return xt(()=>{o.dispose()}),M(n.Provider,{value:o,get children(){return M(TW,{client:KW,get children(){return i.children}})}})},useRuntime:()=>{const i=Qt(n);if(!i)throw new Error("Runtime context not found. Make sure to wrap your app with RuntimeProvider");return i},useEffectQuery:jW(t),useEffectMutation:DW(t),useRxSubscribe:BW(n),useRxSubscriptionRef:UW(n)}},{RuntimeProvider:zW,useRuntime:F3,useEffectQuery:M3}=qW(oW),VW=function(){return null},Lg=MR()({component:HW});function HW(){return M(zW,{get children(){return[M(p$,{}),M(yp,{}),M(VW,{})]}})}const WW=()=>oi(()=>import("./index-BW7kLQjJ.js"),[]),wC=bu("/")({component:iS(WW,"component",()=>wC.ssr)});async function JW(e,t,n){const r=t[0];if(rr(r)&&r.method){const s=r,i=s.data instanceof FormData?"formData":"payload",o=new Headers({...i==="payload"?{"content-type":"application/json",accept:"application/json","x-tsr-redirect":"manual"}:{},...s.headers instanceof Headers?Object.fromEntries(s.headers.entries()):s.headers});if(s.method==="GET"){const c=J_({payload:Tt.stringify({data:s.data,context:s.context})});c&&(e.includes("?")?e+=`&${c}`:e+=`?${c}`)}return e.includes("?")?e+="&createServerFn":e+="?createServerFn",s.response==="raw"&&(e+="&raw"),await C_(()=>n(e,{method:s.method,headers:o,signal:s.signal,...QW(s)}))}return await C_(()=>n(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t),redirect:"manual"}))}function QW(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",Tt.stringify(e.context)),{body:e.data}):{body:Tt.stringify({data:e.data??null,context:e.context})}:{}}async function C_(e){var t;const n=await(async()=>{try{return await e()}catch(r){if(r instanceof Response)return r;throw r}})();if(!n.ok){const r=n.headers.get("content-type");throw r&&r.includes("application/json")?Tt.decode(await n.json()):new Error(await n.text())}if((t=n.headers.get("content-type"))!=null&&t.includes("application/json")){let r=Tt.decode(await n.json());const s=JP(r);if(s&&(r=s),sn(r)||Dt(r)||r instanceof Error)throw r;return r}return n}function P_(e){return e.replace(/^\/|\/$/g,"")}const GW=(e,t)=>{const n=P_("/"),r=P_(t),s=`${n?`/${n}`:""}/${r}/${e}`;return Object.assign((...o)=>JW(s,o,fetch),{url:s,functionId:e})},YW=()=>oi(()=>import("./demo.start.server-funcs-CL6Trx8f.js"),[]),XW=GW("src_routes_demo_start_server-funcs_tsx--getCount_createServerFn_handler","/_serverFn"),ZW=Ua({method:"GET"}).handler(XW),vC=bu("/demo/start/server-funcs")({component:iS(YW,"component",()=>vC.ssr),loader:async()=>await ZW()}),e3=wC.update({id:"/",path:"/",getParentRoute:()=>Lg}),t3=vC.update({id:"/demo/start/server-funcs",path:"/demo/start/server-funcs",getParentRoute:()=>Lg}),n3={IndexRoute:e3,DemoStartServerFuncsRoute:t3},r3=Lg._addFileChildren(n3)._addFileTypes(),EC=()=>QR({routeTree:r3,scrollRestoration:!0});EC();const s3=EC();bP(()=>M(h$,{router:s3}),document.body);export{xt as A,f3 as B,Dc as C,kn as D,jc as E,l3 as F,Be as G,_3 as H,ki as I,Gt as J,a3 as K,uu as L,iW as M,dP as N,S3 as O,yn as P,Ua as Q,vC as R,GW as S,B_ as T,ce as _,As as a,M as b,et as c,he as d,wR as e,Ut as f,qn as g,oP as h,Xr as i,F3 as j,yg as k,R3 as l,Ht as m,Mg as n,RO as o,$3 as p,KW as q,IK as r,li as s,Kr as t,M3 as u,rF as v,T3 as w,P3 as x,Fg as y,Hn as z};
